---
title: 《设计模式之禅》之责任链模式
date: 2020-01-12 17:27:33
tags: "读书笔记"
---

## 一、责任链模式的定义
使多个对象都有机会处理请求，从而避免了请求的发送者和接受者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有对象处理它为止。

责任链模式的重点是在"链"上，由一条链去处理相似的请求在链中决定谁来处理这个请求。
<!--more-->
## 二、责任链模式的应用


### 1.责任链模式的优点
责任链模式非常显著的优点是将请求和处理分开。请求者可以不用知道是谁处理的，处理者可以不用知道请求全貌(例如在J2EE项目开发中，可以剥离出无状态Bean由责任链处理)，两者解耦，提高系统的灵活性。

### 2.责任链模式的缺点
责任链有两个非常显著的缺点:
一是性能问题，每个请求都是从链头遍历到链尾，特别是在链比较长的时候，性能是一个非常大的问题。
二是调试不很方便，特别是链条比较长，环节比较多的时候，由于采用了类似递归的方式，调试的时候逻辑可能比较复杂。


### 3.责任链模式的注意事项
链中节点数量需要控制，避免出现超长链的情况，一般的做法是在Handler中设置一个最大节点数量，在setNext方法中判断是否已经是超过其阀值，超过则不允许该链建立，避免无意识破坏系统性能。


## 三、最佳实践
责任链模式屏蔽了请求的处理过程，你发起一个请求到底是谁处理的，这个你不用关心，只要你把请求抛给责任链的第一个处理者，最终会返回一个处理结果(当然也可以不做任何处理)，作为请求者可以不用知道到底是需要谁来处理的，这是责任链模式的核心，同时责任链模式也可以作为一种补救模式来用。
举个简单例子:
如项目开发的时候，需求确认是这样的:一个请求，一个处理者，但是随着业务的发展，处理者的数量和类型有所增加，你这时候就可以在第一个处理者后面建立一个链，也就是责任链来处理请求，如果是人民币，好，还是第一个业务逻辑来处理;如果是美元，好，传递到第二个业务逻辑来处理;日元、欧元...这些都不用在对原有的业务逻辑产生很大改变，通过扩展实现类就可以很好地解决这些需求变更时间。

代码例子:https://github.com/developers-youcong/DesignPatternPractice/tree/master/ChainOfResponsibility
