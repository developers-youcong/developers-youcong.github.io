---
title: 《设计模式之禅》之策略模式
date: 2020-02-12 21:12:58
tags: "读书笔记"
---

## 一、策略模式的定义

策略模式是一种比较简单的模式，也叫做政策模式，其定义如下:定义一组算法，将每个算法都封装起来，并且使它们之间可以互换。
<!--more-->

策略模式使用的是面向对象的继承和多态机制，我们看看策略模式的三个角色:

### 1.Context封装角色
它也叫上下文角色，起承上启下封装作用，屏蔽高层模块对策略、算法的直接访问，封装可能存在的变化。


### 2.Strategy抽象策略角色
策略、算法家族的抽象，通常为接口，定义每个策略或算法必须具有的方法和属性。


### 3.ConcreteStrategy具体策略角色
实现抽象策略中的操作，该类含有具体的算法。


## 二、策略模式的应用

### 1.策略模式的优点

#### a.算法可以自由切换
这是策略模式本身定义的，只要实现抽象策略，它就成为策略家族的一个成员，通过封装角色对其进行封装，保证对外提供"可自由切换"的策略。

#### b.避免使用多重条件判断
如果没有策略模式，我们想想看会是什么样子？
一个策略家族有5个策略算法，一会要使用A策略，一会要使用B策略，怎么设计呢？使用多重的条件语句？多重条件语句不易维护，而且出错的概率大大增强。使用策略模式后，可以由其他模块决定采用何种策略，策略家族对外提供的访问接口就是封装类，简化了操作，同时避免了条件语句判断。


#### c.扩展性良好
只要实现接口就可以，其他都不用修改，类似于一个可反复拆卸的插件，大大符合OCP原则(开闭原则)。

### 2.策略模式的缺点

#### a.策略类数量增多
每个策略都是一个类，复用的可能性很小，类的数量增多

#### b.所有的策略类都需要对外暴露
上层模块必须知道有哪些策略，然后才能决定使用哪一个策略，这与迪米特法则相违背的，我只想使用一个策略，我凭什么就要了解这个策略呢？那要你的封装类还有什么意义?这是原装策略模式的一个缺点，幸运的是，我们可以使用其他模式来修正这个缺陷，如工厂方法模式、代理模式或享元模式。

### 3.策略模式的使用场景

#### a.多个类只有在算法或行为上稍有不同的场景。

#### b.算法需要自由切换的场景。
例如，算法的选择是由使用者决定的，或者是算法始终在进化，特别是一些站在技术前沿的行业，连业务专家都无法给你保证这样的系统规则能够存在多长时间，在这种情况下策略模式是你最好的助手。

#### c.需要屏蔽算法规则的场景。
现在的科技发展得很快，人脑记忆是有限得，太多得算法你只要知道一个名字就可以了，传递相关得数字进来，反馈一个运算结果，就Ok了。


### 4.策略模式的注意事项
如果系统中得一个策略家族得具体策略数量超过4个，则需要考虑使用混合模式，解决策略类膨胀和对外暴露的问题，否则日后的系统维护就会成为一个烫手山芋，谁都不想接。


注意:
策略枚举是一个非常优秀和方便的模式，但是它受枚举类型的限制，每个枚举项都是public、final、static的，扩展性受到了一定的约束，因此在系统开发中，策略枚举一般担当不经常发生变化的角色。

## 三、最佳实践
策略模式是一个非常简便的模式。它在项目中使用得非常多，但它单独使用得地方就比较少了，因为它有致命缺陷:所有得策略都需要暴露出去，这样才方便客户端决定使用哪一个策略。

代码例子:https://github.com/developers-youcong/DesignPatternPractice/tree/master/Strategy