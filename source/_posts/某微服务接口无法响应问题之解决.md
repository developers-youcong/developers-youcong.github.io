---
title: 某微服务接口无法响应问题之解决
date: 2022-03-09 20:21:13
tags: "微服务"
---

## 一、问题描述
C微服务接口无法响应。
<!--more-->

## 二、问题排查

### 1.C微服务进程存在(ps -ef|grep c)

### 2.nacos服务列表能够发现C微服务

### 3.curl -I -m 10 -o /dev/null -s -w %{http_code}"" http://192.168.0.91:9102 返回000

### 4.C微服务服务日志无明显错误信息

### 5.基于上述信息，怀疑可能与网关有关，查看网关错误日志

错误日志信息如下:
```
10:11:16.104 [reactor-http-epoll-12] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityLocalAirForecast,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.104 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityEpSiteForecast,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.105 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityEpSiteForecast,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.105 [reactor-http-epoll-12] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityIndustryEpSiteRC,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.106 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityIndustryEpSiteRC,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.106 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityTSConclusion,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.106 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityTSConclusion,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.106 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityLocalAirForecast,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.107 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityAreaAirForecast,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:11:16.107 [reactor-http-epoll-11] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/aop/uforecast/cityAreaAirForecast,异常信息:finishConnect(..) failed: Connection refused: /192.168.0.91:9102
10:19:53.470 [reactor-http-epoll-14] ERROR c.e.g.h.GatewayExceptionHandler - [handle,56] - [网关异常处理]请求路径:/,异常信息:404 NOT_FOUND



```

### 6.根据已有信息，初步判断:网关代理对应的微服务失效


## 三、问题解决
这个问题很容易解决，重启网关即可，重启网关的过程中，加载网关代理配置文件，使其与对应的微服务建立关联。但我想知道为什么网关与C微服务失去了关联，从而造成服务接口无法正常响应。为此我搜索了很多，仍未找到该问题原因，最后去Github给SpringCloud Gateway提相关[issues](https://github.com/spring-cloud/spring-cloud-gateway/issues/2533),但SpringCloud Gateway的维护者给我的答复是建议我升级版本（因为我反馈问题的版本，他们不再维护）。