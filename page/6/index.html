<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Blog">
<meta property="og:url" content="http://developers-youcong.github.io/page/6/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Blog">
  
    <link rel="alternate" href="/atom.xml" title="Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://developers-youcong.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-node-jsè¯»å†™æ–‡ä»¶" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/04/node-jsè¯»å†™æ–‡ä»¶/" class="article-date">
  <time datetime="2019-03-04T13:32:24.000Z" itemprop="datePublished">2019-03-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/04/node-jsè¯»å†™æ–‡ä»¶/">node.jsè¯»å†™æ–‡ä»¶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å…³äºnode.jsçš„è¯»å†™æ“ä½œï¼Œåº”ç”¨åœºæ™¯æœ‰å¾ˆå¤šã€‚<br>æ¯”å¦‚å…¶ä¸­è¿™æ ·çš„ä¸€ä¸ªåœºæ™¯ï¼Œå¦‚ä½•è·å–å…¨å±€çš„tokenã€‚<br>è¿™å°±æ¶‰åŠåˆ°å†™å’Œè¯»æ“ä½œäº†ã€‚</p>
<p>å†™æ“ä½œ:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&quot;fs&quot;);</span><br><span class="line"></span><br><span class="line">function storeToken(token)&#123;</span><br><span class="line"></span><br><span class="line">	fs.writeFile(&apos;D://youcongtech//token.txt&apos;,token.slice(10),&apos;utf8&apos;,function(error)&#123;</span><br><span class="line"></span><br><span class="line">		if(error)&#123;</span><br><span class="line">			console.log(error);</span><br><span class="line">			return false;</span><br><span class="line">		&#125;</span><br><span class="line">		console.log(&apos;write success&apos;);</span><br><span class="line"></span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¯»æ“ä½œ:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&quot;fs&quot;);</span><br><span class="line"></span><br><span class="line">function readToken()&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	fs.readFile(&apos;D://youcongtech//token.txt&apos;, function (err, data) &#123;</span><br><span class="line">		if (err) &#123;</span><br><span class="line">			return console.error(err);</span><br><span class="line">		&#125;</span><br><span class="line">		console.log(data.toString());</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>é€šè¿‡ä¸Šè¿°ä¸¤ä¸ªç¤ºä¾‹ä»£ç ï¼Œå°±å¯ä»¥è¾¾åˆ°å­˜å–tokençš„ç›®çš„ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸å¿…æ‹…å¿ƒå¦‚ä½•è·å–tokené—®é¢˜ã€‚<br>å½“ç„¶äº†ï¼Œé—®é¢˜çš„è§£å†³æ–¹å¼ä¸æ­¢è¿™ä¸€ä¸ªï¼Œå…¶å®è¿˜å¯ä»¥ç”¨redisæ¥å­˜å‚¨tokenã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/03/04/node-jsè¯»å†™æ–‡ä»¶/" data-id="cju836j3a002pw8vkishhdxqx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascriptä¹‹ä¼ è¾“åŠ å¯†" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/04/javascriptä¹‹ä¼ è¾“åŠ å¯†/" class="article-date">
  <time datetime="2019-03-04T11:52:29.000Z" itemprop="datePublished">2019-03-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/04/javascriptä¹‹ä¼ è¾“åŠ å¯†/">javascriptä¹‹ä¼ è¾“åŠ å¯†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨javascriptåŠ å¯†å‘¢ï¼Ÿ<br>æœåŠ¡ç«¯åŠ å¯†è¿œè¿œä¸å¤Ÿï¼Œå®¢æˆ·ç«¯æˆ–è€…æµè§ˆå™¨ç«¯ä¹Ÿéœ€è¦åŠ å¯†ï¼Œä»¥æ­¤ä¿è¯ä¼ è¾“ä¿¡æ¯è¿‡ç¨‹çš„å®‰å…¨ã€‚</p>
<p>ä»Šå¤©å°±æˆ‘å·¥ä½œä¸­è¯´è¯´è¿™ä¹ˆå‡ ç§åŠ å¯†ç®—æ³•åŠå…¶å¯¹åº”çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p>
<ul>
<li>base64</li>
<li>md5</li>
<li>des</li>
</ul>
<h3><span id="ä¸€-base64">ä¸€ã€Base64</span></h3><p>Base64é€šå¸¸å¯ä»¥ç”¨äºCookieåŠ å¯†ï¼Œæ¯”å¦‚æ¯ä¸ªç”¨æˆ·é€šè¿‡ç›¸å…³æ“ä½œï¼Œå¯¹åº”çš„ç”¨æˆ·å’Œæ•°æ®åº“ä¿¡æ¯ä¼šæœ‰å¯¹åº”çš„æ›´æ–°ï¼Œä¸ºäº†ä¿è¯å¯¹åº”çš„ç”¨æˆ·åœ¨webç«¯çœ‹åˆ°çš„ä¿¡æ¯ä¸€è‡´ï¼Œæˆ‘ä»¬ä½¿ç”¨Cookieï¼Œè€ŒCookieå¦‚æœæ˜¯æ˜æ–‡çš„è¯ï¼Œä¸æ˜¯ç‰¹åˆ«å®‰å…¨ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨Base64å¯¹å…¶è¿›è¡ŒåŠ å¯†ã€‚</p>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;base64åŠ å¯†è§£å¯†&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">// åˆ›å»ºBase64å¯¹è±¡</span><br><span class="line">var Base64 = &#123;</span><br><span class="line"> _keyStr: &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;,</span><br><span class="line"> encode: function(e) &#123;</span><br><span class="line">  var t = &quot;&quot;;</span><br><span class="line">  var n, r, i, s, o, u, a;</span><br><span class="line">  var f = 0;</span><br><span class="line">  e = Base64._utf8_encode(e);</span><br><span class="line">  while (f &lt; e.length) &#123;</span><br><span class="line">   n = e.charCodeAt(f++);</span><br><span class="line">   r = e.charCodeAt(f++);</span><br><span class="line">   i = e.charCodeAt(f++);</span><br><span class="line">   s = n &gt;&gt; 2;</span><br><span class="line">   o = (n &amp; 3) &lt;&lt; 4 | r &gt;&gt; 4;</span><br><span class="line">   u = (r &amp; 15) &lt;&lt; 2 | i &gt;&gt; 6;</span><br><span class="line">   a = i &amp; 63;</span><br><span class="line">   if (isNaN(r)) &#123;</span><br><span class="line">    u = a = 64</span><br><span class="line">   &#125; else if (isNaN(i)) &#123;</span><br><span class="line">    a = 64</span><br><span class="line">   &#125;</span><br><span class="line">   t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a)</span><br><span class="line">  &#125;</span><br><span class="line">  return t</span><br><span class="line"> &#125;,</span><br><span class="line"> decode: function(e) &#123;</span><br><span class="line">  var t = &quot;&quot;;</span><br><span class="line">  var n, r, i;</span><br><span class="line">  var s, o, u, a;</span><br><span class="line">  var f = 0;</span><br><span class="line">  e=e.replace(/[^A-Za-z0-9+/=]/g,&quot;&quot;);</span><br><span class="line">  while (f &lt; e.length) &#123;</span><br><span class="line">   s = this._keyStr.indexOf(e.charAt(f++));</span><br><span class="line">   o = this._keyStr.indexOf(e.charAt(f++));</span><br><span class="line">   u = this._keyStr.indexOf(e.charAt(f++));</span><br><span class="line">   a = this._keyStr.indexOf(e.charAt(f++));</span><br><span class="line">   n = s &lt;&lt; 2 | o &gt;&gt; 4;</span><br><span class="line">   r = (o &amp; 15) &lt;&lt; 4 | u &gt;&gt; 2;</span><br><span class="line">   i = (u &amp; 3) &lt;&lt; 6 | a;</span><br><span class="line">   t = t + String.fromCharCode(n);</span><br><span class="line">   if (u != 64) &#123;</span><br><span class="line">    t = t + String.fromCharCode(r)</span><br><span class="line">   &#125;</span><br><span class="line">   if (a != 64) &#123;</span><br><span class="line">    t = t + String.fromCharCode(i)</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  t = Base64._utf8_decode(t);</span><br><span class="line">  return t</span><br><span class="line"> &#125;,</span><br><span class="line"> _utf8_encode: function(e) &#123;</span><br><span class="line">  e = e.replace(/rn/g, &quot;n&quot;);</span><br><span class="line">  var t = &quot;&quot;;</span><br><span class="line">  for (var n = 0; n &lt; e.length; n++) &#123;</span><br><span class="line">   var r = e.charCodeAt(n);</span><br><span class="line">   if (r &lt; 128) &#123;</span><br><span class="line">    t += String.fromCharCode(r)</span><br><span class="line">   &#125; else if (r &gt; 127 &amp;&amp; r &lt; 2048) &#123;</span><br><span class="line">    t += String.fromCharCode(r &gt;&gt; 6 | 192);</span><br><span class="line">    t += String.fromCharCode(r &amp; 63 | 128)</span><br><span class="line">   &#125; else &#123;</span><br><span class="line">    t += String.fromCharCode(r &gt;&gt; 12 | 224);</span><br><span class="line">    t += String.fromCharCode(r &gt;&gt; 6 &amp; 63 | 128);</span><br><span class="line">    t += String.fromCharCode(r &amp; 63 | 128)</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return t</span><br><span class="line"> &#125;,</span><br><span class="line"> _utf8_decode: function(e) &#123;</span><br><span class="line">  var t = &quot;&quot;;</span><br><span class="line">  var n = 0;</span><br><span class="line">  var r = c1 = c2 = 0;</span><br><span class="line">  while (n &lt; e.length) &#123;</span><br><span class="line">   r = e.charCodeAt(n);</span><br><span class="line">   if (r &lt; 128) &#123;</span><br><span class="line">    t += String.fromCharCode(r);</span><br><span class="line">    n++</span><br><span class="line">   &#125; else if (r &gt; 191 &amp;&amp; r &lt; 224) &#123;</span><br><span class="line">    c2 = e.charCodeAt(n + 1);</span><br><span class="line">    t += String.fromCharCode((r &amp; 31) &lt;&lt; 6 | c2 &amp; 63);</span><br><span class="line">    n += 2</span><br><span class="line">   &#125; else &#123;</span><br><span class="line">    c2 = e.charCodeAt(n + 1);</span><br><span class="line">    c3 = e.charCodeAt(n + 2);</span><br><span class="line">    t += String.fromCharCode((r &amp; 15) &lt;&lt; 12 | (c2 &amp; 63) &lt;&lt; 6 | c3 &amp; 63);</span><br><span class="line">    n += 3</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return t</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">// å®šä¹‰å­—ç¬¦ä¸²</span><br><span class="line">var string = &apos;http://www.youcongtech.com!&apos;;</span><br><span class="line">// åŠ å¯†</span><br><span class="line">var encodedString = Base64.encode(string);</span><br><span class="line">console.log(encodedString);</span><br><span class="line">// è§£å¯†</span><br><span class="line">var decodedString = Base64.decode(encodedString);</span><br><span class="line">console.log(decodedString);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3><span id="äºŒ-md5">äºŒã€MD5</span></h3><h4><span id="1mdtç®—æ³•ç‰¹ç‚¹">1.MDTç®—æ³•ç‰¹ç‚¹</span></h4><p>(1)å‹ç¼©æ€§:ä»»æ„é•¿åº¦çš„æ•°æ®ï¼Œç®—å‡ºçš„MD5å€¼é•¿åº¦éƒ½æ˜¯å›ºå®šçš„;<br>(2)å®¹æ˜“è®¡ç®—:ä»åŸæ•°æ®è®¡ç®—å‡ºMD5å€¼å¾ˆå®¹æ˜“;<br>(3)æŠ—ä¿®æ”¹æ€§:å¯¹åŸæ•°æ®è¿›è¡Œä»»ä½•æ”¹åŠ¨ï¼Œå“ªæ€•åªä¿®æ”¹1ä¸ªå­—èŠ‚ï¼Œæ‰€å¾—åˆ°çš„MD5å€¼éƒ½æœ‰å¾ˆå¤§åŒºåˆ«;<br>(4)å¼±æŠ—ç¢°æ’:å·²çŸ¥åŸæ•°æ®å’Œå…¶MD5å€¼ï¼Œæƒ³æ‰¾åˆ°ä¸€ä¸ªå…·æœ‰ç›¸åŒMD5å€¼çš„æ•°æ®(æ—¢ä¼ªé€ æ•°æ®)æ˜¯éå¸¸å›°éš¾çš„;<br>(5)å¼ºæŠ—ç¢°æ’:æƒ³æ‰¾åˆ°ä¸¤ä¸ªä¸åŒçš„æ•°æ®ï¼Œä½¿å®ƒä»¬å…·æœ‰ç›¸åŒçš„MD5å€¼ï¼Œæ˜¯éå¸¸å›°éš¾çš„;</p>
<p>æ ¹æ®ä»¥ä¸Šç‰¹ç‚¹è¡ç”Ÿå‡ºæ¥å¯ä»¥ä¾›æˆ‘ä»¬ä½¿ç”¨çš„ç‰¹æ€§:<br>(1)æ–¹ä¾¿å­˜å‚¨:MD5åŠ å¯†å¤„ç†éƒ½æ˜¯32ä½çš„å­—ç¬¦ä¸²ï¼Œèƒ½å¤Ÿç»™å®šå›ºå®šå¤§å°çš„ç©ºé—´å­˜å‚¨ã€ä¼ è¾“ã€éªŒè¯;<br>(2)æ–‡ä»¶åŠ å¯†:MD5ç®—æ³•è¿ç”¨åœ¨æ–‡ä»¶åŠ å¯†ä¸Šå¾ˆæœ‰ä¼˜åŠ¿ï¼Œå› ä¸ºåªéœ€è¦32ä½å­—ç¬¦ä¸²å°±èƒ½å¯¹ä¸€ä¸ªå·¨å¤§çš„æ–‡ä»¶è¿›è¡ŒéªŒè¯å®Œæ•´æ€§;<br>(3)ä¸å¯é€†:MD5åŠ å¯†å‡ºæ¥åªä¼šæˆªå–æœ«å°¾32ä½ï¼Œå…·æœ‰è‰¯å¥½çš„å®‰å…¨æ€§ï¼Œå¦‚æœæ˜¯å¯¹äºå‚æ•°åŠ å¯†å¾ˆéš¾ä¼ªé€ MD5;<br>(4)åŠ å¯†æŸè€—ä½:MD5ç®—æ³•åŠ å¯†å¯¹äºæ€§èƒ½çš„æ¶ˆè€—å¾®ä¹å…¶å¾®(æ®è¯´0.001æ¯«ç§’)</p>
<h4><span id="2md5ç®—æ³•çš„å®é™…åº”ç”¨">2.MD5ç®—æ³•çš„å®é™…åº”ç”¨</span></h4><p>(1)ç”¨æˆ·å¯†ç <br>å¯¹äºç”¨æˆ·å¯†ç åŠ å¯†æœ€é«˜å¢ƒç•Œå°±æ˜¯:åˆ«äººè·å¾—ä½ æ•°æ®åº“çš„ç”¨æˆ·èµ„æ–™ï¼Œåˆ«äººä¹Ÿæ²¡æœ‰åŠæ³•è·çŸ¥å¯†ç ã€‚<br>ä¸€èˆ¬å¸¸ç”¨çš„è§„åˆ™æ¯”å¦‚:MD5(ç”¨æˆ·å+ç”¨æˆ·å¯†ç )+MD5(KEY+é¡¹ç›®å+å…¬å¸å)è¿™æ ·å¯ä»¥é¿å…å’Œåˆ«äººç¢°åº“ï¼Œä¸æ’é™¤åˆ«äººå¯èƒ½ç”¨MD5ç®—æ³•æ¥æ”»å‡»ä½ çš„æœåŠ¡å™¨ã€‚å½“ç„¶äº†ï¼Œä½ è¿˜å¯ä»¥å¤šåŒ…å‡ å±‚ï¼Œå¯ä»¥MD5å’Œå…¶å®ƒåŠ å¯†ç®—æ³•æ··åˆä½¿ç”¨(æ¯”å¦‚DESç­‰)ã€‚</p>
<p>(2)è¯·æ±‚å‚æ•°æ ¡éªŒ<br>å¯¹äºæœåŠ¡å™¨è€Œè¨€ï¼Œæ’é™¤ç³»ç»Ÿé—®é¢˜ï¼Œæœ€å¤§çš„é—®é¢˜å°±æ˜¯å®³æ€•è¯·æ±‚è¢«æ‹¦æˆªï¼Œæ‹¦æˆªä¿®æ”¹ä¹‹åå°±æœ‰å¾ˆå¤šæ¼æ´çš„å¯èƒ½æ€§ã€‚é€šå¸¸ä¸ºäº†é¿å…è¢«æ‹¦æˆªï¼Œä¼šå¯¹è¯·æ±‚å‚æ•°è¿›è¡Œæ ¡éªŒï¼Œå°±ç®—æ‹¦æˆªäº†è¯·æ±‚å‚æ•°ä¿®æ”¹äº†ï¼Œåªè¦æ¨¡æ‹Ÿä¸å‡ºMD5åŠ å¯†å‡ºæ¥çš„å€¼ï¼ŒæœåŠ¡å™¨çš„è¿‡æ»¤å™¨ä¼šç›´æ¥å°†å…¶æ‹¦æˆªã€‚</p>
<p>(3)æ–‡ä»¶æ ¡éªŒ<br>å¯¹äºä¸€äº›å›¾ç‰‡æˆ–è€…æ˜¯ä¸€äº›æ¯”è¾ƒå°çš„æ–‡ä»¶æ¥è¯´ï¼Œå¯ä»¥ä¸ç”¨MD5ç®—æ³•æ ¡éªŒï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€æ¬¡è¯·æ±‚å°±å®Œæˆäº†ä¸Šä¼ ï¼Œè€Œä¸”æ˜¾ç¤ºçš„æ—¶å€™ä¹Ÿä¸éœ€è¦éªŒè¯å›¾ç‰‡çš„ä¸å®Œæ•´æ€§ã€‚<br>å¦‚æœæœ‰ä¸€ä¸ª5MBçš„æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯å°†å…¶åˆ†å‰²æˆ5ä»½1MBçš„æ–‡ä»¶ï¼Œæ–‡ä»¶åœ¨ä¸Šä¼ çš„æ—¶å€™ï¼Œä¸Šä¼ ä¸¤ä¸ªMD5å€¼ï¼Œä¸€ä¸ªæ˜¯å½“å‰ä¸Šä¼ çš„1MBæ–‡ä»¶æµçš„MD5ï¼Œå¦ä¸€ä¸ªæ˜¯æ‹¼æ¥ä¹‹åçš„MD5ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼ä¹Ÿèƒ½ä¿è¯æ–‡ä»¶çš„å®Œæ•´æ€§ã€‚<br>ç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
<p>index.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script src=&quot;md5.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var code = &quot;123456&quot;;</span><br><span class="line">        var username = &quot;123456&quot;;</span><br><span class="line">        var password = &quot;123456&quot;;</span><br><span class="line">        var str1 = hex_md5(&quot;123456&quot;);</span><br><span class="line">        var str2 = b64_md5(&quot;123456&quot;);</span><br><span class="line">        var str3 = str_md5(&quot;123456&quot;);</span><br><span class="line">        var str4 = hex_hmac_md5(code,code);</span><br><span class="line">        var str5 = b64_hmac_md5(username,username);</span><br><span class="line">        var str6 = str_hmac_md5(password,password);</span><br><span class="line">        console.log(str1);            // e10adc3949ba59abbe56e057f20f883e</span><br><span class="line">        console.log(str2);            // 4QrcOUm6Wau+VuBX8g+IPg</span><br><span class="line">        console.log(str3);            // Ã¡Ãœ9IÂºYÂ«Â¾VÃ WÃ²Âˆ&gt;</span><br><span class="line">        console.log(str4);            // 30ce71a73bdd908c3955a90e8f7429ef</span><br><span class="line">        console.log(str5);            // MM5xpzvdkIw5VakOj3Qp7w</span><br><span class="line">        console.log(str6);            // 0ÃqÂ§;ÃÂÂŒ9UÂ©Ât)Ã¯</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>md5.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message</span><br><span class="line"> * Digest Algorithm, as defined in RFC 1321.</span><br><span class="line"> * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.</span><br><span class="line"> * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet</span><br><span class="line"> * Distributed under the BSD License</span><br><span class="line"> * See http://pajhome.org.uk/crypt/md5 for more info.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Configurable variables. You may need to tweak these to be compatible with</span><br><span class="line"> * the server-side, but the defaults work in most cases.</span><br><span class="line"> */</span><br><span class="line">var hexcase = 0;  /* hex output format. 0 - lowercase; 1 - uppercase        */</span><br><span class="line">var b64pad  = &quot;&quot;; /* base-64 pad character. &quot;=&quot; for strict RFC compliance   */</span><br><span class="line">var chrsz   = 8;  /* bits per input character. 8 - ASCII; 16 - Unicode      */</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * These are the functions you&apos;ll usually want to call</span><br><span class="line"> * They take string arguments and return either hex or base-64 encoded strings</span><br><span class="line"> */</span><br><span class="line">function hex_md5(s)&#123; return binl2hex(core_md5(str2binl(s), s.length * chrsz));&#125;</span><br><span class="line">function b64_md5(s)&#123; return binl2b64(core_md5(str2binl(s), s.length * chrsz));&#125;</span><br><span class="line">function str_md5(s)&#123; return binl2str(core_md5(str2binl(s), s.length * chrsz));&#125;</span><br><span class="line">function hex_hmac_md5(key, data) &#123; return binl2hex(core_hmac_md5(key, data)); &#125;</span><br><span class="line">function b64_hmac_md5(key, data) &#123; return binl2b64(core_hmac_md5(key, data)); &#125;</span><br><span class="line">function str_hmac_md5(key, data) &#123; return binl2str(core_hmac_md5(key, data)); &#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Perform a simple self-test to see if the VM is working</span><br><span class="line"> */</span><br><span class="line">function md5_vm_test()</span><br><span class="line">&#123;</span><br><span class="line">  return hex_md5(&quot;abc&quot;) == &quot;900150983cd24fb0d6963f7d28e17f72&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Calculate the MD5 of an array of little-endian words, and a bit length</span><br><span class="line"> */</span><br><span class="line">function core_md5(x, len)</span><br><span class="line">&#123;</span><br><span class="line">  /* append padding */</span><br><span class="line">  x[len &gt;&gt; 5] |= 0x80 &lt;&lt; ((len) % 32);</span><br><span class="line">  x[(((len + 64) &gt;&gt;&gt; 9) &lt;&lt; 4) + 14] = len;</span><br><span class="line"></span><br><span class="line">  var a =  1732584193;</span><br><span class="line">  var b = -271733879;</span><br><span class="line">  var c = -1732584194;</span><br><span class="line">  var d =  271733878;</span><br><span class="line"></span><br><span class="line">  for(var i = 0; i &lt; x.length; i += 16)</span><br><span class="line">  &#123;</span><br><span class="line">    var olda = a;</span><br><span class="line">    var oldb = b;</span><br><span class="line">    var oldc = c;</span><br><span class="line">    var oldd = d;</span><br><span class="line"></span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);</span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);</span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+10], 17, -42063);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);</span><br><span class="line">    a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);</span><br><span class="line">    d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);</span><br><span class="line">    c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);</span><br><span class="line">    b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);</span><br><span class="line"></span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);</span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);</span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);</span><br><span class="line">    a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);</span><br><span class="line">    d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);</span><br><span class="line">    c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);</span><br><span class="line">    b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);</span><br><span class="line"></span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);</span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);</span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);</span><br><span class="line">    a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);</span><br><span class="line">    d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);</span><br><span class="line">    c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);</span><br><span class="line">    b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);</span><br><span class="line"></span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);</span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);</span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);</span><br><span class="line">    a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);</span><br><span class="line">    d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);</span><br><span class="line">    c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);</span><br><span class="line">    b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);</span><br><span class="line"></span><br><span class="line">    a = safe_add(a, olda);</span><br><span class="line">    b = safe_add(b, oldb);</span><br><span class="line">    c = safe_add(c, oldc);</span><br><span class="line">    d = safe_add(d, oldd);</span><br><span class="line">  &#125;</span><br><span class="line">  return Array(a, b, c, d);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * These functions implement the four basic operations the algorithm uses.</span><br><span class="line"> */</span><br><span class="line">function md5_cmn(q, a, b, x, s, t)</span><br><span class="line">&#123;</span><br><span class="line">  return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);</span><br><span class="line">&#125;</span><br><span class="line">function md5_ff(a, b, c, d, x, s, t)</span><br><span class="line">&#123;</span><br><span class="line">  return md5_cmn((b &amp; c) | ((~b) &amp; d), a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line">function md5_gg(a, b, c, d, x, s, t)</span><br><span class="line">&#123;</span><br><span class="line">  return md5_cmn((b &amp; d) | (c &amp; (~d)), a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line">function md5_hh(a, b, c, d, x, s, t)</span><br><span class="line">&#123;</span><br><span class="line">  return md5_cmn(b ^ c ^ d, a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line">function md5_ii(a, b, c, d, x, s, t)</span><br><span class="line">&#123;</span><br><span class="line">  return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Calculate the HMAC-MD5, of a key and some data</span><br><span class="line"> */</span><br><span class="line">function core_hmac_md5(key, data)</span><br><span class="line">&#123;</span><br><span class="line">  var bkey = str2binl(key);</span><br><span class="line">  if(bkey.length &gt; 16) bkey = core_md5(bkey, key.length * chrsz);</span><br><span class="line"></span><br><span class="line">  var ipad = Array(16), opad = Array(16);</span><br><span class="line">  for(var i = 0; i &lt; 16; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    ipad[i] = bkey[i] ^ 0x36363636;</span><br><span class="line">    opad[i] = bkey[i] ^ 0x5C5C5C5C;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var hash = core_md5(ipad.concat(str2binl(data)), 512 + data.length * chrsz);</span><br><span class="line">  return core_md5(opad.concat(hash), 512 + 128);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Add integers, wrapping at 2^32. This uses 16-bit operations internally</span><br><span class="line"> * to work around bugs in some JS interpreters.</span><br><span class="line"> */</span><br><span class="line">function safe_add(x, y)</span><br><span class="line">&#123;</span><br><span class="line">  var lsw = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);</span><br><span class="line">  var msw = (x &gt;&gt; 16) + (y &gt;&gt; 16) + (lsw &gt;&gt; 16);</span><br><span class="line">  return (msw &lt;&lt; 16) | (lsw &amp; 0xFFFF);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Bitwise rotate a 32-bit number to the left.</span><br><span class="line"> */</span><br><span class="line">function bit_rol(num, cnt)</span><br><span class="line">&#123;</span><br><span class="line">  return (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (32 - cnt));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Convert a string to an array of little-endian words</span><br><span class="line"> * If chrsz is ASCII, characters &gt;255 have their hi-byte silently ignored.</span><br><span class="line"> */</span><br><span class="line">function str2binl(str)</span><br><span class="line">&#123;</span><br><span class="line">  var bin = Array();</span><br><span class="line">  var mask = (1 &lt;&lt; chrsz) - 1;</span><br><span class="line">  for(var i = 0; i &lt; str.length * chrsz; i += chrsz)</span><br><span class="line">    bin[i&gt;&gt;5] |= (str.charCodeAt(i / chrsz) &amp; mask) &lt;&lt; (i%32);</span><br><span class="line">  return bin;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Convert an array of little-endian words to a string</span><br><span class="line"> */</span><br><span class="line">function binl2str(bin)</span><br><span class="line">&#123;</span><br><span class="line">  var str = &quot;&quot;;</span><br><span class="line">  var mask = (1 &lt;&lt; chrsz) - 1;</span><br><span class="line">  for(var i = 0; i &lt; bin.length * 32; i += chrsz)</span><br><span class="line">    str += String.fromCharCode((bin[i&gt;&gt;5] &gt;&gt;&gt; (i % 32)) &amp; mask);</span><br><span class="line">  return str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Convert an array of little-endian words to a hex string.</span><br><span class="line"> */</span><br><span class="line">function binl2hex(binarray)</span><br><span class="line">&#123;</span><br><span class="line">  var hex_tab = hexcase ? &quot;0123456789ABCDEF&quot; : &quot;0123456789abcdef&quot;;</span><br><span class="line">  var str = &quot;&quot;;</span><br><span class="line">  for(var i = 0; i &lt; binarray.length * 4; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    str += hex_tab.charAt((binarray[i&gt;&gt;2] &gt;&gt; ((i%4)*8+4)) &amp; 0xF) +</span><br><span class="line">           hex_tab.charAt((binarray[i&gt;&gt;2] &gt;&gt; ((i%4)*8  )) &amp; 0xF);</span><br><span class="line">  &#125;</span><br><span class="line">  return str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Convert an array of little-endian words to a base-64 string</span><br><span class="line"> */</span><br><span class="line">function binl2b64(binarray)</span><br><span class="line">&#123;</span><br><span class="line">  var tab = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</span><br><span class="line">  var str = &quot;&quot;;</span><br><span class="line">  for(var i = 0; i &lt; binarray.length * 4; i += 3)</span><br><span class="line">  &#123;</span><br><span class="line">    var triplet = (((binarray[i   &gt;&gt; 2] &gt;&gt; 8 * ( i   %4)) &amp; 0xFF) &lt;&lt; 16)</span><br><span class="line">                | (((binarray[i+1 &gt;&gt; 2] &gt;&gt; 8 * ((i+1)%4)) &amp; 0xFF) &lt;&lt; 8 )</span><br><span class="line">                |  ((binarray[i+2 &gt;&gt; 2] &gt;&gt; 8 * ((i+2)%4)) &amp; 0xFF);</span><br><span class="line">    for(var j = 0; j &lt; 4; j++)</span><br><span class="line">    &#123;</span><br><span class="line">      if(i * 8 + j * 6 &gt; binarray.length * 32) str += b64pad;</span><br><span class="line">      else str += tab.charAt((triplet &gt;&gt; 6*(3-j)) &amp; 0x3F);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3><span id="ä¸‰-desåŠ å¯†">ä¸‰ã€DESåŠ å¯†</span></h3><p>DESæ˜¯ä¸€ç§å…¸å‹çš„å—åŠ å¯†æ–¹æ³•:å°†å›ºå®šé•¿åº¦çš„æ˜æ–‡é€šè¿‡ä¸€ç³»åˆ—å¤æ‚çš„æ“ä½œå˜æˆåŒæ ·é•¿åº¦çš„å¯†æ–‡ï¼Œå—çš„é•¿åº¦ä¸º64ä½ã€‚<br>åŒæ—¶ï¼ŒDESä½¿ç”¨çš„å¯†é’¥æ¥è‡ªå®šä¹‰å˜æ¢è¿‡ç¨‹ï¼Œå› æ­¤ç®—æ³•è®¤ä¸ºåªæœ‰æŒæœ‰åŠ å¯†æ‰€ç”¨çš„å¯†é’¥çš„ç”¨æˆ·æ‰èƒ½è§£å¯†å¯†æ–‡ã€‚DESçš„å¯†é’¥è¡¨æ˜ä¸Šæ˜¯64ä½ï¼Œå®é™…æœ‰æ•ˆå¯†é’¥é•¿åº¦ä¸º56ä½ï¼Œå…¶ä½™8ä½å¯ä»¥ç”¨äºå¥‡å¶æ ¡éªŒã€‚</p>
<p>DESç°åœ¨å·²ç»ä¸è¢«è§†ä¸ºä¸€ç§å®‰å…¨çš„åŠ å¯†ç®—æ³•ï¼Œä¸»è¦åŸå› æ˜¯å®ƒä½¿ç”¨çš„56ä½å¯†é’¥è¿‡çŸ­ã€‚</p>
<p>ä¸ºäº†æä¾›å®ç”¨æ‰€éœ€çš„å®‰å…¨æ€§ï¼Œå¯ä»¥ä½¿ç”¨DESçš„æ´¾ç”Ÿç®—æ³•ï¼Œ3DESæ¥è¿›è¡ŒåŠ å¯†(è™½ç„¶3DESä¹Ÿå­˜åœ¨ç†è®ºä¸Šçš„æ”»å‡»æ–¹æ³•)</p>
<p>ç¤ºä¾‹(DESåŠ å¯†å’Œè§£å¯†):<br>index.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span><br><span class="line">	&lt;script type=&quot;text/javascript&quot; src=&quot;des.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">	&lt;script&gt;		</span><br><span class="line">		function getResult()&#123;</span><br><span class="line">			//å¾…åŠ å¯†å­—ç¬¦ä¸²</span><br><span class="line">			var str = document.getElementById(&quot;str&quot;).innerHTML;</span><br><span class="line">			//ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»ï¼›ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªå‚æ•°å¯é€‰</span><br><span class="line">			var key1 = &quot;youcongtech&quot;;</span><br><span class="line">			var key2 = &quot;test001&quot;;</span><br><span class="line">			var key3 = &quot;test002&quot;; </span><br><span class="line">			//åŠ å¯†æ–¹æ³•		</span><br><span class="line">			var  enResult = strEnc(str,key1,key2,key3);			</span><br><span class="line">			//è§£å¯†æ–¹æ³•</span><br><span class="line">			var deResult = strDec(enResult,key1,key2,key3);</span><br><span class="line">			//å±•ç¤ºç»“æœ</span><br><span class="line">			document.getElementById(&quot;enStr&quot;).innerHTML = enResult; </span><br><span class="line">			document.getElementById(&quot;dnStr&quot;).innerHTML = deResult; </span><br><span class="line">		&#125;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; value=&quot;è·å–åŠ å¯†ç»“æœä¸è§£å¯†ç»“æœ&quot; onclick=&quot;getResult()&quot; /&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">		  &lt;td align=&quot;left&quot;&gt;å­—ç¬¦ä¸²ï¼š&lt;/td&gt;</span><br><span class="line">		  &lt;td&gt;&lt;span id=&quot;str&quot;&gt;admin&lt;/span&gt;&lt;/td&gt;		 </span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;		  </span><br><span class="line">		  &lt;td&gt;åŠ å¯†keyï¼š&lt;/td&gt;</span><br><span class="line">		  &lt;td&gt;key1=&lt;span id=&quot;key1&quot;&gt;1&lt;/span&gt;;key2=&lt;span id=&quot;key2&quot;&gt;2&lt;/span&gt;;key3=&lt;span id=&quot;key3&quot;&gt;3&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">		  &lt;td align=&quot;left&quot;&gt;åŠ å¯†ç»“æœï¼š&lt;/td&gt;</span><br><span class="line">		  &lt;td align=&quot;left&quot;&gt;&lt;label id = &quot;enStr&quot;&gt;&lt;/label&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">		  &lt;td align=&quot;left&quot;&gt;è§£å¯†ç»“æœï¼š &lt;/td&gt;</span><br><span class="line">		  &lt;td align=&quot;left&quot;&gt;&lt;label id = &quot;dnStr&quot;&gt;&lt;/label&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>des.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* DESåŠ å¯†/è§£å¯†</span><br><span class="line">* @Copyright Copyright (c) 2006</span><br><span class="line">* @author Guapo</span><br><span class="line">* @see DESCore</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* encrypt the string to string made up of hex</span><br><span class="line">* return the encrypted string</span><br><span class="line">*/</span><br><span class="line">function strEnc(data,firstKey,secondKey,thirdKey)&#123;</span><br><span class="line"></span><br><span class="line"> var leng = data.length;</span><br><span class="line"> var encData = &quot;&quot;;</span><br><span class="line"> var firstKeyBt,secondKeyBt,thirdKeyBt,firstLength,secondLength,thirdLength;</span><br><span class="line"> if(firstKey != null &amp;&amp; firstKey != &quot;&quot;)&#123;    </span><br><span class="line">   firstKeyBt = getKeyBytes(firstKey);</span><br><span class="line">   firstLength = firstKeyBt.length;</span><br><span class="line"> &#125;</span><br><span class="line"> if(secondKey != null &amp;&amp; secondKey != &quot;&quot;)&#123;</span><br><span class="line">   secondKeyBt = getKeyBytes(secondKey);</span><br><span class="line">   secondLength = secondKeyBt.length;</span><br><span class="line"> &#125;</span><br><span class="line"> if(thirdKey != null &amp;&amp; thirdKey != &quot;&quot;)&#123;</span><br><span class="line">   thirdKeyBt = getKeyBytes(thirdKey);</span><br><span class="line">   thirdLength = thirdKeyBt.length;</span><br><span class="line"> &#125;  </span><br><span class="line"> </span><br><span class="line"> if(leng &gt; 0)&#123;</span><br><span class="line">   if(leng &lt; 4)&#123;</span><br><span class="line">     var bt = strToBt(data);      </span><br><span class="line">     var encByte ;</span><br><span class="line">     if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null &amp;&amp; thirdKey != &quot;&quot;)&#123;</span><br><span class="line">       var tempBt;</span><br><span class="line">       var x,y,z;</span><br><span class="line">       tempBt = bt;        </span><br><span class="line">       for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">         tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">       &#125;</span><br><span class="line">       for(y = 0;y &lt; secondLength ;y ++)&#123;</span><br><span class="line">         tempBt = enc(tempBt,secondKeyBt[y]);</span><br><span class="line">       &#125;</span><br><span class="line">       for(z = 0;z &lt; thirdLength ;z ++)&#123;</span><br><span class="line">         tempBt = enc(tempBt,thirdKeyBt[z]);</span><br><span class="line">       &#125;        </span><br><span class="line">       encByte = tempBt;        </span><br><span class="line">     &#125;else&#123;</span><br><span class="line">       if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot;)&#123;</span><br><span class="line">         var tempBt;</span><br><span class="line">         var x,y;</span><br><span class="line">         tempBt = bt;</span><br><span class="line">         for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">         &#125;</span><br><span class="line">         for(y = 0;y &lt; secondLength ;y ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,secondKeyBt[y]);</span><br><span class="line">         &#125;</span><br><span class="line">         encByte = tempBt;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">         if(firstKey != null &amp;&amp; firstKey !=&quot;&quot;)&#123;            </span><br><span class="line">           var tempBt;</span><br><span class="line">           var x = 0;</span><br><span class="line">           tempBt = bt;            </span><br><span class="line">           for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">             tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">           &#125;</span><br><span class="line">           encByte = tempBt;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;        </span><br><span class="line">     &#125;</span><br><span class="line">     encData = bt64ToHex(encByte);</span><br><span class="line">   &#125;else&#123;</span><br><span class="line">     var iterator = parseInt(leng/4);</span><br><span class="line">     var remainder = leng%4;</span><br><span class="line">     var i=0;      </span><br><span class="line">     for(i = 0;i &lt; iterator;i++)&#123;</span><br><span class="line">       var tempData = data.substring(i*4+0,i*4+4);</span><br><span class="line">       var tempByte = strToBt(tempData);</span><br><span class="line">       var encByte ;</span><br><span class="line">       if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null &amp;&amp; thirdKey != &quot;&quot;)&#123;</span><br><span class="line">         var tempBt;</span><br><span class="line">         var x,y,z;</span><br><span class="line">         tempBt = tempByte;</span><br><span class="line">         for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">         &#125;</span><br><span class="line">         for(y = 0;y &lt; secondLength ;y ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,secondKeyBt[y]);</span><br><span class="line">         &#125;</span><br><span class="line">         for(z = 0;z &lt; thirdLength ;z ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,thirdKeyBt[z]);</span><br><span class="line">         &#125;</span><br><span class="line">         encByte = tempBt;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">         if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot;)&#123;</span><br><span class="line">           var tempBt;</span><br><span class="line">           var x,y;</span><br><span class="line">           tempBt = tempByte;</span><br><span class="line">           for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">             tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">           &#125;</span><br><span class="line">           for(y = 0;y &lt; secondLength ;y ++)&#123;</span><br><span class="line">             tempBt = enc(tempBt,secondKeyBt[y]);</span><br><span class="line">           &#125;</span><br><span class="line">           encByte = tempBt;</span><br><span class="line">         &#125;else&#123;</span><br><span class="line">           if(firstKey != null &amp;&amp; firstKey !=&quot;&quot;)&#123;                      </span><br><span class="line">             var tempBt;</span><br><span class="line">             var x;</span><br><span class="line">             tempBt = tempByte;</span><br><span class="line">             for(x = 0;x &lt; firstLength ;x ++)&#123;                </span><br><span class="line">               tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">             &#125;</span><br><span class="line">             encByte = tempBt;              </span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       encData += bt64ToHex(encByte);</span><br><span class="line">     &#125;      </span><br><span class="line">     if(remainder &gt; 0)&#123;</span><br><span class="line">       var remainderData = data.substring(iterator*4+0,leng);</span><br><span class="line">       var tempByte = strToBt(remainderData);</span><br><span class="line">       var encByte ;</span><br><span class="line">       if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null &amp;&amp; thirdKey != &quot;&quot;)&#123;</span><br><span class="line">         var tempBt;</span><br><span class="line">         var x,y,z;</span><br><span class="line">         tempBt = tempByte;</span><br><span class="line">         for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">         &#125;</span><br><span class="line">         for(y = 0;y &lt; secondLength ;y ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,secondKeyBt[y]);</span><br><span class="line">         &#125;</span><br><span class="line">         for(z = 0;z &lt; thirdLength ;z ++)&#123;</span><br><span class="line">           tempBt = enc(tempBt,thirdKeyBt[z]);</span><br><span class="line">         &#125;</span><br><span class="line">         encByte = tempBt;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">         if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot;)&#123;</span><br><span class="line">           var tempBt;</span><br><span class="line">           var x,y;</span><br><span class="line">           tempBt = tempByte;</span><br><span class="line">           for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">             tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">           &#125;</span><br><span class="line">           for(y = 0;y &lt; secondLength ;y ++)&#123;</span><br><span class="line">             tempBt = enc(tempBt,secondKeyBt[y]);</span><br><span class="line">           &#125;</span><br><span class="line">           encByte = tempBt;</span><br><span class="line">         &#125;else&#123;</span><br><span class="line">           if(firstKey != null &amp;&amp; firstKey !=&quot;&quot;)&#123;            </span><br><span class="line">             var tempBt;</span><br><span class="line">             var x;</span><br><span class="line">             tempBt = tempByte;</span><br><span class="line">             for(x = 0;x &lt; firstLength ;x ++)&#123;</span><br><span class="line">               tempBt = enc(tempBt,firstKeyBt[x]);</span><br><span class="line">             &#125;</span><br><span class="line">             encByte = tempBt;</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       encData += bt64ToHex(encByte);</span><br><span class="line">     &#125;                </span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> return encData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* decrypt the encrypted string to the original string </span><br><span class="line">*</span><br><span class="line">* return  the original string  </span><br><span class="line">*/</span><br><span class="line">function strDec(data,firstKey,secondKey,thirdKey)&#123;</span><br><span class="line"> var leng = data.length;</span><br><span class="line"> var decStr = &quot;&quot;;</span><br><span class="line"> var firstKeyBt,secondKeyBt,thirdKeyBt,firstLength,secondLength,thirdLength;</span><br><span class="line"> if(firstKey != null &amp;&amp; firstKey != &quot;&quot;)&#123;    </span><br><span class="line">   firstKeyBt = getKeyBytes(firstKey);</span><br><span class="line">   firstLength = firstKeyBt.length;</span><br><span class="line"> &#125;</span><br><span class="line"> if(secondKey != null &amp;&amp; secondKey != &quot;&quot;)&#123;</span><br><span class="line">   secondKeyBt = getKeyBytes(secondKey);</span><br><span class="line">   secondLength = secondKeyBt.length;</span><br><span class="line"> &#125;</span><br><span class="line"> if(thirdKey != null &amp;&amp; thirdKey != &quot;&quot;)&#123;</span><br><span class="line">   thirdKeyBt = getKeyBytes(thirdKey);</span><br><span class="line">   thirdLength = thirdKeyBt.length;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"> var iterator = parseInt(leng/16);</span><br><span class="line"> var i=0;  </span><br><span class="line"> for(i = 0;i &lt; iterator;i++)&#123;</span><br><span class="line">   var tempData = data.substring(i*16+0,i*16+16);    </span><br><span class="line">   var strByte = hexToBt64(tempData);    </span><br><span class="line">   var intByte = new Array(64);</span><br><span class="line">   var j = 0;</span><br><span class="line">   for(j = 0;j &lt; 64; j++)&#123;</span><br><span class="line">     intByte[j] = parseInt(strByte.substring(j,j+1));</span><br><span class="line">   &#125;    </span><br><span class="line">   var decByte;</span><br><span class="line">   if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null &amp;&amp; thirdKey != &quot;&quot;)&#123;</span><br><span class="line">     var tempBt;</span><br><span class="line">     var x,y,z;</span><br><span class="line">     tempBt = intByte;</span><br><span class="line">     for(x = thirdLength - 1;x &gt;= 0;x --)&#123;</span><br><span class="line">       tempBt = dec(tempBt,thirdKeyBt[x]);</span><br><span class="line">     &#125;</span><br><span class="line">     for(y = secondLength - 1;y &gt;= 0;y --)&#123;</span><br><span class="line">       tempBt = dec(tempBt,secondKeyBt[y]);</span><br><span class="line">     &#125;</span><br><span class="line">     for(z = firstLength - 1;z &gt;= 0 ;z --)&#123;</span><br><span class="line">       tempBt = dec(tempBt,firstKeyBt[z]);</span><br><span class="line">     &#125;</span><br><span class="line">     decByte = tempBt;</span><br><span class="line">   &#125;else&#123;</span><br><span class="line">     if(firstKey != null &amp;&amp; firstKey !=&quot;&quot; &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot;)&#123;</span><br><span class="line">       var tempBt;</span><br><span class="line">       var x,y,z;</span><br><span class="line">       tempBt = intByte;</span><br><span class="line">       for(x = secondLength - 1;x &gt;= 0 ;x --)&#123;</span><br><span class="line">         tempBt = dec(tempBt,secondKeyBt[x]);</span><br><span class="line">       &#125;</span><br><span class="line">       for(y = firstLength - 1;y &gt;= 0 ;y --)&#123;</span><br><span class="line">         tempBt = dec(tempBt,firstKeyBt[y]);</span><br><span class="line">       &#125;</span><br><span class="line">       decByte = tempBt;</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">       if(firstKey != null &amp;&amp; firstKey !=&quot;&quot;)&#123;</span><br><span class="line">         var tempBt;</span><br><span class="line">         var x,y,z;</span><br><span class="line">         tempBt = intByte;</span><br><span class="line">         for(x = firstLength - 1;x &gt;= 0 ;x --)&#123;</span><br><span class="line">           tempBt = dec(tempBt,firstKeyBt[x]);</span><br><span class="line">         &#125;</span><br><span class="line">         decByte = tempBt;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   decStr += byteToString(decByte);</span><br><span class="line"> &#125;      </span><br><span class="line"> return decStr;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">* chang the string into the bit array</span><br><span class="line">* </span><br><span class="line">* return bit array(it&apos;s length % 64 = 0)</span><br><span class="line">*/</span><br><span class="line">function getKeyBytes(key)&#123;</span><br><span class="line"> var keyBytes = new Array();</span><br><span class="line"> var leng = key.length;</span><br><span class="line"> var iterator = parseInt(leng/4);</span><br><span class="line"> var remainder = leng%4;</span><br><span class="line"> var i = 0;</span><br><span class="line"> for(i = 0;i &lt; iterator; i ++)&#123;</span><br><span class="line">   keyBytes[i] = strToBt(key.substring(i*4+0,i*4+4));</span><br><span class="line"> &#125;</span><br><span class="line"> if(remainder &gt; 0)&#123;</span><br><span class="line">   keyBytes[i] = strToBt(key.substring(i*4+0,leng));</span><br><span class="line"> &#125;    </span><br><span class="line"> return keyBytes;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* chang the string(it&apos;s length &lt;= 4) into the bit array</span><br><span class="line">* </span><br><span class="line">* return bit array(it&apos;s length = 64)</span><br><span class="line">*/</span><br><span class="line">function strToBt(str)&#123;  </span><br><span class="line"> var leng = str.length;</span><br><span class="line"> var bt = new Array(64);</span><br><span class="line"> if(leng &lt; 4)&#123;</span><br><span class="line">   var i=0,j=0,p=0,q=0;</span><br><span class="line">   for(i = 0;i&lt;leng;i++)&#123;</span><br><span class="line">     var k = str.charCodeAt(i);</span><br><span class="line">     for(j=0;j&lt;16;j++)&#123;      </span><br><span class="line">       var pow=1,m=0;</span><br><span class="line">       for(m=15;m&gt;j;m--)&#123;</span><br><span class="line">         pow *= 2;</span><br><span class="line">       &#125;        </span><br><span class="line">       bt[16*i+j]=parseInt(k/pow)%2;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   for(p = leng;p&lt;4;p++)&#123;</span><br><span class="line">     var k = 0;</span><br><span class="line">     for(q=0;q&lt;16;q++)&#123;      </span><br><span class="line">       var pow=1,m=0;</span><br><span class="line">       for(m=15;m&gt;q;m--)&#123;</span><br><span class="line">         pow *= 2;</span><br><span class="line">       &#125;        </span><br><span class="line">       bt[16*p+q]=parseInt(k/pow)%2;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;  </span><br><span class="line"> &#125;else&#123;</span><br><span class="line">   for(i = 0;i&lt;4;i++)&#123;</span><br><span class="line">     var k = str.charCodeAt(i);</span><br><span class="line">     for(j=0;j&lt;16;j++)&#123;      </span><br><span class="line">       var pow=1;</span><br><span class="line">       for(m=15;m&gt;j;m--)&#123;</span><br><span class="line">         pow *= 2;</span><br><span class="line">       &#125;        </span><br><span class="line">       bt[16*i+j]=parseInt(k/pow)%2;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;  </span><br><span class="line"> &#125;</span><br><span class="line"> return bt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* chang the bit(it&apos;s length = 4) into the hex</span><br><span class="line">* </span><br><span class="line">* return hex</span><br><span class="line">*/</span><br><span class="line">function bt4ToHex(binary) &#123;</span><br><span class="line"> var hex;</span><br><span class="line"> switch (binary) &#123;</span><br><span class="line">   case &quot;0000&quot; : hex = &quot;0&quot;; break;</span><br><span class="line">   case &quot;0001&quot; : hex = &quot;1&quot;; break;</span><br><span class="line">   case &quot;0010&quot; : hex = &quot;2&quot;; break;</span><br><span class="line">   case &quot;0011&quot; : hex = &quot;3&quot;; break;</span><br><span class="line">   case &quot;0100&quot; : hex = &quot;4&quot;; break;</span><br><span class="line">   case &quot;0101&quot; : hex = &quot;5&quot;; break;</span><br><span class="line">   case &quot;0110&quot; : hex = &quot;6&quot;; break;</span><br><span class="line">   case &quot;0111&quot; : hex = &quot;7&quot;; break;</span><br><span class="line">   case &quot;1000&quot; : hex = &quot;8&quot;; break;</span><br><span class="line">   case &quot;1001&quot; : hex = &quot;9&quot;; break;</span><br><span class="line">   case &quot;1010&quot; : hex = &quot;A&quot;; break;</span><br><span class="line">   case &quot;1011&quot; : hex = &quot;B&quot;; break;</span><br><span class="line">   case &quot;1100&quot; : hex = &quot;C&quot;; break;</span><br><span class="line">   case &quot;1101&quot; : hex = &quot;D&quot;; break;</span><br><span class="line">   case &quot;1110&quot; : hex = &quot;E&quot;; break;</span><br><span class="line">   case &quot;1111&quot; : hex = &quot;F&quot;; break;</span><br><span class="line"> &#125;</span><br><span class="line"> return hex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* chang the hex into the bit(it&apos;s length = 4)</span><br><span class="line">* </span><br><span class="line">* return the bit(it&apos;s length = 4)</span><br><span class="line">*/</span><br><span class="line">function hexToBt4(hex) &#123;</span><br><span class="line"> var binary;</span><br><span class="line"> switch (hex) &#123;</span><br><span class="line">   case &quot;0&quot; : binary = &quot;0000&quot;; break;</span><br><span class="line">   case &quot;1&quot; : binary = &quot;0001&quot;; break;</span><br><span class="line">   case &quot;2&quot; : binary = &quot;0010&quot;; break;</span><br><span class="line">   case &quot;3&quot; : binary = &quot;0011&quot;; break;</span><br><span class="line">   case &quot;4&quot; : binary = &quot;0100&quot;; break;</span><br><span class="line">   case &quot;5&quot; : binary = &quot;0101&quot;; break;</span><br><span class="line">   case &quot;6&quot; : binary = &quot;0110&quot;; break;</span><br><span class="line">   case &quot;7&quot; : binary = &quot;0111&quot;; break;</span><br><span class="line">   case &quot;8&quot; : binary = &quot;1000&quot;; break;</span><br><span class="line">   case &quot;9&quot; : binary = &quot;1001&quot;; break;</span><br><span class="line">   case &quot;A&quot; : binary = &quot;1010&quot;; break;</span><br><span class="line">   case &quot;B&quot; : binary = &quot;1011&quot;; break;</span><br><span class="line">   case &quot;C&quot; : binary = &quot;1100&quot;; break;</span><br><span class="line">   case &quot;D&quot; : binary = &quot;1101&quot;; break;</span><br><span class="line">   case &quot;E&quot; : binary = &quot;1110&quot;; break;</span><br><span class="line">   case &quot;F&quot; : binary = &quot;1111&quot;; break;</span><br><span class="line"> &#125;</span><br><span class="line"> return binary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* chang the bit(it&apos;s length = 64) into the string</span><br><span class="line">* </span><br><span class="line">* return string</span><br><span class="line">*/</span><br><span class="line">function byteToString(byteData)&#123;</span><br><span class="line"> var str=&quot;&quot;;</span><br><span class="line"> for(i = 0;i&lt;4;i++)&#123;</span><br><span class="line">   var count=0;</span><br><span class="line">   for(j=0;j&lt;16;j++)&#123;        </span><br><span class="line">     var pow=1;</span><br><span class="line">     for(m=15;m&gt;j;m--)&#123;</span><br><span class="line">       pow*=2;</span><br><span class="line">     &#125;              </span><br><span class="line">     count+=byteData[16*i+j]*pow;</span><br><span class="line">   &#125;        </span><br><span class="line">   if(count != 0)&#123;</span><br><span class="line">     str+=String.fromCharCode(count);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> return str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function bt64ToHex(byteData)&#123;</span><br><span class="line"> var hex = &quot;&quot;;</span><br><span class="line"> for(i = 0;i&lt;16;i++)&#123;</span><br><span class="line">   var bt = &quot;&quot;;</span><br><span class="line">   for(j=0;j&lt;4;j++)&#123;    </span><br><span class="line">     bt += byteData[i*4+j];</span><br><span class="line">   &#125;    </span><br><span class="line">   hex+=bt4ToHex(bt);</span><br><span class="line"> &#125;</span><br><span class="line"> return hex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function hexToBt64(hex)&#123;</span><br><span class="line"> var binary = &quot;&quot;;</span><br><span class="line"> for(i = 0;i&lt;16;i++)&#123;</span><br><span class="line">   binary+=hexToBt4(hex.substring(i,i+1));</span><br><span class="line"> &#125;</span><br><span class="line"> return binary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">* the 64 bit des core arithmetic</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">function enc(dataByte,keyByte)&#123;  </span><br><span class="line"> var keys = generateKeys(keyByte);    </span><br><span class="line"> var ipByte   = initPermute(dataByte);  </span><br><span class="line"> var ipLeft   = new Array(32);</span><br><span class="line"> var ipRight  = new Array(32);</span><br><span class="line"> var tempLeft = new Array(32);</span><br><span class="line"> var i = 0,j = 0,k = 0,m = 0, n = 0;</span><br><span class="line"> for(k = 0;k &lt; 32;k ++)&#123;</span><br><span class="line">   ipLeft[k] = ipByte[k];</span><br><span class="line">   ipRight[k] = ipByte[32+k];</span><br><span class="line"> &#125;    </span><br><span class="line"> for(i = 0;i &lt; 16;i ++)&#123;</span><br><span class="line">   for(j = 0;j &lt; 32;j ++)&#123;</span><br><span class="line">     tempLeft[j] = ipLeft[j];</span><br><span class="line">     ipLeft[j] = ipRight[j];      </span><br><span class="line">   &#125;  </span><br><span class="line">   var key = new Array(48);</span><br><span class="line">   for(m = 0;m &lt; 48;m ++)&#123;</span><br><span class="line">     key[m] = keys[i][m];</span><br><span class="line">   &#125;</span><br><span class="line">   var  tempRight = xor(pPermute(sBoxPermute(xor(expandPermute(ipRight),key))), tempLeft);      </span><br><span class="line">   for(n = 0;n &lt; 32;n ++)&#123;</span><br><span class="line">     ipRight[n] = tempRight[n];</span><br><span class="line">   &#125;  </span><br><span class="line">   </span><br><span class="line"> &#125;  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> var finalData =new Array(64);</span><br><span class="line"> for(i = 0;i &lt; 32;i ++)&#123;</span><br><span class="line">   finalData[i] = ipRight[i];</span><br><span class="line">   finalData[32+i] = ipLeft[i];</span><br><span class="line"> &#125;</span><br><span class="line"> return finallyPermute(finalData);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function dec(dataByte,keyByte)&#123;  </span><br><span class="line"> var keys = generateKeys(keyByte);    </span><br><span class="line"> var ipByte   = initPermute(dataByte);  </span><br><span class="line"> var ipLeft   = new Array(32);</span><br><span class="line"> var ipRight  = new Array(32);</span><br><span class="line"> var tempLeft = new Array(32);</span><br><span class="line"> var i = 0,j = 0,k = 0,m = 0, n = 0;</span><br><span class="line"> for(k = 0;k &lt; 32;k ++)&#123;</span><br><span class="line">   ipLeft[k] = ipByte[k];</span><br><span class="line">   ipRight[k] = ipByte[32+k];</span><br><span class="line"> &#125;  </span><br><span class="line"> for(i = 15;i &gt;= 0;i --)&#123;</span><br><span class="line">   for(j = 0;j &lt; 32;j ++)&#123;</span><br><span class="line">     tempLeft[j] = ipLeft[j];</span><br><span class="line">     ipLeft[j] = ipRight[j];      </span><br><span class="line">   &#125;  </span><br><span class="line">   var key = new Array(48);</span><br><span class="line">   for(m = 0;m &lt; 48;m ++)&#123;</span><br><span class="line">     key[m] = keys[i][m];</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   var  tempRight = xor(pPermute(sBoxPermute(xor(expandPermute(ipRight),key))), tempLeft);      </span><br><span class="line">   for(n = 0;n &lt; 32;n ++)&#123;</span><br><span class="line">     ipRight[n] = tempRight[n];</span><br><span class="line">   &#125;  </span><br><span class="line"> &#125;  </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> var finalData =new Array(64);</span><br><span class="line"> for(i = 0;i &lt; 32;i ++)&#123;</span><br><span class="line">   finalData[i] = ipRight[i];</span><br><span class="line">   finalData[32+i] = ipLeft[i];</span><br><span class="line"> &#125;</span><br><span class="line"> return finallyPermute(finalData);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function initPermute(originalData)&#123;</span><br><span class="line"> var ipByte = new Array(64);</span><br><span class="line"> for (i = 0, m = 1, n = 0; i &lt; 4; i++, m += 2, n += 2) &#123;</span><br><span class="line">   for (j = 7, k = 0; j &gt;= 0; j--, k++) &#123;</span><br><span class="line">     ipByte[i * 8 + k] = originalData[j * 8 + m];</span><br><span class="line">     ipByte[i * 8 + k + 32] = originalData[j * 8 + n];</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;    </span><br><span class="line"> return ipByte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function expandPermute(rightData)&#123;  </span><br><span class="line"> var epByte = new Array(48);</span><br><span class="line"> for (i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">   if (i == 0) &#123;</span><br><span class="line">     epByte[i * 6 + 0] = rightData[31];</span><br><span class="line">   &#125; else &#123;</span><br><span class="line">     epByte[i * 6 + 0] = rightData[i * 4 - 1];</span><br><span class="line">   &#125;</span><br><span class="line">   epByte[i * 6 + 1] = rightData[i * 4 + 0];</span><br><span class="line">   epByte[i * 6 + 2] = rightData[i * 4 + 1];</span><br><span class="line">   epByte[i * 6 + 3] = rightData[i * 4 + 2];</span><br><span class="line">   epByte[i * 6 + 4] = rightData[i * 4 + 3];</span><br><span class="line">   if (i == 7) &#123;</span><br><span class="line">     epByte[i * 6 + 5] = rightData[0];</span><br><span class="line">   &#125; else &#123;</span><br><span class="line">     epByte[i * 6 + 5] = rightData[i * 4 + 4];</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;      </span><br><span class="line"> return epByte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function xor(byteOne,byteTwo)&#123;  </span><br><span class="line"> var xorByte = new Array(byteOne.length);</span><br><span class="line"> for(i = 0;i &lt; byteOne.length; i ++)&#123;      </span><br><span class="line">   xorByte[i] = byteOne[i] ^ byteTwo[i];</span><br><span class="line"> &#125;  </span><br><span class="line"> return xorByte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function sBoxPermute(expandByte)&#123;</span><br><span class="line"> </span><br><span class="line">   var sBoxByte = new Array(32);</span><br><span class="line">   var binary = &quot;&quot;;</span><br><span class="line">   var s1 = [</span><br><span class="line">       [14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7],</span><br><span class="line">       [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8],</span><br><span class="line">       [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0],</span><br><span class="line">       [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 ]];</span><br><span class="line"></span><br><span class="line">       /* Table - s2 */</span><br><span class="line">   var s2 = [</span><br><span class="line">       [15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10],</span><br><span class="line">       [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5],</span><br><span class="line">       [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15],</span><br><span class="line">       [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 ]];</span><br><span class="line"></span><br><span class="line">       /* Table - s3 */</span><br><span class="line">   var s3= [</span><br><span class="line">       [10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8],</span><br><span class="line">       [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1],</span><br><span class="line">       [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7],</span><br><span class="line">       [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 ]];</span><br><span class="line">       /* Table - s4 */</span><br><span class="line">   var s4 = [</span><br><span class="line">       [7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15],</span><br><span class="line">       [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9],</span><br><span class="line">       [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4],</span><br><span class="line">       [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 ]];</span><br><span class="line"></span><br><span class="line">       /* Table - s5 */</span><br><span class="line">   var s5 = [</span><br><span class="line">       [2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9],</span><br><span class="line">       [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6],</span><br><span class="line">       [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14],</span><br><span class="line">       [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 ]];</span><br><span class="line"></span><br><span class="line">       /* Table - s6 */</span><br><span class="line">   var s6 = [</span><br><span class="line">       [12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11],</span><br><span class="line">       [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8],</span><br><span class="line">       [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6],</span><br><span class="line">       [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 ]];</span><br><span class="line"></span><br><span class="line">       /* Table - s7 */</span><br><span class="line">   var s7 = [</span><br><span class="line">       [4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1],</span><br><span class="line">       [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6],</span><br><span class="line">       [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2],</span><br><span class="line">       [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]];</span><br><span class="line"></span><br><span class="line">       /* Table - s8 */</span><br><span class="line">   var s8 = [</span><br><span class="line">       [13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7],</span><br><span class="line">       [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2],</span><br><span class="line">       [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8],</span><br><span class="line">       [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]];</span><br><span class="line">   </span><br><span class="line">   for(m=0;m&lt;8;m++)&#123;</span><br><span class="line">   var i=0,j=0;</span><br><span class="line">   i = expandByte[m*6+0]*2+expandByte[m*6+5];</span><br><span class="line">   j = expandByte[m * 6 + 1] * 2 * 2 * 2 </span><br><span class="line">     + expandByte[m * 6 + 2] * 2* 2 </span><br><span class="line">     + expandByte[m * 6 + 3] * 2 </span><br><span class="line">     + expandByte[m * 6 + 4];</span><br><span class="line">   switch (m) &#123;</span><br><span class="line">     case 0 :</span><br><span class="line">       binary = getBoxBinary(s1[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 1 :</span><br><span class="line">       binary = getBoxBinary(s2[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 2 :</span><br><span class="line">       binary = getBoxBinary(s3[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 3 :</span><br><span class="line">       binary = getBoxBinary(s4[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 4 :</span><br><span class="line">       binary = getBoxBinary(s5[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 5 :</span><br><span class="line">       binary = getBoxBinary(s6[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 6 :</span><br><span class="line">       binary = getBoxBinary(s7[i][j]);</span><br><span class="line">       break;</span><br><span class="line">     case 7 :</span><br><span class="line">       binary = getBoxBinary(s8[i][j]);</span><br><span class="line">       break;</span><br><span class="line">   &#125;      </span><br><span class="line">   sBoxByte[m*4+0] = parseInt(binary.substring(0,1));</span><br><span class="line">   sBoxByte[m*4+1] = parseInt(binary.substring(1,2));</span><br><span class="line">   sBoxByte[m*4+2] = parseInt(binary.substring(2,3));</span><br><span class="line">   sBoxByte[m*4+3] = parseInt(binary.substring(3,4));</span><br><span class="line"> &#125;</span><br><span class="line"> return sBoxByte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function pPermute(sBoxByte)&#123;</span><br><span class="line"> var pBoxPermute = new Array(32);</span><br><span class="line"> pBoxPermute[ 0] = sBoxByte[15]; </span><br><span class="line"> pBoxPermute[ 1] = sBoxByte[ 6]; </span><br><span class="line"> pBoxPermute[ 2] = sBoxByte[19]; </span><br><span class="line"> pBoxPermute[ 3] = sBoxByte[20]; </span><br><span class="line"> pBoxPermute[ 4] = sBoxByte[28]; </span><br><span class="line"> pBoxPermute[ 5] = sBoxByte[11]; </span><br><span class="line"> pBoxPermute[ 6] = sBoxByte[27]; </span><br><span class="line"> pBoxPermute[ 7] = sBoxByte[16]; </span><br><span class="line"> pBoxPermute[ 8] = sBoxByte[ 0]; </span><br><span class="line"> pBoxPermute[ 9] = sBoxByte[14]; </span><br><span class="line"> pBoxPermute[10] = sBoxByte[22]; </span><br><span class="line"> pBoxPermute[11] = sBoxByte[25]; </span><br><span class="line"> pBoxPermute[12] = sBoxByte[ 4]; </span><br><span class="line"> pBoxPermute[13] = sBoxByte[17]; </span><br><span class="line"> pBoxPermute[14] = sBoxByte[30]; </span><br><span class="line"> pBoxPermute[15] = sBoxByte[ 9]; </span><br><span class="line"> pBoxPermute[16] = sBoxByte[ 1]; </span><br><span class="line"> pBoxPermute[17] = sBoxByte[ 7]; </span><br><span class="line"> pBoxPermute[18] = sBoxByte[23]; </span><br><span class="line"> pBoxPermute[19] = sBoxByte[13]; </span><br><span class="line"> pBoxPermute[20] = sBoxByte[31]; </span><br><span class="line"> pBoxPermute[21] = sBoxByte[26]; </span><br><span class="line"> pBoxPermute[22] = sBoxByte[ 2]; </span><br><span class="line"> pBoxPermute[23] = sBoxByte[ 8]; </span><br><span class="line"> pBoxPermute[24] = sBoxByte[18]; </span><br><span class="line"> pBoxPermute[25] = sBoxByte[12]; </span><br><span class="line"> pBoxPermute[26] = sBoxByte[29]; </span><br><span class="line"> pBoxPermute[27] = sBoxByte[ 5]; </span><br><span class="line"> pBoxPermute[28] = sBoxByte[21]; </span><br><span class="line"> pBoxPermute[29] = sBoxByte[10]; </span><br><span class="line"> pBoxPermute[30] = sBoxByte[ 3]; </span><br><span class="line"> pBoxPermute[31] = sBoxByte[24];    </span><br><span class="line"> return pBoxPermute;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function finallyPermute(endByte)&#123;    </span><br><span class="line"> var fpByte = new Array(64);  </span><br><span class="line"> fpByte[ 0] = endByte[39]; </span><br><span class="line"> fpByte[ 1] = endByte[ 7]; </span><br><span class="line"> fpByte[ 2] = endByte[47]; </span><br><span class="line"> fpByte[ 3] = endByte[15]; </span><br><span class="line"> fpByte[ 4] = endByte[55]; </span><br><span class="line"> fpByte[ 5] = endByte[23]; </span><br><span class="line"> fpByte[ 6] = endByte[63]; </span><br><span class="line"> fpByte[ 7] = endByte[31]; </span><br><span class="line"> fpByte[ 8] = endByte[38]; </span><br><span class="line"> fpByte[ 9] = endByte[ 6]; </span><br><span class="line"> fpByte[10] = endByte[46]; </span><br><span class="line"> fpByte[11] = endByte[14]; </span><br><span class="line"> fpByte[12] = endByte[54]; </span><br><span class="line"> fpByte[13] = endByte[22]; </span><br><span class="line"> fpByte[14] = endByte[62]; </span><br><span class="line"> fpByte[15] = endByte[30]; </span><br><span class="line"> fpByte[16] = endByte[37]; </span><br><span class="line"> fpByte[17] = endByte[ 5]; </span><br><span class="line"> fpByte[18] = endByte[45]; </span><br><span class="line"> fpByte[19] = endByte[13]; </span><br><span class="line"> fpByte[20] = endByte[53]; </span><br><span class="line"> fpByte[21] = endByte[21]; </span><br><span class="line"> fpByte[22] = endByte[61]; </span><br><span class="line"> fpByte[23] = endByte[29]; </span><br><span class="line"> fpByte[24] = endByte[36]; </span><br><span class="line"> fpByte[25] = endByte[ 4]; </span><br><span class="line"> fpByte[26] = endByte[44]; </span><br><span class="line"> fpByte[27] = endByte[12]; </span><br><span class="line"> fpByte[28] = endByte[52]; </span><br><span class="line"> fpByte[29] = endByte[20]; </span><br><span class="line"> fpByte[30] = endByte[60]; </span><br><span class="line"> fpByte[31] = endByte[28]; </span><br><span class="line"> fpByte[32] = endByte[35]; </span><br><span class="line"> fpByte[33] = endByte[ 3]; </span><br><span class="line"> fpByte[34] = endByte[43]; </span><br><span class="line"> fpByte[35] = endByte[11]; </span><br><span class="line"> fpByte[36] = endByte[51]; </span><br><span class="line"> fpByte[37] = endByte[19]; </span><br><span class="line"> fpByte[38] = endByte[59]; </span><br><span class="line"> fpByte[39] = endByte[27]; </span><br><span class="line"> fpByte[40] = endByte[34]; </span><br><span class="line"> fpByte[41] = endByte[ 2]; </span><br><span class="line"> fpByte[42] = endByte[42]; </span><br><span class="line"> fpByte[43] = endByte[10]; </span><br><span class="line"> fpByte[44] = endByte[50]; </span><br><span class="line"> fpByte[45] = endByte[18]; </span><br><span class="line"> fpByte[46] = endByte[58]; </span><br><span class="line"> fpByte[47] = endByte[26]; </span><br><span class="line"> fpByte[48] = endByte[33]; </span><br><span class="line"> fpByte[49] = endByte[ 1]; </span><br><span class="line"> fpByte[50] = endByte[41]; </span><br><span class="line"> fpByte[51] = endByte[ 9]; </span><br><span class="line"> fpByte[52] = endByte[49]; </span><br><span class="line"> fpByte[53] = endByte[17]; </span><br><span class="line"> fpByte[54] = endByte[57]; </span><br><span class="line"> fpByte[55] = endByte[25]; </span><br><span class="line"> fpByte[56] = endByte[32]; </span><br><span class="line"> fpByte[57] = endByte[ 0]; </span><br><span class="line"> fpByte[58] = endByte[40]; </span><br><span class="line"> fpByte[59] = endByte[ 8]; </span><br><span class="line"> fpByte[60] = endByte[48]; </span><br><span class="line"> fpByte[61] = endByte[16]; </span><br><span class="line"> fpByte[62] = endByte[56]; </span><br><span class="line"> fpByte[63] = endByte[24];</span><br><span class="line"> return fpByte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getBoxBinary(i) &#123;</span><br><span class="line"> var binary = &quot;&quot;;</span><br><span class="line"> switch (i) &#123;</span><br><span class="line">   case 0 :binary = &quot;0000&quot;;break;</span><br><span class="line">   case 1 :binary = &quot;0001&quot;;break;</span><br><span class="line">   case 2 :binary = &quot;0010&quot;;break;</span><br><span class="line">   case 3 :binary = &quot;0011&quot;;break;</span><br><span class="line">   case 4 :binary = &quot;0100&quot;;break;</span><br><span class="line">   case 5 :binary = &quot;0101&quot;;break;</span><br><span class="line">   case 6 :binary = &quot;0110&quot;;break;</span><br><span class="line">   case 7 :binary = &quot;0111&quot;;break;</span><br><span class="line">   case 8 :binary = &quot;1000&quot;;break;</span><br><span class="line">   case 9 :binary = &quot;1001&quot;;break;</span><br><span class="line">   case 10 :binary = &quot;1010&quot;;break;</span><br><span class="line">   case 11 :binary = &quot;1011&quot;;break;</span><br><span class="line">   case 12 :binary = &quot;1100&quot;;break;</span><br><span class="line">   case 13 :binary = &quot;1101&quot;;break;</span><br><span class="line">   case 14 :binary = &quot;1110&quot;;break;</span><br><span class="line">   case 15 :binary = &quot;1111&quot;;break;</span><br><span class="line"> &#125;</span><br><span class="line"> return binary;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">* generate 16 keys for xor</span><br><span class="line">*</span><br><span class="line">*/</span><br><span class="line">function generateKeys(keyByte)&#123;    </span><br><span class="line"> var key   = new Array(56);</span><br><span class="line"> var keys = new Array();  </span><br><span class="line"> </span><br><span class="line"> keys[ 0] = new Array();</span><br><span class="line"> keys[ 1] = new Array();</span><br><span class="line"> keys[ 2] = new Array();</span><br><span class="line"> keys[ 3] = new Array();</span><br><span class="line"> keys[ 4] = new Array();</span><br><span class="line"> keys[ 5] = new Array();</span><br><span class="line"> keys[ 6] = new Array();</span><br><span class="line"> keys[ 7] = new Array();</span><br><span class="line"> keys[ 8] = new Array();</span><br><span class="line"> keys[ 9] = new Array();</span><br><span class="line"> keys[10] = new Array();</span><br><span class="line"> keys[11] = new Array();</span><br><span class="line"> keys[12] = new Array();</span><br><span class="line"> keys[13] = new Array();</span><br><span class="line"> keys[14] = new Array();</span><br><span class="line"> keys[15] = new Array();  </span><br><span class="line"> var loop = [1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];</span><br><span class="line"></span><br><span class="line"> for(i=0;i&lt;7;i++)&#123;</span><br><span class="line">   for(j=0,k=7;j&lt;8;j++,k--)&#123;</span><br><span class="line">     key[i*8+j]=keyByte[8*k+i];</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;    </span><br><span class="line"> </span><br><span class="line"> var i = 0;</span><br><span class="line"> for(i = 0;i &lt; 16;i ++)&#123;</span><br><span class="line">   var tempLeft=0;</span><br><span class="line">   var tempRight=0;</span><br><span class="line">   for(j = 0; j &lt; loop[i];j ++)&#123;          </span><br><span class="line">     tempLeft = key[0];</span><br><span class="line">     tempRight = key[28];</span><br><span class="line">     for(k = 0;k &lt; 27 ;k ++)&#123;</span><br><span class="line">       key[k] = key[k+1];</span><br><span class="line">       key[28+k] = key[29+k];</span><br><span class="line">     &#125;  </span><br><span class="line">     key[27]=tempLeft;</span><br><span class="line">     key[55]=tempRight;</span><br><span class="line">   &#125;</span><br><span class="line">   var tempKey = new Array(48);</span><br><span class="line">   tempKey[ 0] = key[13];</span><br><span class="line">   tempKey[ 1] = key[16];</span><br><span class="line">   tempKey[ 2] = key[10];</span><br><span class="line">   tempKey[ 3] = key[23];</span><br><span class="line">   tempKey[ 4] = key[ 0];</span><br><span class="line">   tempKey[ 5] = key[ 4];</span><br><span class="line">   tempKey[ 6] = key[ 2];</span><br><span class="line">   tempKey[ 7] = key[27];</span><br><span class="line">   tempKey[ 8] = key[14];</span><br><span class="line">   tempKey[ 9] = key[ 5];</span><br><span class="line">   tempKey[10] = key[20];</span><br><span class="line">   tempKey[11] = key[ 9];</span><br><span class="line">   tempKey[12] = key[22];</span><br><span class="line">   tempKey[13] = key[18];</span><br><span class="line">   tempKey[14] = key[11];</span><br><span class="line">   tempKey[15] = key[ 3];</span><br><span class="line">   tempKey[16] = key[25];</span><br><span class="line">   tempKey[17] = key[ 7];</span><br><span class="line">   tempKey[18] = key[15];</span><br><span class="line">   tempKey[19] = key[ 6];</span><br><span class="line">   tempKey[20] = key[26];</span><br><span class="line">   tempKey[21] = key[19];</span><br><span class="line">   tempKey[22] = key[12];</span><br><span class="line">   tempKey[23] = key[ 1];</span><br><span class="line">   tempKey[24] = key[40];</span><br><span class="line">   tempKey[25] = key[51];</span><br><span class="line">   tempKey[26] = key[30];</span><br><span class="line">   tempKey[27] = key[36];</span><br><span class="line">   tempKey[28] = key[46];</span><br><span class="line">   tempKey[29] = key[54];</span><br><span class="line">   tempKey[30] = key[29];</span><br><span class="line">   tempKey[31] = key[39];</span><br><span class="line">   tempKey[32] = key[50];</span><br><span class="line">   tempKey[33] = key[44];</span><br><span class="line">   tempKey[34] = key[32];</span><br><span class="line">   tempKey[35] = key[47];</span><br><span class="line">   tempKey[36] = key[43];</span><br><span class="line">   tempKey[37] = key[48];</span><br><span class="line">   tempKey[38] = key[38];</span><br><span class="line">   tempKey[39] = key[55];</span><br><span class="line">   tempKey[40] = key[33];</span><br><span class="line">   tempKey[41] = key[52];</span><br><span class="line">   tempKey[42] = key[45];</span><br><span class="line">   tempKey[43] = key[41];</span><br><span class="line">   tempKey[44] = key[49];</span><br><span class="line">   tempKey[45] = key[35];</span><br><span class="line">   tempKey[46] = key[28];</span><br><span class="line">   tempKey[47] = key[31];</span><br><span class="line">   switch(i)&#123;</span><br><span class="line">     case 0: for(m=0;m &lt; 48 ;m++)&#123; keys[ 0][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 1: for(m=0;m &lt; 48 ;m++)&#123; keys[ 1][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 2: for(m=0;m &lt; 48 ;m++)&#123; keys[ 2][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 3: for(m=0;m &lt; 48 ;m++)&#123; keys[ 3][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 4: for(m=0;m &lt; 48 ;m++)&#123; keys[ 4][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 5: for(m=0;m &lt; 48 ;m++)&#123; keys[ 5][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 6: for(m=0;m &lt; 48 ;m++)&#123; keys[ 6][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 7: for(m=0;m &lt; 48 ;m++)&#123; keys[ 7][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 8: for(m=0;m &lt; 48 ;m++)&#123; keys[ 8][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 9: for(m=0;m &lt; 48 ;m++)&#123; keys[ 9][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 10: for(m=0;m &lt; 48 ;m++)&#123; keys[10][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 11: for(m=0;m &lt; 48 ;m++)&#123; keys[11][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 12: for(m=0;m &lt; 48 ;m++)&#123; keys[12][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 13: for(m=0;m &lt; 48 ;m++)&#123; keys[13][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 14: for(m=0;m &lt; 48 ;m++)&#123; keys[14][m] = tempKey[m]; &#125; break;</span><br><span class="line">     case 15: for(m=0;m &lt; 48 ;m++)&#123; keys[15][m] = tempKey[m]; &#125; break;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> return keys;  </span><br><span class="line">&#125;</span><br><span class="line">//end-------------------------------------------------------------------------------------------------------------</span><br><span class="line">/*</span><br><span class="line">function test() &#123;</span><br><span class="line"> </span><br><span class="line"> var msg = &quot;abcdefgh&quot;;</span><br><span class="line"> var bt = strToBt(msg);</span><br><span class="line"> </span><br><span class="line"> var key = &quot;12345678&quot;;</span><br><span class="line"> var keyB = strToBt(key);</span><br><span class="line">   </span><br><span class="line"> var encByte = enc(bt,keyB);</span><br><span class="line">     </span><br><span class="line"> var enchex  = bt64ToHex(encByte);  </span><br><span class="line"> endata.value=enchex;</span><br><span class="line"> </span><br><span class="line"> var encStr = hexToBt64(enchex);</span><br><span class="line"> alert(&quot;encStr=&quot;+encStr);</span><br><span class="line"> var eByte = new Array();</span><br><span class="line"> for(m=0;m&lt;encStr.length;m++)&#123;</span><br><span class="line">   eByte[m] = parseInt(encStr.substring(m,m+1));</span><br><span class="line"> &#125;</span><br><span class="line"> var decbyte= dec(eByte,keyB)</span><br><span class="line"> var decmsg= byteToString(decbyte);</span><br><span class="line"> alert(&quot;decbyte=&quot;+decbyte);</span><br><span class="line"> alert(&quot;decmsg=&quot;+decmsg);  </span><br><span class="line">&#125;*/</span><br></pre></td></tr></table></figure></p>
<p>DES.java(å¯¹åº”çš„Javaä»£ç ):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br></pre></td><td class="code"><pre><span class="line">package com.blog.springboot.utils;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * DESåŠ å¯†/è§£å¯†</span><br><span class="line"> * </span><br><span class="line"> * @Copyright Copyright (c) 2015</span><br><span class="line"> * @author liuyazhuang</span><br><span class="line"> * @see DESCore</span><br><span class="line"> */</span><br><span class="line">public class Des &#123;</span><br><span class="line">    public Des() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Des desObj = new Des();</span><br><span class="line">        String key1 = &quot;1&quot;;</span><br><span class="line">        String key2 = &quot;2&quot;;</span><br><span class="line">        String key3 = &quot;3&quot;;</span><br><span class="line">        String data = &quot;admin&quot;;</span><br><span class="line">        String str = desObj.strEnc(data, key1, key2, key3);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        String dec = desObj.strDec(str, key1, key2, key3);</span><br><span class="line">        System.out.println(dec);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * DESåŠ å¯†/è§£å¯†</span><br><span class="line">     * </span><br><span class="line">     * @Copyright Copyright (c) 2015</span><br><span class="line">     * @author liuyazhuang</span><br><span class="line">     * @see DESCore</span><br><span class="line">     */</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * encrypt the string to string made up of hex return the encrypted string</span><br><span class="line">     */</span><br><span class="line">    public String strEnc(String data, String firstKey, String secondKey,</span><br><span class="line">            String thirdKey) &#123;</span><br><span class="line"> </span><br><span class="line">        int leng = data.length();</span><br><span class="line">        String encData = &quot;&quot;;</span><br><span class="line">        List firstKeyBt = null, secondKeyBt = null, thirdKeyBt = null;</span><br><span class="line">        int firstLength = 0, secondLength = 0, thirdLength = 0;</span><br><span class="line">        if (firstKey != null &amp;&amp; firstKey != &quot;&quot;) &#123;</span><br><span class="line">            firstKeyBt = getKeyBytes(firstKey);</span><br><span class="line">            firstLength = firstKeyBt.size();</span><br><span class="line">        &#125;</span><br><span class="line">        if (secondKey != null &amp;&amp; secondKey != &quot;&quot;) &#123;</span><br><span class="line">            secondKeyBt = getKeyBytes(secondKey);</span><br><span class="line">            secondLength = secondKeyBt.size();</span><br><span class="line">        &#125;</span><br><span class="line">        if (thirdKey != null &amp;&amp; thirdKey != &quot;&quot;) &#123;</span><br><span class="line">            thirdKeyBt = getKeyBytes(thirdKey);</span><br><span class="line">            thirdLength = thirdKeyBt.size();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        if (leng &gt; 0) &#123;</span><br><span class="line">            if (leng &lt; 4) &#123;</span><br><span class="line">                int[] bt = strToBt(data);</span><br><span class="line">                int[] encByte = null;</span><br><span class="line">                if (firstKey != null &amp;&amp; firstKey != &quot;&quot; &amp;&amp; secondKey != null</span><br><span class="line">                        &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null</span><br><span class="line">                        &amp;&amp; thirdKey != &quot;&quot;) &#123;</span><br><span class="line">                    int[] tempBt;</span><br><span class="line">                    int x, y, z;</span><br><span class="line">                    tempBt = bt;</span><br><span class="line">                    for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                        tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                    &#125;</span><br><span class="line">                    for (y = 0; y &lt; secondLength; y++) &#123;</span><br><span class="line">                        tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                    &#125;</span><br><span class="line">                    for (z = 0; z &lt; thirdLength; z++) &#123;</span><br><span class="line">                        tempBt = enc(tempBt, (int[]) thirdKeyBt.get(z));</span><br><span class="line">                    &#125;</span><br><span class="line">                    encByte = tempBt;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    if (firstKey != null &amp;&amp; firstKey != &quot;&quot; &amp;&amp; secondKey != null</span><br><span class="line">                            &amp;&amp; secondKey != &quot;&quot;) &#123;</span><br><span class="line">                        int[] tempBt;</span><br><span class="line">                        int x, y;</span><br><span class="line">                        tempBt = bt;</span><br><span class="line">                        for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                        &#125;</span><br><span class="line">                        for (y = 0; y &lt; secondLength; y++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                        &#125;</span><br><span class="line">                        encByte = tempBt;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        if (firstKey != null &amp;&amp; firstKey != &quot;&quot;) &#123;</span><br><span class="line">                            int[] tempBt;</span><br><span class="line">                            int x = 0;</span><br><span class="line">                            tempBt = bt;</span><br><span class="line">                            for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                                tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                            &#125;</span><br><span class="line">                            encByte = tempBt;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                encData = bt64ToHex(encByte);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                int iterator = (leng / 4);</span><br><span class="line">                int remainder = leng % 4;</span><br><span class="line">                int i = 0;</span><br><span class="line">                for (i = 0; i &lt; iterator; i++) &#123;</span><br><span class="line">                    String tempData = data.substring(i * 4 + 0, i * 4 + 4);</span><br><span class="line">                    int[] tempByte = strToBt(tempData);</span><br><span class="line">                    int[] encByte = null;</span><br><span class="line">                    if (firstKey != null &amp;&amp; firstKey != &quot;&quot; &amp;&amp; secondKey != null</span><br><span class="line">                            &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null</span><br><span class="line">                            &amp;&amp; thirdKey != &quot;&quot;) &#123;</span><br><span class="line">                        int[] tempBt;</span><br><span class="line">                        int x, y, z;</span><br><span class="line">                        tempBt = tempByte;</span><br><span class="line">                        for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                        &#125;</span><br><span class="line">                        for (y = 0; y &lt; secondLength; y++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                        &#125;</span><br><span class="line">                        for (z = 0; z &lt; thirdLength; z++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) thirdKeyBt.get(z));</span><br><span class="line">                        &#125;</span><br><span class="line">                        encByte = tempBt;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        if (firstKey != null &amp;&amp; firstKey != &quot;&quot;</span><br><span class="line">                                &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot;) &#123;</span><br><span class="line">                            int[] tempBt;</span><br><span class="line">                            int x, y;</span><br><span class="line">                            tempBt = tempByte;</span><br><span class="line">                            for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                                tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                            &#125;</span><br><span class="line">                            for (y = 0; y &lt; secondLength; y++) &#123;</span><br><span class="line">                                tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                            &#125;</span><br><span class="line">                            encByte = tempBt;</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            if (firstKey != null &amp;&amp; firstKey != &quot;&quot;) &#123;</span><br><span class="line">                                int[] tempBt;</span><br><span class="line">                                int x;</span><br><span class="line">                                tempBt = tempByte;</span><br><span class="line">                                for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                                    tempBt = enc(tempBt, (int[]) firstKeyBt</span><br><span class="line">                                            .get(x));</span><br><span class="line">                                &#125;</span><br><span class="line">                                encByte = tempBt;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    encData += bt64ToHex(encByte);</span><br><span class="line">                &#125;</span><br><span class="line">                if (remainder &gt; 0) &#123;</span><br><span class="line">                    String remainderData = data.substring(iterator * 4 + 0,</span><br><span class="line">                            leng);</span><br><span class="line">                    int[] tempByte = strToBt(remainderData);</span><br><span class="line">                    int[] encByte = null;</span><br><span class="line">                    if (firstKey != null &amp;&amp; firstKey != &quot;&quot; &amp;&amp; secondKey != null</span><br><span class="line">                            &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null</span><br><span class="line">                            &amp;&amp; thirdKey != &quot;&quot;) &#123;</span><br><span class="line">                        int[] tempBt;</span><br><span class="line">                        int x, y, z;</span><br><span class="line">                        tempBt = tempByte;</span><br><span class="line">                        for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                        &#125;</span><br><span class="line">                        for (y = 0; y &lt; secondLength; y++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                        &#125;</span><br><span class="line">                        for (z = 0; z &lt; thirdLength; z++) &#123;</span><br><span class="line">                            tempBt = enc(tempBt, (int[]) thirdKeyBt.get(z));</span><br><span class="line">                        &#125;</span><br><span class="line">                        encByte = tempBt;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        if (firstKey != null &amp;&amp; firstKey != &quot;&quot;</span><br><span class="line">                                &amp;&amp; secondKey != null &amp;&amp; secondKey != &quot;&quot;) &#123;</span><br><span class="line">                            int[] tempBt;</span><br><span class="line">                            int x, y;</span><br><span class="line">                            tempBt = tempByte;</span><br><span class="line">                            for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                                tempBt = enc(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                            &#125;</span><br><span class="line">                            for (y = 0; y &lt; secondLength; y++) &#123;</span><br><span class="line">                                tempBt = enc(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                            &#125;</span><br><span class="line">                            encByte = tempBt;</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            if (firstKey != null &amp;&amp; firstKey != &quot;&quot;) &#123;</span><br><span class="line">                                int[] tempBt;</span><br><span class="line">                                int x;</span><br><span class="line">                                tempBt = tempByte;</span><br><span class="line">                                for (x = 0; x &lt; firstLength; x++) &#123;</span><br><span class="line">                                    tempBt = enc(tempBt, (int[]) firstKeyBt</span><br><span class="line">                                            .get(x));</span><br><span class="line">                                &#125;</span><br><span class="line">                                encByte = tempBt;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    encData += bt64ToHex(encByte);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return encData;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * decrypt the encrypted string to the original string</span><br><span class="line">     * return the original string</span><br><span class="line">     */</span><br><span class="line">    public String strDec(String data, String firstKey, String secondKey,</span><br><span class="line">            String thirdKey) &#123;</span><br><span class="line">        int leng = data.length();</span><br><span class="line">        String decStr = &quot;&quot;;</span><br><span class="line">        List firstKeyBt = null, secondKeyBt = null, thirdKeyBt = null;</span><br><span class="line">        int firstLength = 0, secondLength = 0, thirdLength = 0;</span><br><span class="line">        if (firstKey != null &amp;&amp; firstKey != &quot;&quot;) &#123;</span><br><span class="line">            firstKeyBt = getKeyBytes(firstKey);</span><br><span class="line">            firstLength = firstKeyBt.size();</span><br><span class="line">        &#125;</span><br><span class="line">        if (secondKey != null &amp;&amp; secondKey != &quot;&quot;) &#123;</span><br><span class="line">            secondKeyBt = getKeyBytes(secondKey);</span><br><span class="line">            secondLength = secondKeyBt.size();</span><br><span class="line">        &#125;</span><br><span class="line">        if (thirdKey != null &amp;&amp; thirdKey != &quot;&quot;) &#123;</span><br><span class="line">            thirdKeyBt = getKeyBytes(thirdKey);</span><br><span class="line">            thirdLength = thirdKeyBt.size();</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        int iterator = leng / 16;</span><br><span class="line">        int i = 0;</span><br><span class="line">        for (i = 0; i &lt; iterator; i++) &#123;</span><br><span class="line">            String tempData = data.substring(i * 16 + 0, i * 16 + 16);</span><br><span class="line">            String strByte = hexToBt64(tempData);</span><br><span class="line">            int[] intByte = new int[64];</span><br><span class="line">            int j = 0;</span><br><span class="line">            for (j = 0; j &lt; 64; j++) &#123;</span><br><span class="line">                intByte[j] = Integer.parseInt(strByte.substring(j, j + 1));</span><br><span class="line">            &#125;</span><br><span class="line">            int[] decByte = null;</span><br><span class="line">            if (firstKey != null &amp;&amp; firstKey != &quot;&quot; &amp;&amp; secondKey != null</span><br><span class="line">                    &amp;&amp; secondKey != &quot;&quot; &amp;&amp; thirdKey != null &amp;&amp; thirdKey != &quot;&quot;) &#123;</span><br><span class="line">                int[] tempBt;</span><br><span class="line">                int x, y, z;</span><br><span class="line">                tempBt = intByte;</span><br><span class="line">                for (x = thirdLength - 1; x &gt;= 0; x--) &#123;</span><br><span class="line">                    tempBt = dec(tempBt, (int[]) thirdKeyBt.get(x));</span><br><span class="line">                &#125;</span><br><span class="line">                for (y = secondLength - 1; y &gt;= 0; y--) &#123;</span><br><span class="line">                    tempBt = dec(tempBt, (int[]) secondKeyBt.get(y));</span><br><span class="line">                &#125;</span><br><span class="line">                for (z = firstLength - 1; z &gt;= 0; z--) &#123;</span><br><span class="line">                    tempBt = dec(tempBt, (int[]) firstKeyBt.get(z));</span><br><span class="line">                &#125;</span><br><span class="line">                decByte = tempBt;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                if (firstKey != null &amp;&amp; firstKey != &quot;&quot; &amp;&amp; secondKey != null</span><br><span class="line">                        &amp;&amp; secondKey != &quot;&quot;) &#123;</span><br><span class="line">                    int[] tempBt;</span><br><span class="line">                    int x, y, z;</span><br><span class="line">                    tempBt = intByte;</span><br><span class="line">                    for (x = secondLength - 1; x &gt;= 0; x--) &#123;</span><br><span class="line">                        tempBt = dec(tempBt, (int[]) secondKeyBt.get(x));</span><br><span class="line">                    &#125;</span><br><span class="line">                    for (y = firstLength - 1; y &gt;= 0; y--) &#123;</span><br><span class="line">                        tempBt = dec(tempBt, (int[]) firstKeyBt.get(y));</span><br><span class="line">                    &#125;</span><br><span class="line">                    decByte = tempBt;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    if (firstKey != null &amp;&amp; firstKey != &quot;&quot;) &#123;</span><br><span class="line">                        int[] tempBt;</span><br><span class="line">                        int x, y, z;</span><br><span class="line">                        tempBt = intByte;</span><br><span class="line">                        for (x = firstLength - 1; x &gt;= 0; x--) &#123;</span><br><span class="line">                            tempBt = dec(tempBt, (int[]) firstKeyBt.get(x));</span><br><span class="line">                        &#125;</span><br><span class="line">                        decByte = tempBt;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            decStr += byteToString(decByte);</span><br><span class="line">        &#125;</span><br><span class="line">        return decStr;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * chang the string into the bit array</span><br><span class="line">     * </span><br><span class="line">     * return bit array(it&apos;s length % 64 = 0)</span><br><span class="line">     */</span><br><span class="line">    public List getKeyBytes(String key) &#123;</span><br><span class="line">        List keyBytes = new ArrayList();</span><br><span class="line">        int leng = key.length();</span><br><span class="line">        int iterator = (leng / 4);</span><br><span class="line">        int remainder = leng % 4;</span><br><span class="line">        int i = 0;</span><br><span class="line">        for (i = 0; i &lt; iterator; i++) &#123;</span><br><span class="line">            keyBytes.add(i, strToBt(key.substring(i * 4 + 0, i * 4 + 4)));</span><br><span class="line">        &#125;</span><br><span class="line">        if (remainder &gt; 0) &#123;</span><br><span class="line">            // keyBytes[i] = strToBt(key.substring(i*4+0,leng));</span><br><span class="line">            keyBytes.add(i, strToBt(key.substring(i * 4 + 0, leng)));</span><br><span class="line">        &#125;</span><br><span class="line">        return keyBytes;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * chang the string(it&apos;s length &lt;= 4) into the bit array</span><br><span class="line">     * </span><br><span class="line">     * return bit array(it&apos;s length = 64)</span><br><span class="line">     */</span><br><span class="line">    public int[] strToBt(String str) &#123;</span><br><span class="line">        int leng = str.length();</span><br><span class="line">        int[] bt = new int[64];</span><br><span class="line">        if (leng &lt; 4) &#123;</span><br><span class="line">            int i = 0, j = 0, p = 0, q = 0;</span><br><span class="line">            for (i = 0; i &lt; leng; i++) &#123;</span><br><span class="line">                int k = str.charAt(i);</span><br><span class="line">                for (j = 0; j &lt; 16; j++) &#123;</span><br><span class="line">                    int pow = 1, m = 0;</span><br><span class="line">                    for (m = 15; m &gt; j; m--) &#123;</span><br><span class="line">                        pow *= 2;</span><br><span class="line">                    &#125;</span><br><span class="line">                    // bt.set(16*i+j,&quot;&quot;+(k/pow)%2));</span><br><span class="line">                    bt[16 * i + j] = (k / pow) % 2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            for (p = leng; p &lt; 4; p++) &#123;</span><br><span class="line">                int k = 0;</span><br><span class="line">                for (q = 0; q &lt; 16; q++) &#123;</span><br><span class="line">                    int pow = 1, m = 0;</span><br><span class="line">                    for (m = 15; m &gt; q; m--) &#123;</span><br><span class="line">                        pow *= 2;</span><br><span class="line">                    &#125;</span><br><span class="line">                    // bt[16*p+q]=parseInt(k/pow)%2;</span><br><span class="line">                    // bt.add(16*p+q,&quot;&quot;+((k/pow)%2));</span><br><span class="line">                    bt[16 * p + q] = (k / pow) % 2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            for (int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">                int k = str.charAt(i);</span><br><span class="line">                for (int j = 0; j &lt; 16; j++) &#123;</span><br><span class="line">                    int pow = 1;</span><br><span class="line">                    for (int m = 15; m &gt; j; m--) &#123;</span><br><span class="line">                        pow *= 2;</span><br><span class="line">                    &#125;</span><br><span class="line">                    // bt[16*i+j]=parseInt(k/pow)%2;</span><br><span class="line">                    // bt.add(16*i+j,&quot;&quot;+((k/pow)%2));</span><br><span class="line">                    bt[16 * i + j] = (k / pow) % 2;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return bt;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * chang the bit(it&apos;s length = 4) into the hex</span><br><span class="line">     * </span><br><span class="line">     * return hex</span><br><span class="line">     */</span><br><span class="line">    public String bt4ToHex(String binary) &#123;</span><br><span class="line">        String hex = &quot;&quot;;</span><br><span class="line">        if (binary.equalsIgnoreCase(&quot;0000&quot;)) &#123;</span><br><span class="line">            hex = &quot;0&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0001&quot;)) &#123;</span><br><span class="line">            hex = &quot;1&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0010&quot;)) &#123;</span><br><span class="line">            hex = &quot;2&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0011&quot;)) &#123;</span><br><span class="line">            hex = &quot;3&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0100&quot;)) &#123;</span><br><span class="line">            hex = &quot;4&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0101&quot;)) &#123;</span><br><span class="line">            hex = &quot;5&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0110&quot;)) &#123;</span><br><span class="line">            hex = &quot;6&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;0111&quot;)) &#123;</span><br><span class="line">            hex = &quot;7&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1000&quot;)) &#123;</span><br><span class="line">            hex = &quot;8&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1001&quot;)) &#123;</span><br><span class="line">            hex = &quot;9&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1010&quot;)) &#123;</span><br><span class="line">            hex = &quot;A&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1011&quot;)) &#123;</span><br><span class="line">            hex = &quot;B&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1100&quot;)) &#123;</span><br><span class="line">            hex = &quot;C&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1101&quot;)) &#123;</span><br><span class="line">            hex = &quot;D&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1110&quot;)) &#123;</span><br><span class="line">            hex = &quot;E&quot;;</span><br><span class="line">        &#125; else if (binary.equalsIgnoreCase(&quot;1111&quot;)) &#123;</span><br><span class="line">            hex = &quot;F&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        return hex;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * chang the hex into the bit(it&apos;s length = 4)</span><br><span class="line">     * </span><br><span class="line">     * return the bit(it&apos;s length = 4)</span><br><span class="line">     */</span><br><span class="line">    public String hexToBt4(String hex) &#123;</span><br><span class="line">        String binary = &quot;&quot;;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;0&quot;)) &#123;</span><br><span class="line">            binary = &quot;0000&quot;;</span><br><span class="line">        &#125; else if (hex.equalsIgnoreCase(&quot;1&quot;)) &#123;</span><br><span class="line">            binary = &quot;0001&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;2&quot;)) &#123;</span><br><span class="line">            binary = &quot;0010&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;3&quot;)) &#123;</span><br><span class="line">            binary = &quot;0011&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;4&quot;)) &#123;</span><br><span class="line">            binary = &quot;0100&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;5&quot;)) &#123;</span><br><span class="line">            binary = &quot;0101&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;6&quot;)) &#123;</span><br><span class="line">            binary = &quot;0110&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;7&quot;)) &#123;</span><br><span class="line">            binary = &quot;0111&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;8&quot;)) &#123;</span><br><span class="line">            binary = &quot;1000&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;9&quot;)) &#123;</span><br><span class="line">            binary = &quot;1001&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;A&quot;)) &#123;</span><br><span class="line">            binary = &quot;1010&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;B&quot;)) &#123;</span><br><span class="line">            binary = &quot;1011&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;C&quot;)) &#123;</span><br><span class="line">            binary = &quot;1100&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;D&quot;)) &#123;</span><br><span class="line">            binary = &quot;1101&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;E&quot;)) &#123;</span><br><span class="line">            binary = &quot;1110&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        if (hex.equalsIgnoreCase(&quot;F&quot;)) &#123;</span><br><span class="line">            binary = &quot;1111&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return binary;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * chang the bit(it&apos;s length = 64) into the string</span><br><span class="line">     * </span><br><span class="line">     * return string</span><br><span class="line">     */</span><br><span class="line">    public String byteToString(int[] byteData) &#123;</span><br><span class="line">        String str = &quot;&quot;;</span><br><span class="line">        for (int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">            int count = 0;</span><br><span class="line">            for (int j = 0; j &lt; 16; j++) &#123;</span><br><span class="line">                int pow = 1;</span><br><span class="line">                for (int m = 15; m &gt; j; m--) &#123;</span><br><span class="line">                    pow *= 2;</span><br><span class="line">                &#125;</span><br><span class="line">                count += byteData[16 * i + j] * pow;</span><br><span class="line">            &#125;</span><br><span class="line">            if (count != 0) &#123;</span><br><span class="line">                str += &quot;&quot; + (char) (count);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return str;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public String bt64ToHex(int[] byteData) &#123;</span><br><span class="line">        String hex = &quot;&quot;;</span><br><span class="line">        for (int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            String bt = &quot;&quot;;</span><br><span class="line">            for (int j = 0; j &lt; 4; j++) &#123;</span><br><span class="line">                bt += byteData[i * 4 + j];</span><br><span class="line">            &#125;</span><br><span class="line">            hex += bt4ToHex(bt);</span><br><span class="line">        &#125;</span><br><span class="line">        return hex;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public String hexToBt64(String hex) &#123;</span><br><span class="line">        String binary = &quot;&quot;;</span><br><span class="line">        for (int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            binary += hexToBt4(hex.substring(i, i + 1));</span><br><span class="line">        &#125;</span><br><span class="line">        return binary;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * the 64 bit des core arithmetic</span><br><span class="line">     */</span><br><span class="line"> </span><br><span class="line">    public int[] enc(int[] dataByte, int[] keyByte) &#123;</span><br><span class="line">        int[][] keys = generateKeys(keyByte);</span><br><span class="line">        int[] ipByte = initPermute(dataByte);</span><br><span class="line">        int[] ipLeft = new int[32];</span><br><span class="line">        int[] ipRight = new int[32];</span><br><span class="line">        int[] tempLeft = new int[32];</span><br><span class="line">        int i = 0, j = 0, k = 0, m = 0, n = 0;</span><br><span class="line">        for (k = 0; k &lt; 32; k++) &#123;</span><br><span class="line">            ipLeft[k] = ipByte[k];</span><br><span class="line">            ipRight[k] = ipByte[32 + k];</span><br><span class="line">        &#125;</span><br><span class="line">        for (i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            for (j = 0; j &lt; 32; j++) &#123;</span><br><span class="line">                tempLeft[j] = ipLeft[j];</span><br><span class="line">                ipLeft[j] = ipRight[j];</span><br><span class="line">            &#125;</span><br><span class="line">            int[] key = new int[48];</span><br><span class="line">            for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                key[m] = keys[i][m];</span><br><span class="line">            &#125;</span><br><span class="line">            int[] tempRight = xor(pPermute(sBoxPermute(xor(</span><br><span class="line">                    expandPermute(ipRight), key))), tempLeft);</span><br><span class="line">            for (n = 0; n &lt; 32; n++) &#123;</span><br><span class="line">                ipRight[n] = tempRight[n];</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        int[] finalData = new int[64];</span><br><span class="line">        for (i = 0; i &lt; 32; i++) &#123;</span><br><span class="line">            finalData[i] = ipRight[i];</span><br><span class="line">            finalData[32 + i] = ipLeft[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return finallyPermute(finalData);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] dec(int[] dataByte, int[] keyByte) &#123;</span><br><span class="line">        int[][] keys = generateKeys(keyByte);</span><br><span class="line">        int[] ipByte = initPermute(dataByte);</span><br><span class="line">        int[] ipLeft = new int[32];</span><br><span class="line">        int[] ipRight = new int[32];</span><br><span class="line">        int[] tempLeft = new int[32];</span><br><span class="line">        int i = 0, j = 0, k = 0, m = 0, n = 0;</span><br><span class="line">        for (k = 0; k &lt; 32; k++) &#123;</span><br><span class="line">            ipLeft[k] = ipByte[k];</span><br><span class="line">            ipRight[k] = ipByte[32 + k];</span><br><span class="line">        &#125;</span><br><span class="line">        for (i = 15; i &gt;= 0; i--) &#123;</span><br><span class="line">            for (j = 0; j &lt; 32; j++) &#123;</span><br><span class="line">                tempLeft[j] = ipLeft[j];</span><br><span class="line">                ipLeft[j] = ipRight[j];</span><br><span class="line">            &#125;</span><br><span class="line">            int[] key = new int[48];</span><br><span class="line">            for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                key[m] = keys[i][m];</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            int[] tempRight = xor(pPermute(sBoxPermute(xor(</span><br><span class="line">                    expandPermute(ipRight), key))), tempLeft);</span><br><span class="line">            for (n = 0; n &lt; 32; n++) &#123;</span><br><span class="line">                ipRight[n] = tempRight[n];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        int[] finalData = new int[64];</span><br><span class="line">        for (i = 0; i &lt; 32; i++) &#123;</span><br><span class="line">            finalData[i] = ipRight[i];</span><br><span class="line">            finalData[32 + i] = ipLeft[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return finallyPermute(finalData);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] initPermute(int[] originalData) &#123;</span><br><span class="line">        int[] ipByte = new int[64];</span><br><span class="line">        int i = 0, m = 1, n = 0, j, k;</span><br><span class="line">        for (i = 0, m = 1, n = 0; i &lt; 4; i++, m += 2, n += 2) &#123;</span><br><span class="line">            for (j = 7, k = 0; j &gt;= 0; j--, k++) &#123;</span><br><span class="line">                ipByte[i * 8 + k] = originalData[j * 8 + m];</span><br><span class="line">                ipByte[i * 8 + k + 32] = originalData[j * 8 + n];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return ipByte;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] expandPermute(int[] rightData) &#123;</span><br><span class="line">        int[] epByte = new int[48];</span><br><span class="line">        int i, j;</span><br><span class="line">        for (i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">            if (i == 0) &#123;</span><br><span class="line">                epByte[i * 6 + 0] = rightData[31];</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                epByte[i * 6 + 0] = rightData[i * 4 - 1];</span><br><span class="line">            &#125;</span><br><span class="line">            epByte[i * 6 + 1] = rightData[i * 4 + 0];</span><br><span class="line">            epByte[i * 6 + 2] = rightData[i * 4 + 1];</span><br><span class="line">            epByte[i * 6 + 3] = rightData[i * 4 + 2];</span><br><span class="line">            epByte[i * 6 + 4] = rightData[i * 4 + 3];</span><br><span class="line">            if (i == 7) &#123;</span><br><span class="line">                epByte[i * 6 + 5] = rightData[0];</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                epByte[i * 6 + 5] = rightData[i * 4 + 4];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return epByte;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] xor(int[] byteOne, int[] byteTwo) &#123;</span><br><span class="line">        // var xorByte = new Array(byteOne.length);</span><br><span class="line">        // for(int i = 0;i &lt; byteOne.length; i ++)&#123;</span><br><span class="line">        // xorByte[i] = byteOne[i] ^ byteTwo[i];</span><br><span class="line">        // &#125;</span><br><span class="line">        // return xorByte;</span><br><span class="line">        int[] xorByte = new int[byteOne.length];</span><br><span class="line">        for (int i = 0; i &lt; byteOne.length; i++) &#123;</span><br><span class="line">            xorByte[i] = byteOne[i] ^ byteTwo[i];</span><br><span class="line">        &#125;</span><br><span class="line">        return xorByte;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] sBoxPermute(int[] expandByte) &#123;</span><br><span class="line"> </span><br><span class="line">        // var sBoxByte = new Array(32);</span><br><span class="line">        int[] sBoxByte = new int[32];</span><br><span class="line">        String binary = &quot;&quot;;</span><br><span class="line">        int[][] s1 = &#123;</span><br><span class="line">                &#123; 14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7 &#125;,</span><br><span class="line">                &#123; 0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8 &#125;,</span><br><span class="line">                &#123; 4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0 &#125;,</span><br><span class="line">                &#123; 15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        /* Table - s2 */</span><br><span class="line">        int[][] s2 = &#123;</span><br><span class="line">                &#123; 15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10 &#125;,</span><br><span class="line">                &#123; 3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5 &#125;,</span><br><span class="line">                &#123; 0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15 &#125;,</span><br><span class="line">                &#123; 13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        /* Table - s3 */</span><br><span class="line">        int[][] s3 = &#123;</span><br><span class="line">                &#123; 10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8 &#125;,</span><br><span class="line">                &#123; 13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1 &#125;,</span><br><span class="line">                &#123; 13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7 &#125;,</span><br><span class="line">                &#123; 1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12 &#125; &#125;;</span><br><span class="line">        /* Table - s4 */</span><br><span class="line">        int[][] s4 = &#123;</span><br><span class="line">                &#123; 7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15 &#125;,</span><br><span class="line">                &#123; 13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14, 9 &#125;,</span><br><span class="line">                &#123; 10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4 &#125;,</span><br><span class="line">                &#123; 3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        /* Table - s5 */</span><br><span class="line">        int[][] s5 = &#123;</span><br><span class="line">                &#123; 2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9 &#125;,</span><br><span class="line">                &#123; 14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6 &#125;,</span><br><span class="line">                &#123; 4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14 &#125;,</span><br><span class="line">                &#123; 11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        /* Table - s6 */</span><br><span class="line">        int[][] s6 = &#123;</span><br><span class="line">                &#123; 12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11 &#125;,</span><br><span class="line">                &#123; 10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8 &#125;,</span><br><span class="line">                &#123; 9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6 &#125;,</span><br><span class="line">                &#123; 4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        /* Table - s7 */</span><br><span class="line">        int[][] s7 = &#123;</span><br><span class="line">                &#123; 4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1 &#125;,</span><br><span class="line">                &#123; 13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6 &#125;,</span><br><span class="line">                &#123; 1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2 &#125;,</span><br><span class="line">                &#123; 6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        /* Table - s8 */</span><br><span class="line">        int[][] s8 = &#123;</span><br><span class="line">                &#123; 13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7 &#125;,</span><br><span class="line">                &#123; 1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2 &#125;,</span><br><span class="line">                &#123; 7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8 &#125;,</span><br><span class="line">                &#123; 2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11 &#125; &#125;;</span><br><span class="line"> </span><br><span class="line">        for (int m = 0; m &lt; 8; m++) &#123;</span><br><span class="line">            int i = 0, j = 0;</span><br><span class="line">            i = expandByte[m * 6 + 0] * 2 + expandByte[m * 6 + 5];</span><br><span class="line">            j = expandByte[m * 6 + 1] * 2 * 2 * 2 + expandByte[m * 6 + 2] * 2</span><br><span class="line">                    * 2 + expandByte[m * 6 + 3] * 2 + expandByte[m * 6 + 4];</span><br><span class="line">            switch (m) &#123;</span><br><span class="line">            case 0:</span><br><span class="line">                binary = getBoxBinary(s1[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 1:</span><br><span class="line">                binary = getBoxBinary(s2[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 2:</span><br><span class="line">                binary = getBoxBinary(s3[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 3:</span><br><span class="line">                binary = getBoxBinary(s4[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 4:</span><br><span class="line">                binary = getBoxBinary(s5[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 5:</span><br><span class="line">                binary = getBoxBinary(s6[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 6:</span><br><span class="line">                binary = getBoxBinary(s7[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            case 7:</span><br><span class="line">                binary = getBoxBinary(s8[i][j]);</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            sBoxByte[m * 4 + 0] = Integer.parseInt(binary.substring(0, 1));</span><br><span class="line">            sBoxByte[m * 4 + 1] = Integer.parseInt(binary.substring(1, 2));</span><br><span class="line">            sBoxByte[m * 4 + 2] = Integer.parseInt(binary.substring(2, 3));</span><br><span class="line">            sBoxByte[m * 4 + 3] = Integer.parseInt(binary.substring(3, 4));</span><br><span class="line">        &#125;</span><br><span class="line">        return sBoxByte;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] pPermute(int[] sBoxByte) &#123;</span><br><span class="line">        int[] pBoxPermute = new int[32];</span><br><span class="line">        pBoxPermute[0] = sBoxByte[15];</span><br><span class="line">        pBoxPermute[1] = sBoxByte[6];</span><br><span class="line">        pBoxPermute[2] = sBoxByte[19];</span><br><span class="line">        pBoxPermute[3] = sBoxByte[20];</span><br><span class="line">        pBoxPermute[4] = sBoxByte[28];</span><br><span class="line">        pBoxPermute[5] = sBoxByte[11];</span><br><span class="line">        pBoxPermute[6] = sBoxByte[27];</span><br><span class="line">        pBoxPermute[7] = sBoxByte[16];</span><br><span class="line">        pBoxPermute[8] = sBoxByte[0];</span><br><span class="line">        pBoxPermute[9] = sBoxByte[14];</span><br><span class="line">        pBoxPermute[10] = sBoxByte[22];</span><br><span class="line">        pBoxPermute[11] = sBoxByte[25];</span><br><span class="line">        pBoxPermute[12] = sBoxByte[4];</span><br><span class="line">        pBoxPermute[13] = sBoxByte[17];</span><br><span class="line">        pBoxPermute[14] = sBoxByte[30];</span><br><span class="line">        pBoxPermute[15] = sBoxByte[9];</span><br><span class="line">        pBoxPermute[16] = sBoxByte[1];</span><br><span class="line">        pBoxPermute[17] = sBoxByte[7];</span><br><span class="line">        pBoxPermute[18] = sBoxByte[23];</span><br><span class="line">        pBoxPermute[19] = sBoxByte[13];</span><br><span class="line">        pBoxPermute[20] = sBoxByte[31];</span><br><span class="line">        pBoxPermute[21] = sBoxByte[26];</span><br><span class="line">        pBoxPermute[22] = sBoxByte[2];</span><br><span class="line">        pBoxPermute[23] = sBoxByte[8];</span><br><span class="line">        pBoxPermute[24] = sBoxByte[18];</span><br><span class="line">        pBoxPermute[25] = sBoxByte[12];</span><br><span class="line">        pBoxPermute[26] = sBoxByte[29];</span><br><span class="line">        pBoxPermute[27] = sBoxByte[5];</span><br><span class="line">        pBoxPermute[28] = sBoxByte[21];</span><br><span class="line">        pBoxPermute[29] = sBoxByte[10];</span><br><span class="line">        pBoxPermute[30] = sBoxByte[3];</span><br><span class="line">        pBoxPermute[31] = sBoxByte[24];</span><br><span class="line">        return pBoxPermute;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public int[] finallyPermute(int[] endByte) &#123;</span><br><span class="line">        int[] fpByte = new int[64];</span><br><span class="line">        fpByte[0] = endByte[39];</span><br><span class="line">        fpByte[1] = endByte[7];</span><br><span class="line">        fpByte[2] = endByte[47];</span><br><span class="line">        fpByte[3] = endByte[15];</span><br><span class="line">        fpByte[4] = endByte[55];</span><br><span class="line">        fpByte[5] = endByte[23];</span><br><span class="line">        fpByte[6] = endByte[63];</span><br><span class="line">        fpByte[7] = endByte[31];</span><br><span class="line">        fpByte[8] = endByte[38];</span><br><span class="line">        fpByte[9] = endByte[6];</span><br><span class="line">        fpByte[10] = endByte[46];</span><br><span class="line">        fpByte[11] = endByte[14];</span><br><span class="line">        fpByte[12] = endByte[54];</span><br><span class="line">        fpByte[13] = endByte[22];</span><br><span class="line">        fpByte[14] = endByte[62];</span><br><span class="line">        fpByte[15] = endByte[30];</span><br><span class="line">        fpByte[16] = endByte[37];</span><br><span class="line">        fpByte[17] = endByte[5];</span><br><span class="line">        fpByte[18] = endByte[45];</span><br><span class="line">        fpByte[19] = endByte[13];</span><br><span class="line">        fpByte[20] = endByte[53];</span><br><span class="line">        fpByte[21] = endByte[21];</span><br><span class="line">        fpByte[22] = endByte[61];</span><br><span class="line">        fpByte[23] = endByte[29];</span><br><span class="line">        fpByte[24] = endByte[36];</span><br><span class="line">        fpByte[25] = endByte[4];</span><br><span class="line">        fpByte[26] = endByte[44];</span><br><span class="line">        fpByte[27] = endByte[12];</span><br><span class="line">        fpByte[28] = endByte[52];</span><br><span class="line">        fpByte[29] = endByte[20];</span><br><span class="line">        fpByte[30] = endByte[60];</span><br><span class="line">        fpByte[31] = endByte[28];</span><br><span class="line">        fpByte[32] = endByte[35];</span><br><span class="line">        fpByte[33] = endByte[3];</span><br><span class="line">        fpByte[34] = endByte[43];</span><br><span class="line">        fpByte[35] = endByte[11];</span><br><span class="line">        fpByte[36] = endByte[51];</span><br><span class="line">        fpByte[37] = endByte[19];</span><br><span class="line">        fpByte[38] = endByte[59];</span><br><span class="line">        fpByte[39] = endByte[27];</span><br><span class="line">        fpByte[40] = endByte[34];</span><br><span class="line">        fpByte[41] = endByte[2];</span><br><span class="line">        fpByte[42] = endByte[42];</span><br><span class="line">        fpByte[43] = endByte[10];</span><br><span class="line">        fpByte[44] = endByte[50];</span><br><span class="line">        fpByte[45] = endByte[18];</span><br><span class="line">        fpByte[46] = endByte[58];</span><br><span class="line">        fpByte[47] = endByte[26];</span><br><span class="line">        fpByte[48] = endByte[33];</span><br><span class="line">        fpByte[49] = endByte[1];</span><br><span class="line">        fpByte[50] = endByte[41];</span><br><span class="line">        fpByte[51] = endByte[9];</span><br><span class="line">        fpByte[52] = endByte[49];</span><br><span class="line">        fpByte[53] = endByte[17];</span><br><span class="line">        fpByte[54] = endByte[57];</span><br><span class="line">        fpByte[55] = endByte[25];</span><br><span class="line">        fpByte[56] = endByte[32];</span><br><span class="line">        fpByte[57] = endByte[0];</span><br><span class="line">        fpByte[58] = endByte[40];</span><br><span class="line">        fpByte[59] = endByte[8];</span><br><span class="line">        fpByte[60] = endByte[48];</span><br><span class="line">        fpByte[61] = endByte[16];</span><br><span class="line">        fpByte[62] = endByte[56];</span><br><span class="line">        fpByte[63] = endByte[24];</span><br><span class="line">        return fpByte;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public String getBoxBinary(int i) &#123;</span><br><span class="line">        String binary = &quot;&quot;;</span><br><span class="line">        switch (i) &#123;</span><br><span class="line">        case 0:</span><br><span class="line">            binary = &quot;0000&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 1:</span><br><span class="line">            binary = &quot;0001&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 2:</span><br><span class="line">            binary = &quot;0010&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 3:</span><br><span class="line">            binary = &quot;0011&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 4:</span><br><span class="line">            binary = &quot;0100&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 5:</span><br><span class="line">            binary = &quot;0101&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 6:</span><br><span class="line">            binary = &quot;0110&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 7:</span><br><span class="line">            binary = &quot;0111&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 8:</span><br><span class="line">            binary = &quot;1000&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 9:</span><br><span class="line">            binary = &quot;1001&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 10:</span><br><span class="line">            binary = &quot;1010&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 11:</span><br><span class="line">            binary = &quot;1011&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 12:</span><br><span class="line">            binary = &quot;1100&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 13:</span><br><span class="line">            binary = &quot;1101&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 14:</span><br><span class="line">            binary = &quot;1110&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 15:</span><br><span class="line">            binary = &quot;1111&quot;;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        return binary;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /*</span><br><span class="line">     * generate 16 keys for xor</span><br><span class="line">     * </span><br><span class="line">     */</span><br><span class="line">    public int[][] generateKeys(int[] keyByte) &#123;</span><br><span class="line">        int[] key = new int[56];</span><br><span class="line">        int[][] keys = new int[16][48];</span><br><span class="line"> </span><br><span class="line">        // keys[ 0] = new Array();</span><br><span class="line">        // keys[ 1] = new Array();</span><br><span class="line">        // keys[ 2] = new Array();</span><br><span class="line">        // keys[ 3] = new Array();</span><br><span class="line">        // keys[ 4] = new Array();</span><br><span class="line">        // keys[ 5] = new Array();</span><br><span class="line">        // keys[ 6] = new Array();</span><br><span class="line">        // keys[ 7] = new Array();</span><br><span class="line">        // keys[ 8] = new Array();</span><br><span class="line">        // keys[ 9] = new Array();</span><br><span class="line">        // keys[10] = new Array();</span><br><span class="line">        // keys[11] = new Array();</span><br><span class="line">        // keys[12] = new Array();</span><br><span class="line">        // keys[13] = new Array();</span><br><span class="line">        // keys[14] = new Array();</span><br><span class="line">        // keys[15] = new Array();</span><br><span class="line">        int[] loop = new int[] &#123; 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1 &#125;;</span><br><span class="line"> </span><br><span class="line">        for (int i = 0; i &lt; 7; i++) &#123;</span><br><span class="line">            for (int j = 0, k = 7; j &lt; 8; j++, k--) &#123;</span><br><span class="line">                key[i * 8 + j] = keyByte[8 * k + i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        int i = 0;</span><br><span class="line">        for (i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            int tempLeft = 0;</span><br><span class="line">            int tempRight = 0;</span><br><span class="line">            for (int j = 0; j &lt; loop[i]; j++) &#123;</span><br><span class="line">                tempLeft = key[0];</span><br><span class="line">                tempRight = key[28];</span><br><span class="line">                for (int k = 0; k &lt; 27; k++) &#123;</span><br><span class="line">                    key[k] = key[k + 1];</span><br><span class="line">                    key[28 + k] = key[29 + k];</span><br><span class="line">                &#125;</span><br><span class="line">                key[27] = tempLeft;</span><br><span class="line">                key[55] = tempRight;</span><br><span class="line">            &#125;</span><br><span class="line">            // var tempKey = new Array(48);</span><br><span class="line">            int[] tempKey = new int[48];</span><br><span class="line">            tempKey[0] = key[13];</span><br><span class="line">            tempKey[1] = key[16];</span><br><span class="line">            tempKey[2] = key[10];</span><br><span class="line">            tempKey[3] = key[23];</span><br><span class="line">            tempKey[4] = key[0];</span><br><span class="line">            tempKey[5] = key[4];</span><br><span class="line">            tempKey[6] = key[2];</span><br><span class="line">            tempKey[7] = key[27];</span><br><span class="line">            tempKey[8] = key[14];</span><br><span class="line">            tempKey[9] = key[5];</span><br><span class="line">            tempKey[10] = key[20];</span><br><span class="line">            tempKey[11] = key[9];</span><br><span class="line">            tempKey[12] = key[22];</span><br><span class="line">            tempKey[13] = key[18];</span><br><span class="line">            tempKey[14] = key[11];</span><br><span class="line">            tempKey[15] = key[3];</span><br><span class="line">            tempKey[16] = key[25];</span><br><span class="line">            tempKey[17] = key[7];</span><br><span class="line">            tempKey[18] = key[15];</span><br><span class="line">            tempKey[19] = key[6];</span><br><span class="line">            tempKey[20] = key[26];</span><br><span class="line">            tempKey[21] = key[19];</span><br><span class="line">            tempKey[22] = key[12];</span><br><span class="line">            tempKey[23] = key[1];</span><br><span class="line">            tempKey[24] = key[40];</span><br><span class="line">            tempKey[25] = key[51];</span><br><span class="line">            tempKey[26] = key[30];</span><br><span class="line">            tempKey[27] = key[36];</span><br><span class="line">            tempKey[28] = key[46];</span><br><span class="line">            tempKey[29] = key[54];</span><br><span class="line">            tempKey[30] = key[29];</span><br><span class="line">            tempKey[31] = key[39];</span><br><span class="line">            tempKey[32] = key[50];</span><br><span class="line">            tempKey[33] = key[44];</span><br><span class="line">            tempKey[34] = key[32];</span><br><span class="line">            tempKey[35] = key[47];</span><br><span class="line">            tempKey[36] = key[43];</span><br><span class="line">            tempKey[37] = key[48];</span><br><span class="line">            tempKey[38] = key[38];</span><br><span class="line">            tempKey[39] = key[55];</span><br><span class="line">            tempKey[40] = key[33];</span><br><span class="line">            tempKey[41] = key[52];</span><br><span class="line">            tempKey[42] = key[45];</span><br><span class="line">            tempKey[43] = key[41];</span><br><span class="line">            tempKey[44] = key[49];</span><br><span class="line">            tempKey[45] = key[35];</span><br><span class="line">            tempKey[46] = key[28];</span><br><span class="line">            tempKey[47] = key[31];</span><br><span class="line">            int m;</span><br><span class="line">            switch (i) &#123;</span><br><span class="line">            case 0:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[0][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 1:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[1][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 2:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[2][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 3:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[3][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 4:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[4][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 5:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[5][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 6:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[6][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 7:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[7][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 8:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[8][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 9:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[9][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 10:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[10][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 11:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[11][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 12:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[12][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 13:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[13][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 14:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[14][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case 15:</span><br><span class="line">                for (m = 0; m &lt; 48; m++) &#123;</span><br><span class="line">                    keys[15][m] = tempKey[m];</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return keys;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç¤ºä¾‹(DES3åŠ å¯†å’Œè§£å¯†):<br>index.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;DES3&lt;/title&gt;</span><br><span class="line">  &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot; src=&quot;DES3.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line"></span><br><span class="line">var str= &quot;123456.&quot;;</span><br><span class="line">var key = &quot;qXSdHWfbSZaaLeHBRhLgxBiG&quot;;</span><br><span class="line">//alert(decrypt_3des);</span><br><span class="line">var des3en = DES3.encrypt(key,str);</span><br><span class="line">document.write(&quot;&lt;/br&gt;des3åŠ å¯†:&lt;/br&gt;&quot;+des3en);</span><br><span class="line">document.write(&quot;&lt;/br&gt;des3è§£å¯†:&lt;/br&gt;&quot;+DES3.decrypt(key,des3en));</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure></p>
<p>DES3.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line">/** </span><br><span class="line"> * DES åŠ å¯†ç®—æ³• </span><br><span class="line"> * </span><br><span class="line"> * è¯¥å‡½æ•°æ¥å—ä¸€ä¸ª 8 å­—èŠ‚å­—ç¬¦ä¸²ä½œä¸ºæ™®é€š DES ç®—æ³•çš„å¯†é’¥ï¼ˆä¹Ÿå°±æ˜¯ 64 ä½ï¼Œä½†æ˜¯ç®—æ³•åªä½¿ç”¨ 56 ä½ï¼‰ï¼Œæˆ–è€…æ¥å—ä¸€ä¸ª 24 å­—èŠ‚å­—ç¬¦ä¸²ä½œä¸º 3DES </span><br><span class="line"> * ç®—æ³•çš„å¯†é’¥ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦åŠ å¯†æˆ–è§£å¯†çš„ä¿¡æ¯å­—ç¬¦ä¸²ï¼›ç¬¬ä¸‰ä¸ªå¸ƒå°”å€¼å‚æ•°ç”¨æ¥è¯´æ˜ä¿¡æ¯æ˜¯åŠ å¯†è¿˜æ˜¯è§£å¯†ï¼›æ¥ä¸‹æ¥çš„å¯é€‰å‚æ•° mode å¦‚æœæ˜¯ 0 è¡¨ç¤º ECB </span><br><span class="line"> * æ¨¡å¼ï¼Œ1 è¡¨ç¤º CBC æ¨¡å¼ï¼Œé»˜è®¤æ˜¯ ECB æ¨¡å¼ï¼›æœ€åä¸€ä¸ªå¯é€‰é¡¹æ˜¯ä¸€ä¸ª 8 å­—èŠ‚çš„è¾“å…¥å‘é‡å­—ç¬¦ä¸²ï¼ˆåœ¨ ECB æ¨¡å¼ä¸‹ä¸ä½¿ç”¨ï¼‰ã€‚è¿”å›çš„å¯†æ–‡æ˜¯å­—ç¬¦ä¸²ã€‚ </span><br><span class="line"> * </span><br><span class="line"> * å‚æ•°ï¼š &lt;br&gt; </span><br><span class="line"> * key: 8å­—èŠ‚å­—ç¬¦ä¸²ä½œä¸ºæ™®é€š DES ç®—æ³•çš„å¯†é’¥,æˆ– 24 å­—èŠ‚å­—ç¬¦ä¸²ä½œä¸º 3DES &lt;br&gt; </span><br><span class="line"> * messageï¼š åŠ å¯†æˆ–è§£å¯†çš„ä¿¡æ¯å­—ç¬¦ä¸²&lt;br&gt; </span><br><span class="line"> * encrypt: å¸ƒå°”å€¼å‚æ•°ç”¨æ¥è¯´æ˜ä¿¡æ¯æ˜¯åŠ å¯†è¿˜æ˜¯è§£å¯†&lt;br&gt; </span><br><span class="line"> * mode: 1:CBCæ¨¡å¼ï¼Œ0:ECBæ¨¡å¼(é»˜è®¤)&lt;br&gt; </span><br><span class="line"> * iv:&lt;br&gt; </span><br><span class="line"> * padding: å¯é€‰é¡¹, 8å­—èŠ‚çš„è¾“å…¥å‘é‡å­—ç¬¦ä¸²ï¼ˆåœ¨ ECB æ¨¡å¼ä¸‹ä¸ä½¿ç”¨ï¼‰ </span><br><span class="line"> */</span><br><span class="line">//this takes the key, the message, and whether to encrypt or decrypt</span><br><span class="line">function des (key, message, encrypt, mode, iv, padding) &#123;</span><br><span class="line">  if(encrypt) //å¦‚æœæ˜¯åŠ å¯†çš„è¯ï¼Œé¦–å…ˆè½¬æ¢ç¼–ç </span><br><span class="line">    message = unescape(encodeURIComponent(message));</span><br><span class="line">  //declaring this locally speeds things up a bit</span><br><span class="line">  var spfunction1 = new Array (0x1010400,0,0x10000,0x1010404,0x1010004,0x10404,0x4,0x10000,0x400,0x1010400,0x1010404,0x400,0x1000404,0x1010004,0x1000000,0x4,0x404,0x1000400,0x1000400,0x10400,0x10400,0x1010000,0x1010000,0x1000404,0x10004,0x1000004,0x1000004,0x10004,0,0x404,0x10404,0x1000000,0x10000,0x1010404,0x4,0x1010000,0x1010400,0x1000000,0x1000000,0x400,0x1010004,0x10000,0x10400,0x1000004,0x400,0x4,0x1000404,0x10404,0x1010404,0x10004,0x1010000,0x1000404,0x1000004,0x404,0x10404,0x1010400,0x404,0x1000400,0x1000400,0,0x10004,0x10400,0,0x1010004);</span><br><span class="line">  var spfunction2 = new Array (-0x7fef7fe0,-0x7fff8000,0x8000,0x108020,0x100000,0x20,-0x7fefffe0,-0x7fff7fe0,-0x7fffffe0,-0x7fef7fe0,-0x7fef8000,-0x80000000,-0x7fff8000,0x100000,0x20,-0x7fefffe0,0x108000,0x100020,-0x7fff7fe0,0,-0x80000000,0x8000,0x108020,-0x7ff00000,0x100020,-0x7fffffe0,0,0x108000,0x8020,-0x7fef8000,-0x7ff00000,0x8020,0,0x108020,-0x7fefffe0,0x100000,-0x7fff7fe0,-0x7ff00000,-0x7fef8000,0x8000,-0x7ff00000,-0x7fff8000,0x20,-0x7fef7fe0,0x108020,0x20,0x8000,-0x80000000,0x8020,-0x7fef8000,0x100000,-0x7fffffe0,0x100020,-0x7fff7fe0,-0x7fffffe0,0x100020,0x108000,0,-0x7fff8000,0x8020,-0x80000000,-0x7fefffe0,-0x7fef7fe0,0x108000);</span><br><span class="line">  var spfunction3 = new Array (0x208,0x8020200,0,0x8020008,0x8000200,0,0x20208,0x8000200,0x20008,0x8000008,0x8000008,0x20000,0x8020208,0x20008,0x8020000,0x208,0x8000000,0x8,0x8020200,0x200,0x20200,0x8020000,0x8020008,0x20208,0x8000208,0x20200,0x20000,0x8000208,0x8,0x8020208,0x200,0x8000000,0x8020200,0x8000000,0x20008,0x208,0x20000,0x8020200,0x8000200,0,0x200,0x20008,0x8020208,0x8000200,0x8000008,0x200,0,0x8020008,0x8000208,0x20000,0x8000000,0x8020208,0x8,0x20208,0x20200,0x8000008,0x8020000,0x8000208,0x208,0x8020000,0x20208,0x8,0x8020008,0x20200);</span><br><span class="line">  var spfunction4 = new Array (0x802001,0x2081,0x2081,0x80,0x802080,0x800081,0x800001,0x2001,0,0x802000,0x802000,0x802081,0x81,0,0x800080,0x800001,0x1,0x2000,0x800000,0x802001,0x80,0x800000,0x2001,0x2080,0x800081,0x1,0x2080,0x800080,0x2000,0x802080,0x802081,0x81,0x800080,0x800001,0x802000,0x802081,0x81,0,0,0x802000,0x2080,0x800080,0x800081,0x1,0x802001,0x2081,0x2081,0x80,0x802081,0x81,0x1,0x2000,0x800001,0x2001,0x802080,0x800081,0x2001,0x2080,0x800000,0x802001,0x80,0x800000,0x2000,0x802080);</span><br><span class="line">  var spfunction5 = new Array (0x100,0x2080100,0x2080000,0x42000100,0x80000,0x100,0x40000000,0x2080000,0x40080100,0x80000,0x2000100,0x40080100,0x42000100,0x42080000,0x80100,0x40000000,0x2000000,0x40080000,0x40080000,0,0x40000100,0x42080100,0x42080100,0x2000100,0x42080000,0x40000100,0,0x42000000,0x2080100,0x2000000,0x42000000,0x80100,0x80000,0x42000100,0x100,0x2000000,0x40000000,0x2080000,0x42000100,0x40080100,0x2000100,0x40000000,0x42080000,0x2080100,0x40080100,0x100,0x2000000,0x42080000,0x42080100,0x80100,0x42000000,0x42080100,0x2080000,0,0x40080000,0x42000000,0x80100,0x2000100,0x40000100,0x80000,0,0x40080000,0x2080100,0x40000100);</span><br><span class="line">  var spfunction6 = new Array (0x20000010,0x20400000,0x4000,0x20404010,0x20400000,0x10,0x20404010,0x400000,0x20004000,0x404010,0x400000,0x20000010,0x400010,0x20004000,0x20000000,0x4010,0,0x400010,0x20004010,0x4000,0x404000,0x20004010,0x10,0x20400010,0x20400010,0,0x404010,0x20404000,0x4010,0x404000,0x20404000,0x20000000,0x20004000,0x10,0x20400010,0x404000,0x20404010,0x400000,0x4010,0x20000010,0x400000,0x20004000,0x20000000,0x4010,0x20000010,0x20404010,0x404000,0x20400000,0x404010,0x20404000,0,0x20400010,0x10,0x4000,0x20400000,0x404010,0x4000,0x400010,0x20004010,0,0x20404000,0x20000000,0x400010,0x20004010);</span><br><span class="line">  var spfunction7 = new Array (0x200000,0x4200002,0x4000802,0,0x800,0x4000802,0x200802,0x4200800,0x4200802,0x200000,0,0x4000002,0x2,0x4000000,0x4200002,0x802,0x4000800,0x200802,0x200002,0x4000800,0x4000002,0x4200000,0x4200800,0x200002,0x4200000,0x800,0x802,0x4200802,0x200800,0x2,0x4000000,0x200800,0x4000000,0x200800,0x200000,0x4000802,0x4000802,0x4200002,0x4200002,0x2,0x200002,0x4000000,0x4000800,0x200000,0x4200800,0x802,0x200802,0x4200800,0x802,0x4000002,0x4200802,0x4200000,0x200800,0,0x2,0x4200802,0,0x200802,0x4200000,0x800,0x4000002,0x4000800,0x800,0x200002);</span><br><span class="line">  var spfunction8 = new Array (0x10001040,0x1000,0x40000,0x10041040,0x10000000,0x10001040,0x40,0x10000000,0x40040,0x10040000,0x10041040,0x41000,0x10041000,0x41040,0x1000,0x40,0x10040000,0x10000040,0x10001000,0x1040,0x41000,0x40040,0x10040040,0x10041000,0x1040,0,0,0x10040040,0x10000040,0x10001000,0x41040,0x40000,0x41040,0x40000,0x10041000,0x1000,0x40,0x10040040,0x1000,0x41040,0x10001000,0x40,0x10000040,0x10040000,0x10040040,0x10000000,0x40000,0x10001040,0,0x10041040,0x40040,0x10000040,0x10040000,0x10001000,0x10001040,0,0x10041040,0x41000,0x41000,0x1040,0x1040,0x40040,0x10000000,0x10041000);</span><br><span class="line">  //create the 16 or 48 subkeys we will need</span><br><span class="line">  var keys = des_createKeys (key);</span><br><span class="line">  var m=0, i, j, temp, temp2, right1, right2, left, right, looping;</span><br><span class="line">  var cbcleft, cbcleft2, cbcright, cbcright2</span><br><span class="line">  var endloop, loopinc;</span><br><span class="line">  var len = message.length;</span><br><span class="line">  var chunk = 0;</span><br><span class="line">  //set up the loops for single and triple des</span><br><span class="line">  var iterations = keys.length == 32 ? 3 : 9; //single or triple des</span><br><span class="line">  if (iterations == 3) &#123;looping = encrypt ? new Array (0, 32, 2) : new Array (30, -2, -2);&#125;</span><br><span class="line">  else &#123;looping = encrypt ? new Array (0, 32, 2, 62, 30, -2, 64, 96, 2) : new Array (94, 62, -2, 32, 64, 2, 30, -2, -2);&#125;</span><br><span class="line">  //pad the message depending on the padding parameter</span><br><span class="line">  if (padding == 2) message += &quot;    &quot;; //pad the message with spaces</span><br><span class="line">  else if (padding == 1) &#123;</span><br><span class="line">    if(encrypt) &#123;</span><br><span class="line">      temp = 8-(len%8);</span><br><span class="line">      message += String.fromCharCode(temp,temp,temp,temp,temp,temp,temp,temp);</span><br><span class="line">      if (temp===8) len+=8;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; //PKCS7 padding</span><br><span class="line">  else if (!padding) message += &quot;\0\0\0\0\0\0\0\0&quot;; //pad the message out with null bytes</span><br><span class="line">  //store the result here</span><br><span class="line">  var result = &quot;&quot;;</span><br><span class="line">  var tempresult = &quot;&quot;;</span><br><span class="line">  if (mode == 1) &#123; //CBC mode</span><br><span class="line">    cbcleft = (iv.charCodeAt(m++) &lt;&lt; 24) | (iv.charCodeAt(m++) &lt;&lt; 16) | (iv.charCodeAt(m++) &lt;&lt; 8) | iv.charCodeAt(m++);</span><br><span class="line">    cbcright = (iv.charCodeAt(m++) &lt;&lt; 24) | (iv.charCodeAt(m++) &lt;&lt; 16) | (iv.charCodeAt(m++) &lt;&lt; 8) | iv.charCodeAt(m++);</span><br><span class="line">    m=0;</span><br><span class="line">  &#125;</span><br><span class="line">  //loop through each 64 bit chunk of the message</span><br><span class="line">  while (m &lt; len) &#123;</span><br><span class="line">    left = (message.charCodeAt(m++) &lt;&lt; 24) | (message.charCodeAt(m++) &lt;&lt; 16) | (message.charCodeAt(m++) &lt;&lt; 8) | message.charCodeAt(m++);</span><br><span class="line">    right = (message.charCodeAt(m++) &lt;&lt; 24) | (message.charCodeAt(m++) &lt;&lt; 16) | (message.charCodeAt(m++) &lt;&lt; 8) | message.charCodeAt(m++);</span><br><span class="line">    //for Cipher Block Chaining mode, xor the message with the previous result</span><br><span class="line">    if (mode == 1) &#123;if (encrypt) &#123;left ^= cbcleft; right ^= cbcright;&#125; else &#123;cbcleft2 = cbcleft; cbcright2 = cbcright; cbcleft = left; cbcright = right;&#125;&#125;</span><br><span class="line">    //first each 64 but chunk of the message must be permuted according to IP</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 4) ^ right) &amp; 0x0f0f0f0f; right ^= temp; left ^= (temp &lt;&lt; 4);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 16) ^ right) &amp; 0x0000ffff; right ^= temp; left ^= (temp &lt;&lt; 16);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; 2) ^ left) &amp; 0x33333333; left ^= temp; right ^= (temp &lt;&lt; 2);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; 8) ^ left) &amp; 0x00ff00ff; left ^= temp; right ^= (temp &lt;&lt; 8);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 1) ^ right) &amp; 0x55555555; right ^= temp; left ^= (temp &lt;&lt; 1);</span><br><span class="line">    left = ((left &lt;&lt; 1) | (left &gt;&gt;&gt; 31));</span><br><span class="line">    right = ((right &lt;&lt; 1) | (right &gt;&gt;&gt; 31));</span><br><span class="line">    //do this either 1 or 3 times for each chunk of the message</span><br><span class="line">    for (j=0; j&lt;iterations; j+=3) &#123;</span><br><span class="line">      endloop = looping[j+1];</span><br><span class="line">      loopinc = looping[j+2];</span><br><span class="line">      //now go through and perform the encryption or decryption</span><br><span class="line">      for (i=looping[j]; i!=endloop; i+=loopinc) &#123; //for efficiency</span><br><span class="line">        right1 = right ^ keys[i];</span><br><span class="line">        right2 = ((right &gt;&gt;&gt; 4) | (right &lt;&lt; 28)) ^ keys[i+1];</span><br><span class="line">        //the result is attained by passing these bytes through the S selection functions</span><br><span class="line">        temp = left;</span><br><span class="line">        left = right;</span><br><span class="line">        right = temp ^ (spfunction2[(right1 &gt;&gt;&gt; 24) &amp; 0x3f] | spfunction4[(right1 &gt;&gt;&gt; 16) &amp; 0x3f]</span><br><span class="line">          | spfunction6[(right1 &gt;&gt;&gt; 8) &amp; 0x3f] | spfunction8[right1 &amp; 0x3f]</span><br><span class="line">          | spfunction1[(right2 &gt;&gt;&gt; 24) &amp; 0x3f] | spfunction3[(right2 &gt;&gt;&gt; 16) &amp; 0x3f]</span><br><span class="line">          | spfunction5[(right2 &gt;&gt;&gt; 8) &amp; 0x3f] | spfunction7[right2 &amp; 0x3f]);</span><br><span class="line">      &#125;</span><br><span class="line">      temp = left; left = right; right = temp; //unreverse left and right</span><br><span class="line">    &#125; //for either 1 or 3 iterations</span><br><span class="line">    //move then each one bit to the right</span><br><span class="line">    left = ((left &gt;&gt;&gt; 1) | (left &lt;&lt; 31));</span><br><span class="line">    right = ((right &gt;&gt;&gt; 1) | (right &lt;&lt; 31));</span><br><span class="line">    //now perform IP-1, which is IP in the opposite direction</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 1) ^ right) &amp; 0x55555555; right ^= temp; left ^= (temp &lt;&lt; 1);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; 8) ^ left) &amp; 0x00ff00ff; left ^= temp; right ^= (temp &lt;&lt; 8);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; 2) ^ left) &amp; 0x33333333; left ^= temp; right ^= (temp &lt;&lt; 2);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 16) ^ right) &amp; 0x0000ffff; right ^= temp; left ^= (temp &lt;&lt; 16);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 4) ^ right) &amp; 0x0f0f0f0f; right ^= temp; left ^= (temp &lt;&lt; 4);</span><br><span class="line">    //for Cipher Block Chaining mode, xor the message with the previous result</span><br><span class="line">    if (mode == 1) &#123;if (encrypt) &#123;cbcleft = left; cbcright = right;&#125; else &#123;left ^= cbcleft2; right ^= cbcright2;&#125;&#125;</span><br><span class="line">    tempresult += String.fromCharCode ((left&gt;&gt;&gt;24), ((left&gt;&gt;&gt;16) &amp; 0xff), ((left&gt;&gt;&gt;8) &amp; 0xff), (left &amp; 0xff), (right&gt;&gt;&gt;24), ((right&gt;&gt;&gt;16) &amp; 0xff), ((right&gt;&gt;&gt;8) &amp; 0xff), (right &amp; 0xff));</span><br><span class="line">    chunk += 8;</span><br><span class="line">    if (chunk == 512) &#123;result += tempresult; tempresult = &quot;&quot;; chunk = 0;&#125;</span><br><span class="line">  &#125; //for every 8 characters, or 64 bits in the message</span><br><span class="line">  //return the result as an array</span><br><span class="line">  result += tempresult;</span><br><span class="line">  result = result.replace(/\0*$/g, &quot;&quot;);</span><br><span class="line">  if(!encrypt ) &#123; //å¦‚æœæ˜¯è§£å¯†çš„è¯ï¼Œè§£å¯†ç»“æŸåå¯¹PKCS7 paddingè¿›è¡Œè§£ç ï¼Œå¹¶è½¬æ¢æˆutf-8ç¼–ç </span><br><span class="line">    if(padding === 1) &#123; //PKCS7 paddingè§£ç </span><br><span class="line">      var len = result.length, paddingChars = 0;</span><br><span class="line">      len &amp;&amp; (paddingChars = result.charCodeAt(len-1));</span><br><span class="line">      (paddingChars &lt;= 8) &amp;&amp; (result = result.substring(0, len - paddingChars));</span><br><span class="line">    &#125;</span><br><span class="line">    //è½¬æ¢æˆUTF-8ç¼–ç </span><br><span class="line">    result = decodeURIComponent(escape(result));</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125; //end of des</span><br><span class="line">//des_createKeys</span><br><span class="line">//this takes as input a 64 bit key (even though only 56 bits are used)</span><br><span class="line">//as an array of 2 integers, and returns 16 48 bit keys</span><br><span class="line">function des_createKeys (key) &#123;</span><br><span class="line">  //declaring this locally speeds things up a bit</span><br><span class="line">  var pc2bytes0 = new Array (0,0x4,0x20000000,0x20000004,0x10000,0x10004,0x20010000,0x20010004,0x200,0x204,0x20000200,0x20000204,0x10200,0x10204,0x20010200,0x20010204);</span><br><span class="line">  var pc2bytes1 = new Array (0,0x1,0x100000,0x100001,0x4000000,0x4000001,0x4100000,0x4100001,0x100,0x101,0x100100,0x100101,0x4000100,0x4000101,0x4100100,0x4100101);</span><br><span class="line">  var pc2bytes2 = new Array (0,0x8,0x800,0x808,0x1000000,0x1000008,0x1000800,0x1000808,0,0x8,0x800,0x808,0x1000000,0x1000008,0x1000800,0x1000808);</span><br><span class="line">  var pc2bytes3 = new Array (0,0x200000,0x8000000,0x8200000,0x2000,0x202000,0x8002000,0x8202000,0x20000,0x220000,0x8020000,0x8220000,0x22000,0x222000,0x8022000,0x8222000);</span><br><span class="line">  var pc2bytes4 = new Array (0,0x40000,0x10,0x40010,0,0x40000,0x10,0x40010,0x1000,0x41000,0x1010,0x41010,0x1000,0x41000,0x1010,0x41010);</span><br><span class="line">  var pc2bytes5 = new Array (0,0x400,0x20,0x420,0,0x400,0x20,0x420,0x2000000,0x2000400,0x2000020,0x2000420,0x2000000,0x2000400,0x2000020,0x2000420);</span><br><span class="line">  var pc2bytes6 = new Array (0,0x10000000,0x80000,0x10080000,0x2,0x10000002,0x80002,0x10080002,0,0x10000000,0x80000,0x10080000,0x2,0x10000002,0x80002,0x10080002);</span><br><span class="line">  var pc2bytes7 = new Array (0,0x10000,0x800,0x10800,0x20000000,0x20010000,0x20000800,0x20010800,0x20000,0x30000,0x20800,0x30800,0x20020000,0x20030000,0x20020800,0x20030800);</span><br><span class="line">  var pc2bytes8 = new Array (0,0x40000,0,0x40000,0x2,0x40002,0x2,0x40002,0x2000000,0x2040000,0x2000000,0x2040000,0x2000002,0x2040002,0x2000002,0x2040002);</span><br><span class="line">  var pc2bytes9 = new Array (0,0x10000000,0x8,0x10000008,0,0x10000000,0x8,0x10000008,0x400,0x10000400,0x408,0x10000408,0x400,0x10000400,0x408,0x10000408);</span><br><span class="line">  var pc2bytes10 = new Array (0,0x20,0,0x20,0x100000,0x100020,0x100000,0x100020,0x2000,0x2020,0x2000,0x2020,0x102000,0x102020,0x102000,0x102020);</span><br><span class="line">  var pc2bytes11 = new Array (0,0x1000000,0x200,0x1000200,0x200000,0x1200000,0x200200,0x1200200,0x4000000,0x5000000,0x4000200,0x5000200,0x4200000,0x5200000,0x4200200,0x5200200);</span><br><span class="line">  var pc2bytes12 = new Array (0,0x1000,0x8000000,0x8001000,0x80000,0x81000,0x8080000,0x8081000,0x10,0x1010,0x8000010,0x8001010,0x80010,0x81010,0x8080010,0x8081010);</span><br><span class="line">  var pc2bytes13 = new Array (0,0x4,0x100,0x104,0,0x4,0x100,0x104,0x1,0x5,0x101,0x105,0x1,0x5,0x101,0x105);</span><br><span class="line">  //how many iterations (1 for des, 3 for triple des)</span><br><span class="line">  var iterations = key.length &gt; 8 ? 3 : 1; //changed by Paul 16/6/2007 to use Triple DES for 9+ byte keys</span><br><span class="line">  //stores the return keys</span><br><span class="line">  var keys = new Array (32 * iterations);</span><br><span class="line">  //now define the left shifts which need to be done</span><br><span class="line">  var shifts = new Array (0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0);</span><br><span class="line">  //other variables</span><br><span class="line">  var lefttemp, righttemp, m=0, n=0, temp;</span><br><span class="line">  for (var j=0; j&lt;iterations; j++) &#123; //either 1 or 3 iterations</span><br><span class="line">    var left = (key.charCodeAt(m++) &lt;&lt; 24) | (key.charCodeAt(m++) &lt;&lt; 16) | (key.charCodeAt(m++) &lt;&lt; 8) | key.charCodeAt(m++);</span><br><span class="line">    var right = (key.charCodeAt(m++) &lt;&lt; 24) | (key.charCodeAt(m++) &lt;&lt; 16) | (key.charCodeAt(m++) &lt;&lt; 8) | key.charCodeAt(m++);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 4) ^ right) &amp; 0x0f0f0f0f; right ^= temp; left ^= (temp &lt;&lt; 4);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; -16) ^ left) &amp; 0x0000ffff; left ^= temp; right ^= (temp &lt;&lt; -16);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 2) ^ right) &amp; 0x33333333; right ^= temp; left ^= (temp &lt;&lt; 2);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; -16) ^ left) &amp; 0x0000ffff; left ^= temp; right ^= (temp &lt;&lt; -16);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 1) ^ right) &amp; 0x55555555; right ^= temp; left ^= (temp &lt;&lt; 1);</span><br><span class="line">    temp = ((right &gt;&gt;&gt; 8) ^ left) &amp; 0x00ff00ff; left ^= temp; right ^= (temp &lt;&lt; 8);</span><br><span class="line">    temp = ((left &gt;&gt;&gt; 1) ^ right) &amp; 0x55555555; right ^= temp; left ^= (temp &lt;&lt; 1);</span><br><span class="line">    //the right side needs to be shifted and to get the last four bits of the left side</span><br><span class="line">    temp = (left &lt;&lt; 8) | ((right &gt;&gt;&gt; 20) &amp; 0x000000f0);</span><br><span class="line">    //left needs to be put upside down</span><br><span class="line">    left = (right &lt;&lt; 24) | ((right &lt;&lt; 8) &amp; 0xff0000) | ((right &gt;&gt;&gt; 8) &amp; 0xff00) | ((right &gt;&gt;&gt; 24) &amp; 0xf0);</span><br><span class="line">    right = temp;</span><br><span class="line">    //now go through and perform these shifts on the left and right keys</span><br><span class="line">    for (var i=0; i &lt; shifts.length; i++) &#123;</span><br><span class="line">      //shift the keys either one or two bits to the left</span><br><span class="line">      if (shifts[i]) &#123;left = (left &lt;&lt; 2) | (left &gt;&gt;&gt; 26); right = (right &lt;&lt; 2) | (right &gt;&gt;&gt; 26);&#125;</span><br><span class="line">      else &#123;left = (left &lt;&lt; 1) | (left &gt;&gt;&gt; 27); right = (right &lt;&lt; 1) | (right &gt;&gt;&gt; 27);&#125;</span><br><span class="line">      left &amp;= -0xf; right &amp;= -0xf;</span><br><span class="line">      //now apply PC-2, in such a way that E is easier when encrypting or decrypting</span><br><span class="line">      //this conversion will look like PC-2 except only the last 6 bits of each byte are used</span><br><span class="line">      //rather than 48 consecutive bits and the order of lines will be according to</span><br><span class="line">      //how the S selection functions will be applied: S2, S4, S6, S8, S1, S3, S5, S7</span><br><span class="line">      lefttemp = pc2bytes0[left &gt;&gt;&gt; 28] | pc2bytes1[(left &gt;&gt;&gt; 24) &amp; 0xf]</span><br><span class="line">        | pc2bytes2[(left &gt;&gt;&gt; 20) &amp; 0xf] | pc2bytes3[(left &gt;&gt;&gt; 16) &amp; 0xf]</span><br><span class="line">        | pc2bytes4[(left &gt;&gt;&gt; 12) &amp; 0xf] | pc2bytes5[(left &gt;&gt;&gt; 8) &amp; 0xf]</span><br><span class="line">        | pc2bytes6[(left &gt;&gt;&gt; 4) &amp; 0xf];</span><br><span class="line">      righttemp = pc2bytes7[right &gt;&gt;&gt; 28] | pc2bytes8[(right &gt;&gt;&gt; 24) &amp; 0xf]</span><br><span class="line">        | pc2bytes9[(right &gt;&gt;&gt; 20) &amp; 0xf] | pc2bytes10[(right &gt;&gt;&gt; 16) &amp; 0xf]</span><br><span class="line">        | pc2bytes11[(right &gt;&gt;&gt; 12) &amp; 0xf] | pc2bytes12[(right &gt;&gt;&gt; 8) &amp; 0xf]</span><br><span class="line">        | pc2bytes13[(right &gt;&gt;&gt; 4) &amp; 0xf];</span><br><span class="line">      temp = ((righttemp &gt;&gt;&gt; 16) ^ lefttemp) &amp; 0x0000ffff;</span><br><span class="line">      keys[n++] = lefttemp ^ temp; keys[n++] = righttemp ^ (temp &lt;&lt; 16);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; //for each iterations</span><br><span class="line">  //return the keys we&apos;ve created</span><br><span class="line">  return keys;</span><br><span class="line">&#125; //end of des_createKeys</span><br><span class="line">function genkey(key, start, end) &#123;</span><br><span class="line">  //8 byte / 64 bit Key (DES) or 192 bit Key</span><br><span class="line">  return &#123;key:pad(key.slice(start, end)),vector: 1&#125;;</span><br><span class="line">&#125;</span><br><span class="line">function pad(key) &#123;</span><br><span class="line">  for (var i = key.length; i&lt;24; i++) &#123;</span><br><span class="line">    key+=&quot;0&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  return key;</span><br><span class="line">&#125;</span><br><span class="line">var des3iv = &apos;12345678&apos;;</span><br><span class="line"></span><br><span class="line">var DES3 = &#123;</span><br><span class="line">  //3DESåŠ å¯†ï¼ŒCBC/PKCS5Padding</span><br><span class="line">  encrypt:function(key,input)&#123;</span><br><span class="line">    var genKey = genkey(key, 0, 24);</span><br><span class="line">    return btoa(des(genKey.key, input, 1, 1, des3iv, 1));</span><br><span class="line">  &#125;,</span><br><span class="line">  ////3DESè§£å¯†ï¼ŒCBC/PKCS5Padding</span><br><span class="line">  decrypt:function(key,input)&#123;</span><br><span class="line">    var genKey = genkey(key, 0, 24); </span><br><span class="line">    return des(genKey.key, atob(input), 0, 1, des3iv, 1); </span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>å‚è€ƒé“¾æ¥:<br>MD5ç®—æ³•çš„å¿…è¦æ€§ä»¥åŠå®é™…åº”ç”¨:<a href="http://www.jiamisoft.com/blog/23015-qdgs.html" target="_blank" rel="noopener">http://www.jiamisoft.com/blog/23015-qdgs.html</a><br>DESã€AESã€RSAã€MD5åŠ å¯†ç®—æ³•è¾¨æä¸åº”ç”¨åœºæ™¯:<a href="https://blog.csdn.net/kegebo_h/article/details/78056536" target="_blank" rel="noopener">https://blog.csdn.net/kegebo_h/article/details/78056536</a><br>md5.jsåŠ å¯†:<a href="https://www.cnblogs.com/CooLLYP/p/8628467.html" target="_blank" rel="noopener">https://www.cnblogs.com/CooLLYP/p/8628467.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/03/04/javascriptä¹‹ä¼ è¾“åŠ å¯†/" data-id="cju836j58004fw8vkur7zblsv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-VsCodeæ’ä»¶å¼€å‘ä¹‹é€šä¿¡" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/01/VsCodeæ’ä»¶å¼€å‘ä¹‹é€šä¿¡/" class="article-date">
  <time datetime="2019-03-01T14:20:15.000Z" itemprop="datePublished">2019-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/01/VsCodeæ’ä»¶å¼€å‘ä¹‹é€šä¿¡/">VsCodeæ’ä»¶å¼€å‘ä¹‹é€šä¿¡</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»Šå¤©çš„ä¸»é¢˜ä¸»è¦å›´ç»•è¿™ä¹ˆå‡ ä¸ªæ–¹é¢æ¥è¿›è¡Œ?</p>
<ul>
<li>å¦‚ä½•å¼€å‘å‡ºä¸€ä¸ªVsCodeæ’ä»¶?</li>
<li>ä½¿ç”¨tså¼€å‘VsCodeæ’ä»¶(tsåœ¨æ­¤å¦‚ä½•é€šä¿¡)</li>
<li>ä½¿ç”¨jså¼€å‘VsCodeæ’ä»¶(jsåœ¨æ­¤å¦‚ä½•é€šä¿¡)</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/03/01/VsCodeæ’ä»¶å¼€å‘ä¹‹é€šä¿¡/" data-id="cju836j1y0010w8vkl4tk08iv" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VsCode/">VsCode</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Pythonå®ç°æœºå™¨äººèŠå¤©" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/01/Pythonå®ç°æœºå™¨äººèŠå¤©/" class="article-date">
  <time datetime="2019-03-01T13:56:13.000Z" itemprop="datePublished">2019-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/01/Pythonå®ç°æœºå™¨äººèŠå¤©/">Pythonå®ç°æœºå™¨äººèŠå¤©</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ä»Šå¤©åˆä¼‘çš„æ—¶å€™ï¼Œæ— æ„ä¹‹ä¸­çœ‹äº†ä¸€ç¯‡åšå®¢ï¼Œåå­—å«Pythonå®ç°æœºå™¨äººï¼Œæ„Ÿè§‰æŒºæœ‰çš„æ„æ€çš„ã€‚<br>äºæ˜¯ç”¨å…¶å†™äº†ä¸€ä¸ªç®€å•çš„PythonèŠå¤©ï¼Œæºç å¦‚ä¸‹æ‰€ç¤º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import aiml</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">def get_module_dir(name):</span><br><span class="line"> print(&quot;module&quot;, sys.modules[name])</span><br><span class="line"> path = getattr(sys.modules[name], &apos;__file__&apos;, None)</span><br><span class="line"> print(path)</span><br><span class="line"> if not path:</span><br><span class="line">  raise AttributeError(&apos;module %s has not attribute __file__&apos; % name)</span><br><span class="line"> return os.path.dirname(os.path.abspath(path))</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">alice_path = get_module_dir(&apos;aiml&apos;) + &apos;\\botdata\\alice&apos;</span><br><span class="line"> </span><br><span class="line">os.chdir(alice_path)  # åˆ‡æ¢åˆ°è¯­æ–™åº“æ‰€åœ¨å·¥ä½œç›®å½•</span><br><span class="line"> </span><br><span class="line">alice = aiml.Kernel()  # åˆ›å»ºæœºå™¨äººaliceå¯¹è±¡</span><br><span class="line">alice.learn(&quot;startup.xml&quot;) # åŠ è½½...\\botdata\\alice\\startup.xml</span><br><span class="line">alice.respond(&apos;LOAD ALICE&apos;) # åŠ è½½...\\botdata\\aliceç›®å½•ä¸‹çš„è¯­æ–™åº“</span><br><span class="line">  </span><br><span class="line">while True:</span><br><span class="line"> message = input(&quot;Enter your message &gt;&gt; &quot;)</span><br><span class="line"> if(&quot;exit&quot; == message):</span><br><span class="line">  exit()</span><br><span class="line"> response = alice.respond(message) # æœºå™¨äººåº”ç­”</span><br><span class="line"> print(response)</span><br></pre></td></tr></table></figure></p>
<p>æ³¨æ„:å¦‚æœå‡ºç°æŸæŸæ¨¡å—æ‰¾ä¸åˆ°çš„æ—¶å€™ï¼Œè®°å¾—ä½¿ç”¨pipå®‰è£…å¯¹åº”çš„æ¨¡å—ã€‚</p>
<p>æ•ˆæœå›¾å¦‚ä¸‹æ‰€ç¤º:<br><img src="/2019/03/01/Pythonå®ç°æœºå™¨äººèŠå¤©/rebot01.png" alt=""></p>
<p>å”¯ä¸€ç¾ä¸­ä¸è¶³çš„æ˜¯è‹±æ–‡ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œå›½å†…æœ‰å›¾çµæœºå™¨äººã€‚</p>
<p>ä»£ç å¦‚ä¸‹æ‰€ç¤º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">from urllib.request import urlopen,Request</span><br><span class="line">from urllib.error import URLError</span><br><span class="line">from urllib.parse import urlencode</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">class TuringChatMode(object):</span><br><span class="line">    &quot;&quot;&quot;this mode base on turing robot&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        # APIæ¥å£åœ°å€</span><br><span class="line">        self.turing_url = &apos;http://www.tuling123.com/openapi/api?&apos;</span><br><span class="line"></span><br><span class="line">    def get_turing_text(self,text):</span><br><span class="line">        &apos;&apos;&apos; è¯·æ±‚æ–¹å¼:   HTTP POST</span><br><span class="line">            è¯·æ±‚å‚æ•°:   å‚æ•°      æ˜¯å¦å¿…é¡»        é•¿åº¦          è¯´æ˜</span><br><span class="line">                        key        å¿…é¡»          32           APIkey</span><br><span class="line">                        info       å¿…é¡»          1-32         è¯·æ±‚å†…å®¹ï¼Œç¼–ç æ–¹å¼ä¸º&quot;utf-8&quot;</span><br><span class="line">                        userid     å¿…é¡»          32           MACåœ°å€æˆ–ID</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        turing_url_data = dict(</span><br><span class="line">            key = &apos;fcbf9efe277e493993e889eabca5b331&apos;,</span><br><span class="line">            info = text,</span><br><span class="line">            userid = &apos;60-14-B3-BA-E1-4D&apos;,</span><br><span class="line"></span><br><span class="line">        )</span><br><span class="line">        # print(&quot;The things to Request is:&quot;,self.turing_url + urlencode(turing_url_data))</span><br><span class="line">        self.request = Request(self.turing_url + urlencode(turing_url_data))</span><br><span class="line">        # print(&quot;The result of Request is:&quot;,self.request)</span><br><span class="line"></span><br><span class="line">        try:</span><br><span class="line">            w_data = urlopen(self.request)</span><br><span class="line">            # print(&quot;Type of the data from urlopen:&quot;,type(w_data))</span><br><span class="line">            # print(&quot;The data from urlopen is:&quot;,w_data)</span><br><span class="line">        except URLError:</span><br><span class="line">            raise IndexError(&quot;No internet connection available to transfer txt data&quot;)</span><br><span class="line">            # å¦‚æœå‘ç”Ÿç½‘ç»œé”™è¯¯ï¼Œæ–­è¨€æç¤ºæ²¡æœ‰å¯ç”¨çš„ç½‘ç»œè¿æ¥æ¥ä¼ è¾“æ–‡æœ¬ä¿¡æ¯</span><br><span class="line">        except:</span><br><span class="line">            raise KeyError(&quot;Server wouldn&apos;t respond (invalid key or quota has been maxed out)&quot;)</span><br><span class="line">            # å…¶ä»–æƒ…å†µæ–­è¨€æç¤ºæœåŠ¡ç›¸åº”æ¬¡æ•°å·²ç»è¾¾åˆ°ä¸Šé™</span><br><span class="line"></span><br><span class="line">        response_text = w_data.read().decode(&apos;utf-8&apos;)</span><br><span class="line">        # print(&quot;Type of the response_text :&quot;,type(response_text))</span><br><span class="line">        # print(&quot;response_text :&quot;,response_text)</span><br><span class="line"></span><br><span class="line">        json_result = json.loads(response_text)</span><br><span class="line">        # print(&quot;Type of the json_result :&quot;,type(json_result))</span><br><span class="line">        return json_result[&apos;text&apos;]</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    print(&quot;Now u can type in something &amp; input q to quit&quot;)</span><br><span class="line"></span><br><span class="line">    turing = TuringChatMode()</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        msg = input(&quot;\nMaster:&quot;)</span><br><span class="line">        if msg == &apos;q&apos;:</span><br><span class="line">            exit(&quot;u r quit the chat !&quot;)         # è®¾å®šè¾“å…¥qï¼Œé€€å‡ºèŠå¤©ã€‚</span><br><span class="line">        else:</span><br><span class="line">            turing_data = turing.get_turing_text(msg)</span><br><span class="line">            print(&quot;Robot:&quot;,turing_data)</span><br></pre></td></tr></table></figure></p>
<p>æ•ˆæœå›¾å¦‚ä¸‹:<br><img src="/2019/03/01/Pythonå®ç°æœºå™¨äººèŠå¤©/rebot02.png" alt=""></p>
<p>å¯èƒ½ç”±äºæœºå™¨äººæ™ºèƒ½å¤ªä½äº†ï¼Œæœ‰ç‚¹ç­”éæ‰€é—®ã€‚</p>
<p>æ›´å¤šç²¾å½©å¯ä»¥å»å›¾çµæœºå™¨äººå®˜ç½‘äº†è§£:<a href="http://www.tuling123.com" target="_blank" rel="noopener">http://www.tuling123.com</a></p>
<p>ç¼–ç¨‹çš„ä¸–ç•Œæ˜¯æœ‰è¶£çš„ï¼Œä½ å»æ¢ç´¢ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šæœ‰æ„æ€çš„äº‹æƒ…ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/03/01/Pythonå®ç°æœºå™¨äººèŠå¤©/" data-id="cju836j1i000hw8vkzy2d4u12" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ " class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /" class="article-date">
  <time datetime="2019-03-01T12:49:08.000Z" itemprop="datePublished">2019-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /">node.jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ </a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å…³äºnode.jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸»è¦æ¥è‡ªäºæœ€è¿‘å¯¹Settings-Syncæ’ä»¶åšçš„ç ”ç©¶ã€‚<br>ç›®å‰çš„ç ”ç©¶ç®—æ˜¯å–å¾—çš„æ¯”è¾ƒå¥½çš„è¿›å±•ã€‚<br>Settings-Syncä¸­é€šè¿‡å¿«æ·é”®ä¸Šä¼ æ–‡ä»¶ï¼Œå…¶å®ä¸»è¦è¿˜æ˜¯è¯·æ±‚åç«¯æ¥å£ã€‚<br>äºæ˜¯æˆ‘ä¾¿ä½¿ç”¨node.jsæ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡ï¼Œè¿™ä¸ªæœåŠ¡å…¶å®å°±ç›¸å½“äºgithub api(Settings-Syncå®é™…è¯·æ±‚çš„æ¥å£ï¼Œæ¯”å¦‚tokenéªŒè¯ï¼Œgistå­˜å‚¨åˆ›å»ºç­‰éƒ½æ˜¯æ¥è‡ªgithub å¯¹åº”çš„api)ã€‚</p>
<p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä»£ç è´´èµ·è®²è§£:</p>
<h2><span id="1åˆ›å»ºä¸€ä¸ªnodejsé¡¹ç›®è¿™é‡Œæˆ‘ä»¥expressæ¡†æ¶ä¸ºä¾‹">1.åˆ›å»ºä¸€ä¸ªnode.jsé¡¹ç›®(è¿™é‡Œæˆ‘ä»¥expressæ¡†æ¶ä¸ºä¾‹)</span></h2><p>å…³äºå¦‚ä½•åˆ›å»ºä¸€ä¸ªnode.jsé¡¹ç›®æˆ‘å°±ä¸è¯¦ç»†è¯´ï¼Œé€šå¸¸é€šè¿‡npm initå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªnode.jsé¡¹ç›®äº†ã€‚<br>å…³äºnode.jsé¡¹ç›®è¯¦ç»†æ•™ç¨‹ï¼Œå¯ä»¥å‚è€ƒè¯¥ç¯‡æ–‡ç« <a href="https://www.jianshu.com/p/7b0a5d4491ba" target="_blank" rel="noopener">nodeJSå…¥é—¨â€”â€”æ–°å»ºä¸€ä¸ªé¡¹ç›®åŠä»£ç è¯¦è§£</a><br>å½“ç„¶äº†ï¼Œå¦‚æœä½ æ˜¯ç›´æ¥é€šè¿‡è¿™ç¯‡æ–‡ç« æ“ä½œï¼Œæœ€å…ˆå¯èƒ½ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&apos;express&apos; ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº</span><br><span class="line">æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>
<p>è§£å†³æ–¹å¼å¾ˆç®€å•ï¼Œå¹¶ä¸æ˜¯npm install -g expresså°±å¯ä»¥çš„ï¼Œåœ¨æ­¤ä¹‹å‰è¿˜éœ€æ‰§è¡Œnpm install -g express-generator</p>
<p>è¿™æ¡å‘½ä»¤å¾ˆå¥½ç†è§£ï¼Œä½ å¯ä»¥å°†å…¶ç†è§£ä¸ºä½ çš„expressæ¡†æ¶ç”Ÿæˆå™¨ï¼Œä»¥Javaä¸­Mavenæ¥è¯´ï¼Œé€šå¸¸ideå°±æŠŠmavenç»“æ„éƒ½å¼„å¥½äº†ï¼Œä½ åªéœ€åœ¨åˆ›å»ºé¡¹ç›®çš„æ—¶å€™ï¼Œå‹¾é€‰mavenå³å¯ï¼Œå®ƒä¼šè‡ªå·±å°†æ‰€æœ‰ç›¸å…³é¡¹ç›®åŒ…æ‹¬é…ç½®æ–‡ä»¶ä¸€èµ·ç”Ÿæˆã€‚</p>
<p>è™½ç„¶è¯´æˆ‘å°†åœ°å€è´´å‡ºæ¥ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿˜æ˜¯å®é™…æ“ä½œä¸€éï¼Œè¿™æ ·å¯¹æ­¤æœ‰ä¸€ä¸ªæ„Ÿæ€§è®¤è¯†(åˆå­¦ç¼–ç¨‹çš„äººæˆ–è€…æ˜¯å·²ç»æœ‰ç¼–ç¨‹ç»éªŒçš„äººï¼Œæ˜¯ç»å¯¹ä¸èƒ½å¿½ç•¥è¿™ä¸€ç‚¹çš„)ã€‚</p>
<p>æµç¨‹å¦‚ä¸‹:</p>
<h4><span id="aä½¿ç”¨expresså‘½ä»¤åˆ›å»ºexpressé¡¹ç›®">a.ä½¿ç”¨expresså‘½ä»¤åˆ›å»ºexpressé¡¹ç›®</span></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">express blog</span><br></pre></td></tr></table></figure>
<h5><span id="æ•ˆæœå›¾å¦‚ä¸‹">æ•ˆæœå›¾å¦‚ä¸‹:</span></h5><p><img src="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /express01.png" alt=""></p>
<p>expresséå¸¸æœ‰äººæ€§åŒ–ï¼Œå·²ç»å‘Šè¯‰ä½ æ€ä¹ˆè¿›å…¥blogé¡¹ç›®åŠå…¶å®‰è£…ç›¸å…³çš„åº“ä¾èµ–å’Œå¯åŠ¨äº†ï¼Œä½ åªéœ€æŒ‰ç…§å®ƒçš„è¿™ä¸ªæ­¥éª¤ï¼Œä¸€æ­¥ä¸€æ­¥æ¥å°±è¡Œäº†ã€‚</p>
<h4><span id="bç›®å½•ç»“æ„åˆ†æ">b.ç›®å½•ç»“æ„åˆ†æ</span></h4><h5><span id="ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤º">ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤º:</span></h5><p><img src="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /express02.png" alt=""><br>app.js:â€”â€”å¯åŠ¨æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä¸»æ–‡ä»¶å…¥å£ã€‚<br>package.jsonâ€”â€”å®šä¹‰äº†è¿™ä¸ªé¡¹ç›®æ‰€éœ€è¦çš„å„ç§æ¨¡å—ï¼Œä»¥åŠé¡¹ç›®çš„é…ç½®ä¿¡æ¯ï¼ˆæ¯”å¦‚åç§°ã€ç‰ˆæœ¬ã€è®¸å¯è¯ç­‰å…ƒæ•°æ®ï¼‰ã€‚npm installå‘½ä»¤æ ¹æ®è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œè‡ªåŠ¨ä¸‹è½½æ‰€éœ€çš„æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯é…ç½®é¡¹ç›®æ‰€éœ€çš„è¿è¡Œå’Œå¼€å‘ç¯å¢ƒã€‚<br>node_modulesâ€”â€”å­˜æ”¾package.jsonä¸­å®‰è£…çš„æ¨¡å—ï¼Œå½“ä½ åœ¨package.jsonæ·»åŠ ä¾èµ–çš„æ¨¡å—å¹¶å®‰è£…åï¼Œå­˜æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹<br>publicâ€”â€”å­˜æ”¾imageã€cssã€jsç­‰æ–‡ä»¶<br>routesâ€”â€”å­˜æ”¾è·¯ç”±æ–‡ä»¶<br>viewsâ€”â€”å­˜æ”¾è§†å›¾æ–‡ä»¶æˆ–è€…è¯´æ¨¡æ¿æ–‡ä»¶<br>binâ€”â€”å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶</p>
<h2><span id="2ä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ">2.ä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ </span></h2><p>æ³¨æ„ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤º(æˆ‘ä¸»è¦æ˜¯å¤ç”¨æœ€è¿‘ç ”ç©¶çš„mock-github-api):<br><img src="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /express03.png" alt=""></p>
<h4><span id="aå‡†å¤‡htmlæ–‡ä»¶">a.å‡†å¤‡htmlæ–‡ä»¶</span></h4><p>publicæ–‡ä»¶å¤¹ä¸»è¦æ”¾ç½®é™æ€æ–‡ä»¶ï¼Œå¦‚index.html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;æ–‡ä»¶ä¸Šä¼ ï¼š&lt;/h3&gt;</span><br><span class="line">    é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ : &lt;br /&gt;</span><br><span class="line">    &lt;form action=&quot;/gists&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; name=&quot;content&quot; /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ æ–‡ä»¶&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h4><span id="bç¼–å†™ç›¸å…³çš„js">b.ç¼–å†™ç›¸å…³çš„js</span></h4><p>åƒupload.jså±äºè·¯ç”±ï¼Œé€šå¸¸æ”¾ç½®åœ¨routesæ–‡ä»¶å¤¹ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(&apos;fs&apos;);</span><br><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line">var multer  = require(&apos;multer&apos;);</span><br><span class="line">var path = require(&apos;path&apos;);</span><br><span class="line">var router = express.Router();</span><br><span class="line"></span><br><span class="line">var upload = multer(&#123;dest: &apos;upload_tmp/&apos;&#125;);</span><br><span class="line"></span><br><span class="line">router.post(&apos;/&apos;, upload.any(), function(req, res, next) &#123;</span><br><span class="line">    console.log(req.files[0]);  // ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">    var des_file = &quot;./upload/&quot; + req.files[0].originalname;</span><br><span class="line">    fs.readFile( req.files[0].path, function (err, data) &#123;</span><br><span class="line">        fs.writeFile(des_file, data, function (err) &#123;</span><br><span class="line">            if( err )&#123;</span><br><span class="line">                console.log( err );</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                response = &#123;</span><br><span class="line">                    message:&apos;File uploaded successfully&apos;,</span><br><span class="line">                    filename:req.files[0].originalname</span><br><span class="line">                &#125;;</span><br><span class="line">                console.log( response );</span><br><span class="line">                res.end( JSON.stringify( response ) );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">module.exports = router;</span><br></pre></td></tr></table></figure></p>
<h4><span id="cä¸Šä¼ æ–‡ä»¶åŠå…¶æ•ˆæœ">c.ä¸Šä¼ æ–‡ä»¶åŠå…¶æ•ˆæœ</span></h4><h5><span id="é¡µé¢å›¾">é¡µé¢å›¾:</span></h5><p><img src="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /express04.png" alt=""></p>
<h5><span id="ä¸Šä¼ æˆåŠŸæ˜¾ç¤ºå›¾">ä¸Šä¼ æˆåŠŸæ˜¾ç¤ºå›¾:</span></h5><p><img src="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /express05.png" alt=""></p>
<h5><span id="uploadæ–‡ä»¶å¤¹ä¸‹ä¼šæœ‰å¯¹åº”çš„æ–‡ä»¶ä¹Ÿå°±æ˜¯ä½ åˆšåˆšé€šè¿‡é¡µé¢ä¸Šä¼ çš„æ–‡ä»¶">uploadæ–‡ä»¶å¤¹ä¸‹ä¼šæœ‰å¯¹åº”çš„æ–‡ä»¶(ä¹Ÿå°±æ˜¯ä½ åˆšåˆšé€šè¿‡é¡µé¢ä¸Šä¼ çš„æ–‡ä»¶)</span></h5><p><img src="/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /express06.png" alt=""></p>
<p>æœ€åä¾‹å­ä¸­è¿˜æœ‰é˜¿é‡Œäº‘å’Œè…¾è®¯äº‘çš„å›¾ç‰‡å­˜å‚¨ï¼Œå¤§å®¶å¯ä»¥åšä¸€ä¸ªå‚è€ƒã€‚</p>
<p>æºç åœ°å€ä¸º:<a href="https://github.com/developers-youcong/mock-github-api" target="_blank" rel="noopener">https://github.com/developers-youcong/mock-github-api</a></p>
<p>å¸Œæœ›èƒ½å¤Ÿå¯¹å¤§å®¶æœ‰æ‰€å¯å‘å’Œå¸®åŠ©</p>
<p>æ³¨æ„ï¼Œå¯èƒ½é‡åˆ°çš„é—®é¢˜:</p>
<p>é—®é¢˜ä¸€:é™æ€èµ„æºéœ€è¦æ”¾è¡Œï¼Œå¦åˆ™æ— æ³•è®¿é—®<br>åœ¨index.jsè¡¥å……è¿™æ®µä»£ç å³å¯è§£å†³è¿™ä¸ªé—®é¢˜<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.use(express.static(path.join(__dirname, &apos;public&apos;)))</span><br></pre></td></tr></table></figure></p>
<p>é—®é¢˜äºŒ:socket hang up</p>
<p>æˆ‘å°†var bodyParser = require(â€˜body-parserâ€™)å»é™¤å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜</p>
<p>å‚è€ƒé“¾æ¥å¦‚:<a href="https://blog.csdn.net/gsying1474/article/details/52200445" target="_blank" rel="noopener">https://blog.csdn.net/gsying1474/article/details/52200445</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/03/01/node-jsä½¿ç”¨expressæ¡†æ¶è¿›è¡Œæ–‡ä»¶ä¸Šä¼ /" data-id="cju836j32002dw8vkka1wauy6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-nginxè®©æ‰€æœ‰çš„httpåœ°å€é‡å®šå‘åˆ°https" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/01/nginxè®©æ‰€æœ‰çš„httpåœ°å€é‡å®šå‘åˆ°https/" class="article-date">
  <time datetime="2019-03-01T12:28:22.000Z" itemprop="datePublished">2019-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/01/nginxè®©æ‰€æœ‰çš„httpåœ°å€é‡å®šå‘åˆ°https/">nginxè®©æ‰€æœ‰çš„httpåœ°å€é‡å®šå‘åˆ°https</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>é—®:ä¸ºä»€ä¹ˆè®©æ‰€æœ‰çš„httpéƒ½é‡å®šå‘åˆ°httpså‘¢ï¼Ÿ<br>ç­”:å› ä¸ºè¿™æ ·ä¼šä½¿ç½‘ç«™æ›´å®‰å…¨äº›ã€‚</p>
<p>é‚£ä¹ˆæˆ‘æ˜¯å¦‚ä½•åœ¨nginxé…ç½®ï¼Œè®©è¾“å…¥<a href="http://www.youcongtech.comæˆ–è€…youcongtech.comå…¨éƒ¨éƒ½é‡å®šå‘åˆ°https://www.youcongtech.comçš„å‘¢ï¼Ÿ" target="_blank" rel="noopener">http://www.youcongtech.comæˆ–è€…youcongtech.comå…¨éƒ¨éƒ½é‡å®šå‘åˆ°https://www.youcongtech.comçš„å‘¢ï¼Ÿ</a><br>å…¶å®æˆ‘ä»…ä»…åªæ˜¯åœ¨nginx.confé…ç½®æ–‡ä»¶ä¸­çš„serveré…ç½®äº†å¦‚ä¸‹:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rewrite ^(.*)$  https://$host$1 permanent;</span><br></pre></td></tr></table></figure></p>
<p>è¿™æ®µé…ç½®çš„å«ä¹‰å°†æ‰€æœ‰çš„httpè¯·æ±‚é€šè¿‡rewriteé‡å†™åˆ°httpsä¸Šã€‚</p>
<p>ä¸‹é¢è´´ä¸€ä¸‹æˆ‘çš„nginx.confé…ç½®æ–‡ä»¶(ä¸»è¦é‡è¦çš„):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"> upstream  www.youcongtech.com&#123;</span><br><span class="line">         server   39.107.110.227:2019;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"> server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  www.youcongtech.com;</span><br><span class="line">        rewrite ^(.*)$  https://$host$1 permanent;</span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location ~ / &#123;</span><br><span class="line">            root /usr/local/nginx/html;</span><br><span class="line">            index index.html index.htm;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">      error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name www.youcongtech.com;</span><br><span class="line">        ssl on;</span><br><span class="line">        index index.html;</span><br><span class="line">        ssl_certificate /usr/local/nginx/cert/18540291_www.youcongtech.com.pem;</span><br><span class="line">        ssl_certificate_key /usr/local/nginx/cert/18540291_www.youcongtech.com.key;</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_set_header X-Forwarded-Host $host;</span><br><span class="line">                proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">                proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                proxy_set_header Host $http_host;</span><br><span class="line">                proxy_redirect off;</span><br><span class="line">                expires off;</span><br><span class="line">                sendfile off;</span><br><span class="line">                proxy_pass http://www.youcongtech.com;</span><br><span class="line">                root /usr/local/nginx/html;</span><br><span class="line">                index index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    	location ~ ^/blog/(.*)&#123;</span><br><span class="line">                 proxy_set_header Host $host;</span><br><span class="line">                 proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                 proxy_pass http://www.youcongtech.com;    #è½¬å‘tomcatå¤„ç†</span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢å‚æ•°åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼ŒåŠ æˆ–è€…ä¸åŠ åˆ°åº•ä¼šæ€ä¹ˆæ ·ï¼Œå…³äºnginxå‚æ•°è¯¦è§£å’Œæ›´å¥½çš„ä¼˜åŒ–ï¼Œåç»­ä¼šæœ‰è¯¦ç»†çš„è®²è§£ï¼Œæˆ‘ä¼šç»§ç»­ç¼–å†™æˆ‘çš„åšå®¢ç³»ç»Ÿï¼Œå¹¶ä»¥æ­¤ä½œä¸ºæ¡ˆä¾‹ã€‚<br>å½“ç„¶äº†ï¼Œå¦‚æœå…¬å¸æ¶‰åŠè¿™å—æ¯”è¾ƒå¤šï¼Œåç»­æˆ‘ä¹Ÿä¼šä»¥å…¬å¸æ¡ˆä¾‹æ¥ç»™å¤§å®¶è®²è§£ã€‚</p>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒè¯¥åœ°å€:<a href="https://www.cnblogs.com/kevingrace/p/6187072.html" target="_blank" rel="noopener">https://www.cnblogs.com/kevingrace/p/6187072.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/03/01/nginxè®©æ‰€æœ‰çš„httpåœ°å€é‡å®šå‘åˆ°https/" data-id="cju836j2l001yw8vkmke15chp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/">Nginx</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-nginxé…ç½®https" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/26/nginxé…ç½®https/" class="article-date">
  <time datetime="2019-02-26T12:06:25.000Z" itemprop="datePublished">2019-02-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/26/nginxé…ç½®https/">nginxé…ç½®https</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å…¶å®nginxé…ç½®ä¹Ÿå·®ä¸å¤ªå¤šï¼Œè™½ç„¶å·®ä¸å¤ªå¤šï¼Œä½†è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p>
<p>å‡å®šä½ å·²ç»åœ¨é˜¿é‡Œäº‘å®Œæˆäº†è¯ä¹¦ç”³è¯·ï¼Œæ¥ä¸‹æ¥ä½ å°±å¯ä»¥æŒ‰ç…§å¦‚ä¸‹é…ç½®(ä¸»è¦æ˜¯ä¿®æ”¹nginx.confæ–‡ä»¶)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name www.youcongtech.com;</span><br><span class="line">        ssl on;</span><br><span class="line">        index index.html;</span><br><span class="line">        ssl_certificate /usr/local/nginx/cert/1854029_www.youcongtech.com.pem;</span><br><span class="line">        ssl_certificate_key /usr/local/nginx/cert/1854029_www.youcongtech.com.key;</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                proxy_set_header X-Forwarded-Host $host;</span><br><span class="line">                proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">                proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                proxy_set_header Host $http_host;</span><br><span class="line">                proxy_redirect off;</span><br><span class="line">                expires off;</span><br><span class="line">                sendfile off;</span><br><span class="line">                proxy_pass http://www.youcongtech.com;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æŒ‰ç…§è¿™æ ·é…ç½®ä½ ä¸ä¸€å®šæˆåŠŸï¼Œå¯èƒ½ä¼šé‡è§ä¸‹é¢çš„å‡ ä¸ªé”™è¯¯ï¼Ÿ</p>
<h2><span id="é”™è¯¯1">é”™è¯¯1</span></h2><p>é”™è¯¯ä¿¡æ¯:ubuntu error: SSL modules require the OpenSSL library.</p>
<p>è§£å†³åŠæ³•:<br>æ‰§è¡Œè¯¥å‘½ä»¤å³å¯è§£å†³:sudo apt-get install openssl libssl-dev<br>å‚è€ƒé“¾æ¥ä¸º:<a href="https://yq.aliyun.com/articles/486172" target="_blank" rel="noopener">https://yq.aliyun.com/articles/486172</a></p>
<h2><span id="é”™è¯¯2">é”™è¯¯2</span></h2><p>é”™è¯¯ä¿¡æ¯:nginx: [emerg] unknown directive â€œsslâ€ in /usr/local/nginx/conf/nginx.conf:188</p>
<p>è§£å†³åŠæ³•:<br>åœ¨Nginxè§£å‹ç›®å½•æ‰§è¡Œè¯¥å‘½ä»¤:./configure â€“with-http_ssl_module</p>
<p>å‚è€ƒé“¾æ¥ä¸º:<a href="https://blog.csdn.net/weiyangdong/article/details/80008543" target="_blank" rel="noopener">https://blog.csdn.net/weiyangdong/article/details/80008543</a></p>
<p>å¦‚æœä½ å¯¹æ­¤è¿˜æœ‰ç–‘é—®çš„è¯ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªé“¾æ¥:<a href="https://www.cnblogs.com/tianhei/p/7726505.html" target="_blank" rel="noopener">https://www.cnblogs.com/tianhei/p/7726505.html</a><br>è¿™ä¸ªé“¾æ¥ä¼šè®²å¦‚ä½•ç”³è¯·è¯ä¹¦åˆ°é…ç½®httpsæˆåŠŸã€‚</p>
<p>æœ€ååœ¨æµè§ˆå™¨è¾“å…¥:<a href="https://www.youcongtech.com" target="_blank" rel="noopener">https://www.youcongtech.com</a> ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªåšå®¢ç•Œé¢æˆ–è€…æ˜¯ä¸€ä¸ªNginxæ¬¢è¿é¡µã€‚<br>å½“ç„¶äº†ï¼Œç›®å‰æˆ‘çš„é˜¿é‡Œäº‘åŸŸåå°šåœ¨è®¤è¯ä¸­ï¼Œè¿‡æ®µæ—¶é—´å°±å¯ä»¥ç”³è¯·ä¸‹æ¥äº†ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/02/26/nginxé…ç½®https/" data-id="cju836j2v0023w8vknx05rubn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx/">Nginx</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-vscodeæºç ç¼–è¯‘è¿è¡Œæ‰“åŒ…ä½¿å…¶ç”±è‹±æ–‡å˜ä¸ºä¸­æ–‡" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/25/vscodeæºç ç¼–è¯‘è¿è¡Œæ‰“åŒ…ä½¿å…¶ç”±è‹±æ–‡å˜ä¸ºä¸­æ–‡/" class="article-date">
  <time datetime="2019-02-25T11:46:07.000Z" itemprop="datePublished">2019-02-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/25/vscodeæºç ç¼–è¯‘è¿è¡Œæ‰“åŒ…ä½¿å…¶ç”±è‹±æ–‡å˜ä¸ºä¸­æ–‡/">vscodeæºç ç¼–è¯‘è¿è¡Œæ‰“åŒ…ä½¿å…¶ç”±è‹±æ–‡å˜ä¸ºä¸­æ–‡</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>vscodeé»˜è®¤æ˜¯è‹±æ–‡ï¼Œå¦‚æœä½ æƒ³è®©å…¶å˜ä¸ºä¸­æ–‡ï¼Œå¯å‚è€ƒè¿™ä¸ªé“¾æ¥:<a href="https://blog.csdn.net/testcs_dn/article/details/75070415" target="_blank" rel="noopener">https://blog.csdn.net/testcs_dn/article/details/75070415</a></p>
<p>æœ€è¿‘å‘ç°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼Œvscodeæ‰“åŒ…å‰å’Œæ‰“åŒ…åå­˜åœ¨å¾ˆå¤§çš„ä¸åŒçš„ï¼Œæ­£å¸¸æ¥è¯´ï¼Œæ¯”å¦‚æˆ‘ä»¬å¼€å‘é¡¹ç›®ï¼Œå®é™…ä¸Šæ¥è¯´ï¼Œæœ¬åœ°æ€ä¹ˆæ ·ï¼Œçº¿ä¸Šå°±æ€ä¹ˆæ ·ï¼Œå½“ç„¶äº†ï¼Œä¹Ÿä¸æ’é™¤ä¸€äº›çº¿ä¸Šå¯¼è‡´çš„bugã€‚</p>
<p>æ¯”å¦‚vscodeæºç å·²ç»å¯ç”¨äº†ä¸­æ–‡è¯­è¨€åŒ…æ’ä»¶ï¼ŒåŒæ—¶ä¹Ÿä¿®æ”¹äº†locale.jsonæ–‡ä»¶(å°†æ–‡ä»¶ä¸­çš„enæ”¹ä¸ºzh-CN)ï¼Œä½†æ˜¯è¿˜æ˜¯æ˜¯è‹±æ–‡ï¼Œåæ¥æˆ‘è½¬å¿µä¸€æƒ³ï¼Œå°†è¿™ä¸ªä¸­æ–‡è¯­è¨€åŒ…å¼„åˆ°æ‰“åŒ…å¥½çš„æ’ä»¶æ”¾ç½®å¤„ï¼Œæœ€åå‘ç°å±…ç„¶å¯ä»¥äº†ã€‚</p>
<p>å½“ç„¶äº†ï¼Œä¹Ÿå­˜åœ¨ä¸€ç‚¹é—®é¢˜ï¼Œé—®é¢˜æ˜¯ç»å¤§éƒ¨åˆ†å¯ä»¥ç¿»è¯‘ä¸ºä¸­æ–‡ï¼Œå°‘éƒ¨åˆ†è¿˜æ˜¯è‹±æ–‡ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/02/25/vscodeæºç ç¼–è¯‘è¿è¡Œæ‰“åŒ…ä½¿å…¶ç”±è‹±æ–‡å˜ä¸ºä¸­æ–‡/" data-id="cju836j3o0037w8vk479fn5pt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VsCode/">VsCode</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-é˜¿é‡Œäº‘é…ç½®tomcat-https" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/25/é˜¿é‡Œäº‘é…ç½®tomcat-https/" class="article-date">
  <time datetime="2019-02-25T11:22:15.000Z" itemprop="datePublished">2019-02-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/25/é˜¿é‡Œäº‘é…ç½®tomcat-https/">é˜¿é‡Œäº‘é…ç½®tomcat https</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>é˜¿é‡Œäº‘ç”³è¯·å…è´¹çš„SSLè¯ä¹¦å’Œé…ç½®httpsï¼Œå¯å‚è€ƒè¯¥ç¯‡åšæ–‡:<a href="https://blog.csdn.net/baidu_19473529/article/details/70037976" target="_blank" rel="noopener">https://blog.csdn.net/baidu_19473529/article/details/70037976</a></p>
<p>è™½ç„¶æœ‰ç°æˆçš„ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯è¦åšä¸€ä¸ªå°å°çš„æ€»ç»“è®°å½•ä¸€ä¸‹ã€‚</p>
<p>ç”±äºæˆ‘å…¬å¸ä½¿ç”¨çš„tomcatä¸»è¦æ˜¯8.5,æ‰€ä»¥æˆ‘ä»¥8.5é…ç½®ä½œä¸ºè®²è§£(æ€»çš„æ¥è¯´ï¼Œé…ç½®ç›¸å·®ä¸å¤§)</p>
<p>å‡å®šä½ å·²ç»åœ¨é˜¿é‡Œäº‘æˆåŠŸç”³è¯·åˆ°å…è´¹çš„SSLè¯ä¹¦ï¼Œç°åœ¨æˆ‘ä»¬å¼€å§‹æ¥é…ç½®ã€‚</p>
<h2><span id="1é¦–å…ˆè®²pfxæ–‡ä»¶æ”¾åœ¨tomcatçš„ä¸€ä¸ªå«certçš„æ–‡ä»¶å¤¹tomcatå®é™…ä¸Šæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å¤¹ä½ å¯ä»¥é€‰æ‹©æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª">1.é¦–å…ˆè®²pfxæ–‡ä»¶æ”¾åœ¨tomcatçš„ä¸€ä¸ªå«certçš„æ–‡ä»¶å¤¹(tomcatå®é™…ä¸Šæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œä½ å¯ä»¥é€‰æ‹©æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª)</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd tomcat8</span><br><span class="line">mkdir cert</span><br></pre></td></tr></table></figure>
<h2><span id="2ä¿®æ”¹serverxml">2.ä¿®æ”¹server.xml</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;Connector port=&quot;443&quot; protocol=&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â maxThreads=&quot;150&quot; SSLEnabled=&quot;true&quot; Â scheme=&quot;https&quot;</span><br><span class="line">Â  Â  secure=&quot;true&quot;</span><br><span class="line">Â Â  Â Â Â  Â Â Â  Â  Â  &gt;</span><br><span class="line">Â  Â  Â  Â  &lt;SSLHostConfig&gt;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â &lt;Certificate certificateKeystoreFile=&quot;cert/test.pfx&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â certificateKeystoreType=&quot;PKCS12&quot; certificateKeystorePassword=&quot;1541231341210&quot; /&gt;</span><br><span class="line">Â  Â  Â  Â  &lt;/SSLHostConfig&gt;</span><br><span class="line">Â  Â  &lt;/Connector&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &lt;Connector port=&quot;80&quot; protocol=&quot;HTTP/1.1&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â connectionTimeout=&quot;20000&quot;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â redirectPort=&quot;443&quot; /&gt;</span><br><span class="line"></span><br><span class="line">Â    &lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;443&quot; /&gt;</span><br></pre></td></tr></table></figure>
<h2><span id="3ä¿®æ”¹webxml">3.ä¿®æ”¹web.xml</span></h2><p>ç¼–è¾‘web.xmlï¼Œä¸åŠ ä¸‹é¢è¿™æ®µçš„è¯ä¸èƒ½æŠŠhttpè¯·æ±‚è½¬ä¸ºhttps<br>åœ¨è¯¥æ–‡ä»¶æ ‡ç­¾ï¼ˆä¸€èˆ¬åœ¨æ–‡ä»¶æœ€æœ«å°¾ï¼‰åé¢åŠ ä¸Šè¿™æ ·ä¸€æ®µï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;login-config&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;!-- Authorization setting for SSL --&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;auth-method&gt;CLIENT-CERT&lt;/auth-method&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;realm-name&gt;Client Cert Users-only Area&lt;/realm-name&gt;Â Â </span><br><span class="line">&lt;/login-config&gt;Â Â </span><br><span class="line">&lt;security-constraint&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;!-- Authorization setting for SSL --&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;web-resource-collection &gt;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &lt;web-resource-name &gt;SSL&lt;/web-resource-name&gt;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &lt;url-pattern&gt;/*&lt;/url-pattern&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;/web-resource-collection&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;user-data-constraint&gt;Â Â </span><br><span class="line">Â Â Â Â Â Â Â Â &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;Â Â </span><br><span class="line">Â Â Â Â &lt;/user-data-constraint&gt;Â Â </span><br><span class="line">&lt;/security-constraint&gt;</span><br></pre></td></tr></table></figure></p>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒè¯¥ç¯‡åšæ–‡<a href="https://blog.csdn.net/qq_35624642/article/details/83016813" target="_blank" rel="noopener">Tomcat8ã€9é…ç½®https SSLè¯ä¹¦ é˜¿é‡Œäº‘çš„å…è´¹dvè¯ä¹¦</a></p>
<p>å¦å¤–ä¸ºäº†è°ƒè¯•æ–¹ä¾¿ï¼Œæœ¬åœ°tomcatè¿˜éœ€é…ç½®https,å…³äºwindownsé…ç½®httpsï¼Œå¯å‚è€ƒè¯¥ç¯‡åšæ–‡<a href="https://blog.csdn.net/u014793522/article/details/54846973" target="_blank" rel="noopener">æœ¬åœ°windowsæ­å»ºhttps</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/02/25/é˜¿é‡Œäº‘é…ç½®tomcat-https/" data-id="cju836j4s0048w8vkvjc89qhr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-springbootæ‰“æˆçš„jaråŒ…å¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œ" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/23/springbootæ‰“æˆçš„jaråŒ…å¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œ/" class="article-date">
  <time datetime="2019-02-23T09:16:10.000Z" itemprop="datePublished">2019-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/23/springbootæ‰“æˆçš„jaråŒ…å¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œ/">springbootæ‰“æˆçš„jaråŒ…å¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <a id="more"></a>
<h2><span id="ä¸€-é¦–å…ˆè¯´è¯´åœ¨æ²¡æœ‰springbootçš„æ—¶å€™é¡¹ç›®æ˜¯å¦‚ä½•éƒ¨ç½²çš„">ä¸€ã€é¦–å…ˆè¯´è¯´åœ¨æ²¡æœ‰springbootçš„æ—¶å€™ï¼Œé¡¹ç›®æ˜¯å¦‚ä½•éƒ¨ç½²çš„ï¼Ÿ</span></h2><h4><span id="1åŠ¨æ€webé¡¹ç›®">1.åŠ¨æ€webé¡¹ç›®</span></h4><p>åŠ¨æ€webé¡¹ç›®éƒ¨ç½²å¾ˆæ–¹ä¾¿ï¼ŒåŸºæœ¬ä¸Šä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨çš„tomcaté‡Œé¢çš„webappsæ–‡ä»¶å¤¹ä¸‹å³å¯å®Œæˆéƒ¨ç½²ã€‚<br>å½“ç„¶äº†ï¼Œè¿™ç§åšæ³•çš„å¼Šç«¯æ˜¯ï¼Œå¦‚æœæ˜¯é€šè¿‡winscpæ¥ä¼ è¾“å¯¹äºç½‘é€Ÿæ–¹é¢è¦æ±‚ä¸¥æ ¼ï¼Œä¸ç„¶çš„è¯ç½‘é€Ÿä¸€å¡ï¼Œå¾ˆä¹…ä¼ ä¸è¿‡å»ï¼Œå¾ˆè€½è¯¯æ—¶é—´çš„ï¼Œå½“ç„¶äº†ï¼Œæˆ‘ä¸€ä¸ªåŒå­¦ä»–ä»¬å…¬å¸ç”¨çš„å°±æ˜¯åŠ¨æ€webé¡¹ç›®ï¼Œéƒ¨ç½²çš„æ–¹å¼ä¹Ÿæ­£æ˜¯é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œæ®è¯´æ˜¯å…¬å¸åˆ¶åº¦å®šä¸‹çš„ã€‚åŸå› æˆ‘å°±æ²¡æœ‰ç»†é—®è¿‡ä»–ã€‚</p>
<p>å½“ç„¶äº†ï¼Œæœ‰äººä¼šè¯´ï¼Œé‚£æˆ‘ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¹‹å‰å°†å…¶å‹ç¼©æˆä¸€ä¸ªzipåŒ…ï¼Œç„¶ååœ¨Linuxé€šè¿‡unzipå‘½ä»¤è§£å‹ã€‚è¿™ç§æ–¹å¼æˆ‘ä»¥å‰ä¹Ÿè¿™ä¹ˆå¹²è¿‡ã€‚<br>å½“æˆ‘åæ¥å‘ç°å°†åŠ¨æ€webé¡¹ç›®å¯¼å‡ºwaråŒ…ï¼Œç›´æ¥é€šè¿‡winscpä¸Šä¼ åˆ°tomcatå¯¹åº”çš„ç›®å½•ä¸‹ï¼Œåœ¨å½“å‰ç›®å½•å°±ä¼šäº§ç”Ÿä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸»è¦æ˜¯webç›¸å…³çš„èµ„æºï¼Œè¿˜æœ‰å°±æ˜¯javaäº§ç”Ÿçš„ç¼–è¯‘æ–‡ä»¶classç­‰ã€‚</p>
<p>ç”±æ­¤å¯ä»¥æ¨å‡ºåŠ¨æ€webé¡¹ç›®å¸¸è§„éƒ¨ç½²æ–¹å¼æœ‰è¿™ä¹ˆå‡ ç§?<br>a.ç›´æ¥ä¸Šä¼ åˆ°tomcatå¯¹åº”çš„ç›®å½•ä¸‹;<br>b.å…ˆæ‰“æˆzipåŒ…ç„¶åå†ä¼ è¾“åˆ°tomcatå¯¹åº”çš„ç›®å½•ä¸‹;<br>c.æœ¬åœ°å¯¼å‡ºwaråŒ…ï¼Œç„¶ååœ¨ä¼ è¾“åˆ°tomcatå¯¹åº”çš„ç›®å½•ä¸‹;</p>
<p>å…¶å®aå’Œbæ˜¯ä¸€æ ·çš„ï¼Œcåˆ™æ˜¯åˆ©ç”¨Eclipseçš„å¯¼å‡ºwaråŠŸèƒ½æ¥å®ç°çš„ã€‚</p>
<h4><span id="2mavené¡¹ç›®">2.mavené¡¹ç›®</span></h4><p>mavené¡¹ç›®çš„éƒ¨ç½²ä»¥waré¡¹ç›®ä¸ºä¾‹ï¼Œç›´æ¥é€šè¿‡mvn install æˆ–è€…mvn clean packageç›´æ¥æ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œå°±å³å¯å®Œæˆéƒ¨ç½²ã€‚<br>å½“ç„¶äº†ï¼Œè¿˜å¯ä»¥é€šè¿‡å†™ä¸€ä¸ªè„šæœ¬åˆ©ç”¨git cloneçš„ç‰¹æ€§åŠ ä¸Šmavenï¼Œä¹Ÿå¯ä»¥å®Œæˆå¿«é€Ÿéƒ¨ç½²</p>
<p>æ¥ä¸ªå°ç»“:<br>ç°åœ¨ä½¿ç”¨åŠ¨æ€webé¡¹ç›®éƒ½æ˜¯ä¸€äº›è€å…¬å¸ç»´æŠ¤ä¸€äº›è€çš„é¡¹ç›®ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œç°åœ¨å¤§éƒ¨åˆ†éƒ½åœ¨ç”¨mavneï¼Œå½“ç„¶ï¼Œä¹Ÿä¸æ’é™¤æœ‰ä¸€éƒ¨åˆ†ç”¨grandleæˆ–antç­‰ã€‚<br>å…¶å®å‘ç°ç”¨mavenä»¥åé™¤äº†æœ‰äº›æ—¶å€™å¯¼å…¥ä¾èµ–(ä¾èµ–ä¹‹é—´å› ç‰ˆæœ¬å†²çªé—®é¢˜ï¼Œä¸ºæ­¤æˆ‘æ„Ÿåˆ°çƒ¦ä¹‹å¤–ï¼Œå…¶å®ƒéƒ½è¿˜å¥½)ã€‚</p>
<p>è¯´å®Œè¿™ä¸¤ç§é¡¹ç›®éƒ¨ç½²åï¼Œä¸‹é¢æˆ‘å†è¯´springbootæ‰“åŒ…æˆjarï¼Œå¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œã€‚</p>
<h2><span id="äºŒ-springbootæ‰“æˆçš„jarå¦‚ä½•åœ¨linuxä¸ŠæŒä¹…è¿è¡Œ">äºŒã€springbootæ‰“æˆçš„jarå¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œ</span></h2><p>é¦–å…ˆå‘¢ï¼Ÿä½ æœ¬åœ°è¦æœ‰ä¸€ä¸ªspringbootçš„é¡¹ç›®ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡åšå®¢å†™ä¸€ä¸ª,<a href="https://www.cnblogs.com/youcong/p/8098861.html" target="_blank" rel="noopener">springbootå…¥é—¨ç¨‹åº</a></p>
<p>ç„¶åå‘¢ï¼Ÿä½ è¦æœ‰ä¸€ä¸ªè™šæ‹Ÿæœºæ­å»ºä¸€ä¸ªLinuxæœåŠ¡å™¨æˆ–è€…æ˜¯è¿œç¨‹æœåŠ¡å™¨(é˜¿é‡Œäº‘æˆ–è€…è…¾è®¯äº‘ã€ç™¾åº¦äº‘ã€ç¾å›¢äº‘ç­‰)ã€‚</p>
<p>å†ç„¶åï¼Œä½ è¿˜è¦æœ‰ä¸€ä¸ªwinscpï¼Œwinscpå®˜ç½‘åœ°å€ä¸º:<a href="https://winscp.net/eng/docs/lang:chs(ä½ å¯ä»¥å»å®˜ç½‘ä¸‹è½½)" target="_blank" rel="noopener">https://winscp.net/eng/docs/lang:chs(ä½ å¯ä»¥å»å®˜ç½‘ä¸‹è½½)</a></p>
<p>æœ€åå°†springbootæ‰“åŒ…(ç¡®ä¿æœ¬åœ°è¿è¡Œæ²¡æœ‰é—®é¢˜)ï¼Œåˆ©ç”¨winscpä¸Šä¼ åˆ°Linuxä¸Šã€‚</p>
<p>é€šè¿‡è¯¥å‘½ä»¤è¿è¡ŒjaråŒ…:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar blog.jar &gt; system.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></p>
<p>ä¼šåœ¨æœ¬åœ°æœ‰ä¸€ä¸ªsystem.logæ–‡ä»¶äº§ç”Ÿï¼Œé€šè¿‡è¯¥æ–‡ä»¶ä½ å¯ä»¥çœ‹åˆ°å¯¹åº”çš„æ—¥å¿—è¾“å‡ºã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å¯¹è¿™æ¡å‘½ä»¤è¿›è¡Œåˆ†æ</p>
<p>nohubä¸€èˆ¬å½¢å¼ä¸ºå¦‚ä¸‹:</p>
<p>nohub command &amp;</p>
<p>ä½†æ˜¯å½“ä½ é€€å‡ºè´¦æˆ·æ—¶ï¼Œä»ç„¶ä¼šåœæ­¢å¯¹åº”çš„è¿›ç¨‹ã€‚</p>
<p>æ‰€ä»¥è¿™å°±éœ€è¦ä½ åœ¨åé¢æ·»åŠ  2&gt;&amp;1 &amp;(ç›¸å½“äºæ­£å¸¸é€€å‡ºï¼Œä»ä¿æŒå‘½ä»¤åœ¨åå°è¿è¡Œ)</p>
<p>ä¸Šé¢è¿™ä¸ªcommandæ­£å¥½å¯¹ä¸Šjava -jar blog.jar &gt; system.log</p>
<p>â€œ&gt;â€ è¾“å‡ºé‡å®šå‘ï¼Œé€šå¸¸ç”¨äºè¾“å‡ºæ—¥å¿—</p>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒè¯¥åœ°å€:<a href="https://www.cnblogs.com/createhappy/p/9375874.html" target="_blank" rel="noopener">https://www.cnblogs.com/createhappy/p/9375874.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://developers-youcong.github.io/2019/02/23/springbootæ‰“æˆçš„jaråŒ…å¦‚ä½•åœ¨Linuxä¸ŠæŒä¹…è¿è¡Œ/" data-id="cju836j3m0035w8vk9lf2qzc4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/">SpringBoot</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Electron/">Electron</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyBatis/">MyBatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PostgreSQL/">PostgreSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VsCode/">VsCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jenkins/">jenkins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordpress/">wordpress</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å­˜å‚¨/">å­˜å‚¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ¶æ„/">æ¶æ„</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 11.67px;">Docker</a> <a href="/tags/Electron/" style="font-size: 10px;">Electron</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/MyBatis/" style="font-size: 16.67px;">MyBatis</a> <a href="/tags/MySQL/" style="font-size: 11.67px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 11.67px;">Nginx</a> <a href="/tags/Node-js/" style="font-size: 20px;">Node.js</a> <a href="/tags/PostgreSQL/" style="font-size: 10px;">PostgreSQL</a> <a href="/tags/Python/" style="font-size: 11.67px;">Python</a> <a href="/tags/Redis/" style="font-size: 11.67px;">Redis</a> <a href="/tags/SpringBoot/" style="font-size: 16.67px;">SpringBoot</a> <a href="/tags/VsCode/" style="font-size: 13.33px;">VsCode</a> <a href="/tags/javascript/" style="font-size: 18.33px;">javascript</a> <a href="/tags/jenkins/" style="font-size: 10px;">jenkins</a> <a href="/tags/wordpress/" style="font-size: 11.67px;">wordpress</a> <a href="/tags/å­˜å‚¨/" style="font-size: 10px;">å­˜å‚¨</a> <a href="/tags/æ¶æ„/" style="font-size: 11.67px;">æ¶æ„</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/04/08/SpringBootæ‰“åŒ…æˆwar/">SpringBootæ‰“åŒ…æˆwar</a>
          </li>
        
          <li>
            <a href="/2019/04/08/å¤§å‹ç½‘ç«™æ¶æ„æ¨¡å¼/">å¤§å‹ç½‘ç«™æ¶æ„æ¨¡å¼</a>
          </li>
        
          <li>
            <a href="/2019/04/07/åšå®¢ä¸­çš„æ–‡ç« å½’æ¡£æ˜¯å¦‚ä½•å®ç°çš„/">åšå®¢ä¸­çš„æ–‡ç« å½’æ¡£æ˜¯å¦‚ä½•å®ç°çš„</a>
          </li>
        
          <li>
            <a href="/2019/04/07/Caused-by-java-sql-SQLException-Value-0000-00-00-00-00-00-can-not-be-represented-as-java-sql-Timestamp/">Caused by: java.sql.SQLException: Value &#39;0000-00-00 00:00:00&#39; can not be represented as java.sql.Timestamp</a>
          </li>
        
          <li>
            <a href="/2019/04/06/gitåˆ†æ”¯å¼€å‘çš„å¥½å¤„/">gitåˆ†æ”¯å¼€å‘çš„å¥½å¤„</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 youcong<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>